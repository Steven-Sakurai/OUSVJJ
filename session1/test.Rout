
R version 3.3.3 (2017-03-06) -- "Another Canoe"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> set.seed(4516)
> 
> n = 50
> len = 2501
> par = c(0.1, 6,  0.25,  0.6,  -0.8,  3,  0,  -0.6,  -0.3, 0.025, 0.02, 0.002)
> 
> require(Rcpp)
Loading required package: Rcpp
> require(BH)
Loading required package: BH
> require(nloptr)
Loading required package: nloptr
> require(ggplot2)
Loading required package: ggplot2
> require(gridExtra)
Loading required package: gridExtra
> options(digits=8)
> source('../conv_plot.R')
> sourceCpp('../Simulation.cpp')
> sourceCpp('../nll.cpp', verbose = F)
> 
> opts <- list(algorithm="NLOPT_LN_NELDERMEAD", xtol_rel = 1.0e-5, maxeval = 10000)
> # set lower and upper bound
> lb = c(-0.5, 0.001, 1e-6, 0.001, -0.95, 0, 0, -0.95, -1, 0, 0, 0)
> ub = c(1, 100, 10, 1, 0.95, 10, 0, 0, 0, 1, 1, 1)
> 
> npar = 12
> # run n paths
> converge.list = matrix(, nrow = n, ncol = npar)
> est.par.list = matrix(, nrow = n, ncol = npar)
> success.list = vector(mode="numeric", length = n)
> 
> i = 1
> while(i <= n) {
+     seed = sample(10000, 5)
+     sim = SimOUSVJJ(par, len, log(100), par[3], 1/252, seed[1], seed[2], seed[3], seed[4], seed[5])
+     y = sim$y
+ 
+ 	f <- function(p) {
+ 	    return(nll(p, y))
+ 	}
+     
+     start = Sys.time()
+     result = nloptr(x0 = par, eval_f = f, 
+        opts = opts, 
+        lb = lb, ub = ub)
+     if(result$status < 0)
+         next;
+ 	est_list = as.numeric(result$solution)
+ 	c_list = check.converge(f, result$solution)
+ 	m_list = check.mono(f, result$solution)
+     flag = all(m_list | c_list)
+ 
+     write.table(est_list, file = "./est.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+ 	write.table(c_list, file = "./conv.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+     write.table(flag, file = "./success.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+     
+     print(i)
+     print(Sys.time() - start)
+     print(est_list)
+     
+     est.par.list[i, ] = as.numeric(est_list)
+     converge.list[i, ] = c_list
+     success.list[i] = flag
+ 	i = i + 1
+ }
[1] 1
Time difference of 55.160463 mins
 [1]  0.14589556070  3.89552722850  0.23551987274  0.40184727832 -0.80925973413
 [6]  3.61793740782  0.00000000000 -0.62855243359 -0.26056724689  0.02874877547
[11]  0.00056990578  0.00046729677
[1] 2
Time difference of 1.053146 hours
 [1]  5.0285930e-02  5.2884587e+00  2.8961182e-01  4.1727077e-01 -7.9860479e-01
 [6]  2.3499028e+00  0.0000000e+00 -9.4999621e-01 -3.2117469e-01  2.4452879e-02
[11]  5.3123893e-06  4.3841866e-04
[1] 3
Time difference of 1.7408054 hours
 [1]  1.2811128e-01  4.9955462e+00  2.0360577e-01  4.1001588e-01 -7.7831430e-01
 [6]  3.4098055e+00  0.0000000e+00 -4.4128201e-06 -3.1001760e-01  2.8965195e-02
[11]  1.2749588e-02  7.7506469e-04
[1] 4
Time difference of 1.3224344 hours
 [1]  1.9038973e-01  4.3048495e+00  2.7746880e-01  4.0955856e-01 -7.8486883e-01
 [6]  3.8360095e+00  0.0000000e+00 -7.6824857e-01 -2.2685829e-01  3.6111444e-02
[11]  1.9740014e-08  3.6185804e-04
[1] 5
Time difference of 38.251737 mins
 [1]  0.15010960235  5.00648986498  0.24790046808  0.42393059253 -0.81980151005
 [6]  2.80970707452  0.00000000000 -0.06373781212 -0.29954596917  0.01843462655
[11]  0.00451801485  0.00043617827
[1] 6
Time difference of 2.1206608 hours
 [1]  0.10363948200  4.72331651969  0.28841715914  0.40796188255 -0.79009503263
 [6]  3.83647937167  0.00000000000 -0.94999998073 -0.29452579254  0.02076691610
[11]  0.00355827312  0.00072248141
[1] 7
Time difference of 1.4046599 hours
 [1]  0.13342470412  4.48869010123  0.23349038012  0.41304776321 -0.78774760145
 [6]  3.51159372084  0.00000000000 -0.94998975055 -0.30322234633  0.01852779872
[11]  0.03561425389  0.00015829493
[1] 8
Time difference of 1.9713543 hours
 [1]  0.18047565767  3.86992194911  0.21337438371  0.39859016791 -0.76837564277
 [6]  3.77774639904  0.00000000000 -0.94999407735 -0.33580001522  0.02626397347
[11]  0.01822252130  0.00077374665
[1] 9
Time difference of 42.892157 mins
 [1]  0.14629962079  3.78266655125  0.23555372669  0.37166197818 -0.82999544934
 [6]  2.95493892088  0.00000000000 -0.46008159258 -0.33172012267  0.02446087843
[11]  0.01300837073  0.00013104179
[1] 10
Time difference of 1.5846905 hours
 [1]  1.6387603e-01  3.8100306e+00  2.4653883e-01  3.9466340e-01 -7.9044663e-01
 [6]  3.2397921e+00  0.0000000e+00 -6.3587922e-01 -3.1253459e-01  3.5758654e-02
[11]  1.2070191e-07  0.0000000e+00
[1] 11
Time difference of 1.5719639 hours
 [1]  1.7950753e-01  4.1639498e+00  2.3021303e-01  3.9514084e-01 -7.5109488e-01
 [6]  3.0731549e+00  0.0000000e+00 -9.4609339e-05 -3.0256686e-01  3.4242974e-02
[11]  3.2917549e-02  7.3649698e-05
[1] 12
Time difference of 57.89909 mins
 [1]  0.11202374165  4.62278837098  0.26175268886  0.44017849888 -0.80200461347
 [6]  3.72095535270  0.00000000000 -0.00053526665 -0.29913928076  0.02555247570
[11]  0.01675979103  0.00059312820
[1] 13
Time difference of 42.648775 mins
 [1]  0.1796202151  4.3010821122  0.2369592230  0.4044848742 -0.7999420515
 [6]  3.3681626369  0.0000000000 -0.2178979192 -0.2671598579  0.0289236753
[11]  0.0089197631  0.0012863110
[1] 14
Time difference of 43.429039 mins
 [1]  1.4978457e-01  5.2278574e+00  2.2324526e-01  4.1134026e-01 -8.1679672e-01
 [6]  2.5780714e+00  0.0000000e+00 -9.4638217e-01 -2.6734754e-01  3.2791191e-02
[11]  8.9339761e-09  4.2836412e-04
[1] 15
Time difference of 1.1427866 hours
 [1]  2.0929192e-01  3.3430102e+00  2.3500830e-01  4.0717631e-01 -8.1685192e-01
 [6]  2.6490103e+00  0.0000000e+00 -9.4111978e-01 -2.9349729e-01  2.3265040e-02
[11]  1.2921871e-02  5.6432739e-05
[1] 16
Time difference of 44.343282 mins
 [1]  0.18346633886  4.49852975120  0.23118031542  0.41762107262 -0.82203245144
 [6]  3.04992699631  0.00000000000 -0.41465385730 -0.35133709492  0.02897570126
[11]  0.02496748691  0.00056280014
[1] 17
Time difference of 1.1442445 hours
 [1]  1.6755414e-01  3.9295616e+00  2.4454149e-01  4.1456566e-01 -8.0896872e-01
 [6]  3.0747741e+00  0.0000000e+00 -4.1466533e-06 -2.9982674e-01  2.1175040e-02
[11]  6.5420647e-03  1.0880668e-03
[1] 18
Time difference of 41.14751 mins
 [1]  0.1441930197  3.1300540979  0.2520665664  0.3722982884 -0.7773622131
 [6]  2.1998955215  0.0000000000 -0.3018772587 -0.2988833211  0.0265389880
[11]  0.0056772206  0.0013566895
[1] 19
Time difference of 1.2408358 hours
 [1]  0.128242735  4.200082150  0.229157456  0.402693228 -0.786611239
 [6]  3.036534787  0.000000000 -0.670912466 -0.267057058  0.015137769
[11]  0.015165710  0.000000000
[1] 20
Time difference of 1.3699356 hours
 [1]  1.3766922e-01  5.5506297e+00  2.6186001e-01  4.2528170e-01 -8.1788929e-01
 [6]  2.7768330e+00  0.0000000e+00 -1.0157741e-01 -2.4654589e-01  1.5787912e-02
[11]  1.2307982e-02  4.6912999e-07
[1] 21
Time difference of 2.1166393 hours
 [1]  1.4158336e-01  3.1479083e+00  2.3706085e-01  4.1628413e-01 -7.9253019e-01
 [6]  3.1218678e+00  0.0000000e+00 -7.7255368e-06 -2.4895681e-01  1.6329922e-02
[11]  7.2585604e-06  6.8233233e-04
[1] 22
Time difference of 54.242672 mins
 [1]  1.7955381e-01  3.8125735e+00  2.3090036e-01  4.0606372e-01 -7.8829476e-01
 [6]  3.2545752e+00  0.0000000e+00 -7.5351445e-01 -2.7338627e-01  3.9628943e-02
[11]  4.0423304e-05  6.0492801e-04
[1] 23
Time difference of 49.289408 mins
 [1]  0.12215325038  4.87307165583  0.23787297109  0.40137726062 -0.79102827016
 [6]  3.08551815022  0.00000000000 -0.68466725059 -0.29023801984  0.02336103099
[11]  0.01557349196  0.00080733411
[1] 24
Time difference of 1.0852261 hours
 [1]  1.6755506e-01  3.7824607e+00  1.9860967e-01  4.0560664e-01 -7.6889288e-01
 [6]  3.0910900e+00  0.0000000e+00 -9.4994723e-01 -2.9521346e-01  4.4725536e-02
[11]  3.2293288e-02  2.0572438e-05
[1] 25
Time difference of 1.0678615 hours
 [1]  1.7036910e-01  3.0976796e+00  2.1849496e-01  3.6740835e-01 -8.1457685e-01
 [6]  2.9615497e+00  0.0000000e+00 -9.3113203e-01 -3.0281312e-01  2.3194879e-02
[11]  8.0626229e-06  4.1326130e-06
[1] 26
Time difference of 1.7634925 hours
 [1]  1.8035340e-01  4.0501194e+00  2.7689116e-01  4.1105088e-01 -7.6967494e-01
 [6]  3.0947881e+00  0.0000000e+00 -1.3377253e-02 -2.9645944e-01  1.4486568e-02
[11]  6.6094777e-08  1.7454787e-08
[1] 27
Time difference of 2.7342812 hours
 [1]  1.4347096e-01  4.7211551e+00  2.3267948e-01  4.1812443e-01 -7.6780445e-01
 [6]  2.2132456e+00  0.0000000e+00 -9.4999040e-01 -3.5840975e-01  1.1397953e-02
[11]  3.0990143e-08  7.0627222e-05
[1] 28
Time difference of 1.8134869 hours
 [1]  1.3828738e-01  4.7520970e+00  2.2878646e-01  4.0409084e-01 -8.0464011e-01
 [6]  3.6219214e+00  0.0000000e+00 -8.4296426e-06 -3.1884991e-01  1.4166267e-02
[11]  2.1096277e-02  5.0306797e-04
[1] 29
Time difference of 1.9426428 hours
 [1]  0.12918072930  4.24418930112  0.25110003064  0.39746735008 -0.78165836876
 [6]  2.55944028243  0.00000000000 -0.94999987305 -0.32957795173  0.01624365739
[11]  0.01292845230  0.00068871358
[1] 30
Time difference of 1.5785228 hours
 [1]  2.2303891e-01  4.3587338e+00  1.9732255e-01  4.0557640e-01 -7.9328797e-01
 [6]  3.0841900e+00  0.0000000e+00 -2.6071615e-07 -2.6545901e-01  1.9228107e-02
[11]  1.5387645e-02  3.4557885e-04
[1] 31
Time difference of 1.1613771 hours
 [1]  0.08287326341  4.31543158153  0.30012944371  0.41808706247 -0.82927648986
 [6]  3.37244678414  0.00000000000 -0.56349601250 -0.34054610346  0.02178143217
[11]  0.00954576072  0.00043799155
[1] 32
Time difference of 1.2513158 hours
 [1]  0.16033552787  4.61816355520  0.22794764816  0.42087203328 -0.76397708729
 [6]  3.69091230748  0.00000000000 -0.94999968895 -0.26255940826  0.03225783839
[11]  0.00167875328  0.00068392862
[1] 33
Time difference of 1.2214654 hours
 [1]  1.8786333e-01  4.7822954e+00  2.4183104e-01  4.1124167e-01 -7.4777054e-01
 [6]  3.1442528e+00  0.0000000e+00 -9.4995136e-01 -2.3383000e-01  2.2789078e-02
[11]  7.2145854e-06  2.6662109e-04
[1] 34
Time difference of 1.2298002 hours
 [1]  1.8618453e-01  3.5543239e+00  2.2333253e-01  4.0333254e-01 -8.0963079e-01
 [6]  2.9692209e+00  0.0000000e+00 -6.3174063e-01 -2.7151207e-01  3.8066409e-02
[11]  8.3576267e-10  1.0115575e-03
[1] 35
Time difference of 1.3432926 hours
 [1]  1.2578616e-01  4.5988109e+00  2.5613591e-01  4.1393664e-01 -7.6864680e-01
 [6]  2.9908929e+00  0.0000000e+00 -1.4661201e-01 -3.1731187e-01  3.0145543e-02
[11]  1.1705425e-05  6.0469890e-04
