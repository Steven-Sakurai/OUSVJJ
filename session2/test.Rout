
R version 3.3.3 (2017-03-06) -- "Another Canoe"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> set.seed(21822)
> 
> n = 50
> len = 2501
> par = c(0.1, 6,  0.25,  0.6,  -0.8,  3,  0,  -0.6,  -0.3, 0.025, 0.02, 0.002)
> 
> require(Rcpp)
Loading required package: Rcpp
> require(BH)
Loading required package: BH
> require(nloptr)
Loading required package: nloptr
> require(ggplot2)
Loading required package: ggplot2
> require(gridExtra)
Loading required package: gridExtra
> options(digits=8)
> source('../conv_plot.R')
> sourceCpp('../Simulation.cpp')
> sourceCpp('../nll.cpp', verbose = F)
> 
> opts <- list(algorithm="NLOPT_LN_NELDERMEAD", xtol_rel = 1.0e-5, maxeval = 10000)
> # set lower and upper bound
> lb = c(-0.5, 0.001, 1e-6, 0.001, -0.95, 0, 0, -0.95, -1, 0, 0, 0)
> ub = c(1, 100, 10, 1, 0.95, 10, 0, 0, 0, 1, 1, 1)
> 
> npar = 12
> # run n paths
> converge.list = matrix(, nrow = n, ncol = npar)
> est.par.list = matrix(, nrow = n, ncol = npar)
> success.list = vector(mode="numeric", length = n)
> 
> i = 1
> while(i <= n) {
+     seed = sample(10000, 5)
+     sim = SimOUSVJJ(par, len, log(100), par[3], 1/252, seed[1], seed[2], seed[3], seed[4], seed[5])
+     y = sim$y
+ 
+ 	f <- function(p) {
+ 	    return(nll(p, y))
+ 	}
+     
+     start = Sys.time()
+     result = nloptr(x0 = par, eval_f = f, 
+        opts = opts, 
+        lb = lb, ub = ub)
+     if(result$status < 0)
+         next;
+ 	est_list = as.numeric(result$solution)
+ 	c_list = check.converge(f, result$solution)
+ 	m_list = check.mono(f, result$solution)
+     flag = all(m_list | c_list)
+ 
+     write.table(est_list, file = "./est.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+ 	write.table(c_list, file = "./conv.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+     write.table(flag, file = "./success.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+     
+     print(i)
+     print(Sys.time() - start)
+     print(est_list)
+     
+     est.par.list[i, ] = as.numeric(est_list)
+     converge.list[i, ] = c_list
+     success.list[i] = flag
+ 	i = i + 1
+ }
[1] 1
Time difference of 44.016604 mins
 [1]  2.0243160e-01  4.1474060e+00  2.0242225e-01  3.9230216e-01 -8.2888392e-01
 [6]  3.5344777e+00  0.0000000e+00 -2.5558408e-05 -2.7548305e-01  1.5833084e-02
[11]  2.2402609e-02  5.6087930e-04
[1] 2
Time difference of 40.43031 mins
 [1]  0.13245786834  3.06615953003  0.26757102109  0.39165244151 -0.87948608257
 [6]  3.19752099743  0.00000000000 -0.07919217124 -0.24916715001  0.02017693428
[11]  0.00480088244  0.00078616234
[1] 3
Time difference of 50.698096 mins
 [1]  0.18254385607  5.43714897566  0.23500521716  0.41458826711 -0.76560576315
 [6]  2.43686530747  0.00000000000 -0.57638097462 -0.32098544612  0.02712155957
[11]  0.01500485577  0.00032775151
[1] 4
Time difference of 52.497609 mins
 [1]  0.16914856270  4.19050454061  0.21976850896  0.39864562012 -0.78254062570
 [6]  3.44261064612  0.00000000000 -0.60098543977 -0.23964058175  0.02345793408
[11]  0.00372187266  0.00052355176
[1] 5
Time difference of 53.013549 mins
 [1]  1.2891103e-01  4.8074608e+00  2.8903056e-01  4.1091681e-01 -7.6632242e-01
 [6]  2.5184988e+00  0.0000000e+00 -6.2862943e-01 -2.7045368e-01  1.9132709e-02
[11]  1.5859762e-02  3.6701517e-08
[1] 6
Time difference of 38.634443 mins
 [1]  0.24772434768  4.63657227883  0.19650826151  0.41939593432 -0.81746736963
 [6]  2.98213335500  0.00000000000 -0.27462385503 -0.29609055984  0.02244070015
[11]  0.03087437281  0.00012752544
[1] 7
Time difference of 49.949664 mins
 [1]  0.11515141923  5.85739442778  0.24261867903  0.43382342014 -0.79965105239
 [6]  2.33262365339  0.00000000000 -0.69782185778 -0.28155710284  0.02759547856
[11]  0.01655356470  0.00038368861
[1] 8
Time difference of 1.3118631 hours
 [1]  0.16834885666  3.85636966710  0.21295885639  0.40889292233 -0.81855310936
 [6]  1.66914190334  0.00000000000 -0.94999957185 -0.21994566751  0.03306238461
[11]  0.01842911179  0.00063383798
[1] 9
Time difference of 52.871391 mins
 [1]  0.13246485767  4.90658726643  0.24934697520  0.40781997962 -0.86083055891
 [6]  3.47818826502  0.00000000000 -0.22227587363 -0.29609836450  0.02708349765
[11]  0.00908271959  0.00074905974
[1] 10
Time difference of 33.289359 mins
 [1]  0.182135556  4.553876873  0.234267925  0.416204154 -0.754035633
 [6]  2.606763023  0.000000000 -0.425787010 -0.287355889  0.025971002
[11]  0.028001467  0.000000000
[1] 11
Time difference of 1.0424386 hours
 [1]  1.8667995e-01  3.4578455e+00  2.3006155e-01  3.8950445e-01 -8.0495371e-01
 [6]  3.2404563e+00  0.0000000e+00 -4.8313421e-05 -3.1542467e-01  2.2623932e-02
[11]  7.7223109e-03  1.1200111e-03
[1] 12
Time difference of 58.148075 mins
 [1]  0.15854551510  2.91052257575  0.25083847202  0.37674409841 -0.77464417498
 [6]  3.63410000760  0.00000000000 -0.25964098872 -0.26285661065  0.02755291336
[11]  0.00010643333  0.00042016183
[1] 13
Time difference of 1.3981806 hours
 [1]  1.2725009e-01  5.1465285e+00  2.8334036e-01  4.1861018e-01 -7.9606850e-01
 [6]  3.3790627e+00  0.0000000e+00 -2.6342959e-01 -3.2313385e-01  1.9455016e-02
[11]  1.2029013e-08  9.8213103e-04
[1] 14
Time difference of 1.30201 hours
 [1]  0.12455890424  6.16926601782  0.23233910738  0.41457933486 -0.79871451600
 [6]  2.85484977781  0.00000000000 -0.92449040368 -0.29686059987  0.01922101040
[11]  0.01829554731  0.00018402611
[1] 15
Time difference of 1.0400881 hours
 [1]  0.18293482583  3.90620093806  0.20130483218  0.39092995609 -0.77495892979
 [6]  4.01639581041  0.00000000000 -0.34579806346 -0.30135395247  0.03502092367
[11]  0.00368757805  0.00066456388
[1] 16
Time difference of 1.4030007 hours
 [1]  0.09901334706  3.85520604769  0.25212546141  0.40286600521 -0.76738598635
 [6]  3.32442970853  0.00000000000 -0.43241955211 -0.30930925672  0.01689770859
[11]  0.01606700892  0.00038140977
[1] 17
Time difference of 52.787608 mins
 [1]  0.153857895  4.577212259  0.249778555  0.416430227 -0.805698633
 [6]  3.593517377  0.000000000 -0.022776134 -0.338651324  0.031624991
[11]  0.042765441  0.000000000
[1] 18
Time difference of 1.0303138 hours
 [1]  1.6959371e-01  4.8848116e+00  2.1902679e-01  4.1977411e-01 -7.6883116e-01
 [6]  2.4205151e+00  0.0000000e+00 -2.1458763e-01 -3.1701956e-01  1.0212719e-02
[11]  3.9327005e-07  4.6216394e-04
[1] 19
Time difference of 1.3217359 hours
 [1]  9.0379445e-02  4.5306612e+00  2.3247532e-01  4.0036656e-01 -8.2329517e-01
 [6]  3.7565452e+00  0.0000000e+00 -9.4999859e-01 -2.4674061e-01  2.4089907e-02
[11]  6.4126346e-08  3.4265725e-04
[1] 20
Time difference of 1.1041258 hours
 [1]  0.12717199843  4.50494320527  0.24188531934  0.41627094758 -0.84266824236
 [6]  2.83040684708  0.00000000000 -0.94999677477 -0.27276961162  0.02414603455
[11]  0.00627187375  0.00066187497
[1] 21
Time difference of 1.1699277 hours
 [1]  1.4561185e-01  4.4424178e+00  2.4486238e-01  3.9638911e-01 -8.0986852e-01
 [6]  4.6475705e+00  0.0000000e+00 -9.4997881e-01 -2.8147242e-01  2.8081966e-02
[11]  3.5588227e-07  4.2600444e-04
[1] 22
Time difference of 1.0307357 hours
 [1]  1.7456866e-01  4.1452000e+00  2.2536564e-01  4.0739330e-01 -7.6144764e-01
 [6]  2.5720146e+00  0.0000000e+00 -5.9021896e-01 -3.9301904e-01  2.2874131e-02
[11]  1.2625302e-08  7.9022882e-04
[1] 23
Time difference of 2.0418046 hours
 [1]  1.9289415e-01  5.0442404e+00  2.1615937e-01  4.1345345e-01 -7.5309027e-01
 [6]  2.5354936e+00  0.0000000e+00 -1.4989350e-03 -3.0976417e-01  3.6971467e-02
[11]  4.7795138e-02  1.5850759e-07
[1] 24
Time difference of 34.990172 mins
 [1]  0.20037527664  4.89657808466  0.26097674142  0.41631988402 -0.78091578633
 [6]  3.02019386919  0.00000000000 -0.71789877210 -0.32640613281  0.01944824398
[11]  0.01043653607  0.00074713835
[1] 25
Time difference of 1.454172 hours
 [1]  0.15682574733  5.06980997510  0.24615366667  0.42327486160 -0.74417597159
 [6]  3.69798166987  0.00000000000 -0.94963054319 -0.29479490177  0.03104601087
[11]  0.02662497977  0.00009555005
[1] 26
Time difference of 50.609175 mins
 [1]  0.17180526528  3.80471513356  0.19135435499  0.41169782799 -0.80655266732
 [6]  3.31124623393  0.00000000000 -0.54676949407 -0.31563984762  0.02073544568
[11]  0.00980942723  0.00045874437
[1] 27
Time difference of 1.27386 hours
 [1]  0.18676792319  4.24172684946  0.23865541736  0.40067869752 -0.80108828391
 [6]  2.14500173640  0.00000000000 -0.94999881159 -0.28236877222  0.03454383818
[11]  0.00692929951  0.00043076025
[1] 28
Time difference of 31.728404 mins
 [1]  1.1259892e-01  4.9170229e+00  2.6243811e-01  4.1533232e-01 -7.7620153e-01
 [6]  3.1920576e+00  0.0000000e+00 -7.3991568e-01 -3.1709353e-01  2.2285493e-02
[11]  2.0855015e-02  8.7056591e-06
[1] 29
Time difference of 44.656304 mins
 [1]  0.17160559739  3.54346977675  0.19355758072  0.37902880902 -0.80154971307
 [6]  3.99161251255  0.00000000000 -0.23377966238 -0.26753513915  0.02083950302
[11]  0.00952142803  0.00045406392
[1] 30
Time difference of 59.592751 mins
 [1]  0.22746243374  5.53488638461  0.25972916867  0.42937740547 -0.76618264798
 [6]  3.90645262058  0.00000000000 -0.94997922398 -0.30362331204  0.03461676295
[11]  0.01306629166  0.00016387105
[1] 31
Time difference of 47.272846 mins
 [1]  1.7651436e-01  4.0025547e+00  2.1361819e-01  3.7472118e-01 -8.2708015e-01
 [6]  3.0884461e+00  0.0000000e+00 -8.8472054e-01 -2.0915203e-01  2.6943300e-02
[11]  3.9961569e-07  1.9910433e-04
[1] 32
Time difference of 38.541656 mins
 [1]  0.15506617381  3.68079165286  0.21209344471  0.41441861993 -0.77735450351
 [6]  3.36419615284  0.00000000000 -0.44128310736 -0.25268204057  0.02641125269
[11]  0.00627607083  0.00080197929
[1] 33
Time difference of 2.1842859 hours
 [1]  0.16741870118  4.70788169853  0.22555263813  0.39265617055 -0.72827736217
 [6]  2.60904260620  0.00000000000 -0.94999394504 -0.22633557462  0.02514182784
[11]  0.00150235200  0.00078453458
[1] 34
Time difference of 43.206272 mins
 [1]  0.14903884429  4.82253468455  0.24287584856  0.40460210349 -0.83780684053
 [6]  2.73455178701  0.00000000000 -0.82587307816 -0.29114767928  0.04135327670
[11]  0.01638972336  0.00038910716
[1] 35
Time difference of 55.787664 mins
 [1]  0.14313586554  2.81824343241  0.17141168534  0.35806237518 -0.78742279305
 [6]  2.73833299388  0.00000000000 -0.91248351484 -0.25089138779  0.03680518781
[11]  0.00380217586  0.00013047759
[1] 36
Time difference of 51.928819 mins
 [1]  0.13367086936  4.50873513814  0.21968489911  0.40961509988 -0.84702482183
 [6]  3.50667695657  0.00000000000 -0.94984246478 -0.33555060809  0.02036258878
[11]  0.01653086454  0.00015427241
[1] 37
Time difference of 40.739315 mins
 [1]  0.20511603314  5.41614165534  0.22307487731  0.42396890803 -0.75929893301
 [6]  3.30544023916  0.00000000000 -0.88870602916 -0.26862188687  0.02748909714
[11]  0.00314650429  0.00054923992
[1] 38
Time difference of 39.156537 mins
 [1]  0.15113622036  4.52048999267  0.23411722909  0.39309976497 -0.80274179495
 [6]  3.75163668254  0.00000000000 -0.01799451390 -0.30173049146  0.02917295202
[11]  0.01327978183  0.00079387505
[1] 39
Time difference of 48.272888 mins
 [1]  0.208865131  3.780432934  0.208196619  0.395017850 -0.795097186
 [6]  2.738854772  0.000000000 -0.753428569 -0.263487197  0.020843776
[11]  0.028660675  0.000000000
[1] 40
Time difference of 1.2010559 hours
 [1]  1.6577323e-01  5.0313508e+00  2.3177241e-01  4.3511858e-01 -7.9055497e-01
 [6]  2.8708584e+00  0.0000000e+00 -4.6981589e-06 -3.1525814e-01  3.5928102e-02
[11]  1.5690229e-02  5.7069608e-04
[1] 41
Time difference of 1.0886695 hours
 [1]  1.3522773e-01  5.5702749e+00  2.4206237e-01  4.3481444e-01 -7.7409961e-01
 [6]  3.5642538e+00  0.0000000e+00 -9.4999617e-01 -2.6181826e-01  3.1659888e-02
[11]  3.6722408e-02  6.7293535e-05
[1] 42
Time difference of 1.1888581 hours
 [1]  0.01680800495  4.93006759218  0.27744117255  0.40720919179 -0.87042051167
 [6]  2.72695337452  0.00000000000 -0.94822020542 -0.28731675684  0.02446400848
[11]  0.04076435562  0.00006595509
[1] 43
Time difference of 1.3470256 hours
 [1]  1.2559425e-01  4.5149615e+00  2.5091920e-01  4.0547244e-01 -8.4001156e-01
 [6]  2.7680745e+00  0.0000000e+00 -9.4998870e-01 -3.1271489e-01  2.0890513e-02
[11]  2.8392478e-06  5.6749030e-05
[1] 44
Time difference of 1.2973746 hours
 [1]  1.1871490e-01  4.6335284e+00  2.5530980e-01  4.1936819e-01 -7.7139525e-01
 [6]  4.2697511e+00  0.0000000e+00 -9.4949869e-01 -3.1550036e-01  2.5755344e-02
[11]  3.2929519e-02  1.4716568e-05
