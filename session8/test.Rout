
R version 3.3.3 (2017-03-06) -- "Another Canoe"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> set.seed(32612)
> 
> n = 50
> len = 2501
> par = c(0.1, 6,  0.25,  0.6,  -0.8,  3,  0,  -0.6,  -0.3, 0.025, 0.02, 0.002)
> 
> require(Rcpp)
Loading required package: Rcpp
> require(BH)
Loading required package: BH
> require(nloptr)
Loading required package: nloptr
> require(ggplot2)
Loading required package: ggplot2
> require(gridExtra)
Loading required package: gridExtra
> options(digits=8)
> source('../conv_plot.R')
> sourceCpp('../Simulation.cpp')
> sourceCpp('../nll.cpp', verbose = F)
> 
> opts <- list(algorithm="NLOPT_LN_NELDERMEAD", xtol_rel = 1.0e-5, maxeval = 10000)
> # set lower and upper bound
> lb = c(-0.5, 0.001, 1e-6, 0.001, -0.95, 0, 0, -0.95, -1, 0, 0, 0)
> ub = c(1, 100, 10, 1, 0.95, 10, 0, 0, 0, 1, 1, 1)
> 
> npar = 12
> # run n paths
> converge.list = matrix(, nrow = n, ncol = npar)
> est.par.list = matrix(, nrow = n, ncol = npar)
> success.list = vector(mode="numeric", length = n)
> 
> i = 1
> while(i <= n) {
+     seed = sample(10000, 5)
+     sim = SimOUSVJJ(par, len, log(100), par[3], 1/252, seed[1], seed[2], seed[3], seed[4], seed[5])
+     y = sim$y
+ 
+ 	f <- function(p) {
+ 	    return(nll(p, y))
+ 	}
+     
+     start = Sys.time()
+     result = nloptr(x0 = par, eval_f = f, 
+        opts = opts, 
+        lb = lb, ub = ub)
+     if(result$status < 0)
+         next;
+ 	est_list = as.numeric(result$solution)
+ 	c_list = check.converge(f, result$solution)
+ 	m_list = check.mono(f, result$solution)
+     flag = all(m_list | c_list)
+ 
+     write.table(est_list, file = "./est.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+ 	write.table(c_list, file = "./conv.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+     write.table(flag, file = "./success.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+     
+     print(i)
+     print(Sys.time() - start)
+     print(est_list)
+     
+     est.par.list[i, ] = as.numeric(est_list)
+     converge.list[i, ] = c_list
+     success.list[i] = flag
+ 	i = i + 1
+ }
[1] 1
Time difference of 1.1218851 hours
 [1]  1.7476648e-01  3.6983870e+00  2.2538183e-01  3.7521546e-01 -7.6888538e-01
 [6]  3.5555335e+00  0.0000000e+00 -2.0887145e-07 -2.9738680e-01  3.8234984e-02
[11]  1.6478533e-03  6.6406473e-04
[1] 2
Time difference of 42.264925 mins
 [1]  0.09085856920  4.87684885601  0.23654605426  0.41667267170 -0.84884753024
 [6]  3.56733373091  0.00000000000 -0.36426373255 -0.27679200772  0.02401139740
[11]  0.02164758182  0.00055908034
[1] 3
Time difference of 38.90141 mins
 [1]  0.14579205893  3.68934898273  0.24575140328  0.39951334157 -0.80186723445
 [6]  4.35818050482  0.00000000000 -0.08921247597 -0.32874828240  0.02567039234
[11]  0.01039979035  0.00052433299
[1] 4
Time difference of 56.11782 mins
 [1]  0.16696712599  3.73151152786  0.24364436732  0.42587153852 -0.82692643119
 [6]  3.79270632278  0.00000000000 -0.94962707865 -0.32411301753  0.02062535253
[11]  0.01096669764  0.00018658011
[1] 5
Time difference of 45.433711 mins
 [1]  0.21150104657  4.87317365036  0.22135500793  0.41586292710 -0.82044138228
 [6]  2.82085482468  0.00000000000 -0.00033780642 -0.33076507426  0.03447890031
[11]  0.02381096450  0.00036031840
[1] 6
Time difference of 44.290877 mins
 [1]  0.13090474363  2.68771896955  0.22024523659  0.36911289117 -0.80541432965
 [6]  3.18943909065  0.00000000000 -0.13146944638 -0.32380614120  0.02406747720
[11]  0.01131302526  0.00094289883
[1] 7
Time difference of 3.2455553 hours
 [1]  1.6667729e-01  3.4024601e+00  2.4365992e-01  4.0360453e-01 -7.9777031e-01
 [6]  2.9479157e+00  0.0000000e+00 -9.4998582e-01 -2.7358460e-01  1.8312435e-02
[11]  1.8701465e-07  4.9894598e-04
[1] 8
Time difference of 34.043479 mins
 [1]  0.154120162  4.126222491  0.235620384  0.411661890 -0.782381747
 [6]  2.998982932  0.000000000 -0.581825546 -0.334818774  0.018067757
[11]  0.028723067  0.000000000
[1] 9
Time difference of 1.0248367 hours
 [1]  0.20225188537  4.69412062234  0.24294558893  0.42359447998 -0.75260347339
 [6]  3.20805278981  0.00000000000 -0.92345823334 -0.21876473771  0.03718078492
[11]  0.02401704094  0.00014628248
[1] 10
Time difference of 2.0312425 hours
 [1]  0.14031618740  4.52945520900  0.26426747181  0.42220605541 -0.78365330330
 [6]  2.64685351057  0.00000000000 -0.94999701470 -0.26613023867  0.02024073155
[11]  0.02096481072  0.00031316009
[1] 11
Time difference of 58.102057 mins
 [1]  2.0460064e-01  4.4607831e+00  2.2337677e-01  4.2886722e-01 -8.4763211e-01
 [6]  2.6370283e+00  0.0000000e+00 -7.1559218e-01 -3.2454791e-01  1.5269680e-02
[11]  3.9696379e-02  2.5909533e-07
[1] 12
Time difference of 2.0151356 hours
 [1]  1.6048682e-01  4.3811838e+00  2.0406181e-01  4.0083533e-01 -8.0663593e-01
 [6]  2.8326117e+00  0.0000000e+00 -2.2261881e-07 -2.6974158e-01  2.8265243e-02
[11]  1.2117035e-02  8.3314126e-04
[1] 13
Time difference of 48.029857 mins
 [1]  0.14295730061  4.75383512514  0.22337808573  0.41059261617 -0.80763716910
 [6]  3.94376679031  0.00000000000 -0.92010652005 -0.26179443662  0.03164256943
[11]  0.00348839198  0.00078252885
[1] 14
Time difference of 41.41834 mins
 [1]  0.15729171642  4.08589648593  0.21375617069  0.38943184381 -0.82245423858
 [6]  3.00221897934  0.00000000000 -0.22388886032 -0.23593586917  0.02980151071
[11]  0.00250333808  0.00083513531
[1] 15
Time difference of 42.448408 mins
 [1]  0.17341231732  4.57741012377  0.22999425253  0.41913438191 -0.77061413652
 [6]  2.53499491964  0.00000000000 -0.21668438885 -0.35788934244  0.02586193512
[11]  0.01498377929  0.00084657435
[1] 16
Time difference of 41.846396 mins
 [1]  0.13811573495  4.60302796797  0.26485506996  0.42580682456 -0.84939724371
 [6]  3.24448994886  0.00000000000 -0.34473554110 -0.29848191453  0.01726621330
[11]  0.00312991639  0.00061278063
[1] 17
Time difference of 1.1011718 hours
 [1]  0.149942949  3.670432331  0.253869830  0.407004437 -0.798870834
 [6]  3.397644171  0.000000000 -0.170316961 -0.331095174  0.022293700
[11]  0.047684666  0.000000000
[1] 18
Time difference of 1.0476449 hours
 [1]  0.13932391586  5.42643747544  0.27065526654  0.42175810871 -0.82221410587
 [6]  3.45433267958  0.00000000000 -0.94999281931 -0.30387393957  0.01383190114
[11]  0.02063633191  0.00012501514
[1] 19
Time difference of 48.571761 mins
 [1]  0.19716542076  3.51349713993  0.20205509425  0.40295602585 -0.80595119280
 [6]  3.12870101409  0.00000000000 -0.38159295124 -0.30900333819  0.02247295454
[11]  0.02964554641  0.00022058172
[1] 20
Time difference of 41.784592 mins
 [1]  0.1560493814  4.4299537394  0.2548803255  0.4024928587 -0.8551133739
 [6]  2.9902048467  0.0000000000 -0.8876363774 -0.3363239573  0.0391086612
[11]  0.0091685715  0.0004797914
[1] 21
Time difference of 1.8921156 hours
 [1]  2.0557333e-01  4.5185236e+00  2.0143519e-01  4.0016404e-01 -8.2285810e-01
 [6]  4.2867070e+00  0.0000000e+00 -4.5445985e-02 -2.7731032e-01  2.9096967e-02
[11]  4.4048824e-06  6.0926626e-04
[1] 22
Time difference of 56.157958 mins
 [1]  0.18248752881  5.13735148638  0.25069548838  0.41588799637 -0.76870676583
 [6]  3.54970652885  0.00000000000 -0.94999625499 -0.26366662803  0.02485903348
[11]  0.00511070583  0.00054010657
[1] 23
Time difference of 47.368725 mins
 [1]  1.6898546e-01  4.5817916e+00  2.4956282e-01  4.2194357e-01 -7.7668060e-01
 [6]  3.1700793e+00  0.0000000e+00 -7.7178658e-01 -2.6348849e-01  3.1853039e-02
[11]  5.5735713e-08  8.4125409e-04
[1] 24
Time difference of 1.3283562 hours
 [1]  0.16588669800  3.41243195541  0.21961672013  0.39046706716 -0.85457531551
 [6]  3.20720822845  0.00000000000 -0.94991995566 -0.24293785193  0.03050508393
[11]  0.02191487965  0.00030796773
[1] 25
Time difference of 38.298275 mins
 [1]  1.7041357e-01  3.0437863e+00  1.8762454e-01  3.8249474e-01 -7.8583365e-01
 [6]  2.7092887e+00  0.0000000e+00 -8.8653517e-01 -3.5893386e-01  2.9015881e-02
[11]  4.9312478e-02  3.4255941e-06
[1] 26
Time difference of 1.5101677 hours
 [1]  0.16290431966  4.59468416839  0.24322780451  0.41516043577 -0.82744939839
 [6]  3.78352669643  0.00000000000 -0.94999821893 -0.30911415719  0.02740094410
[11]  0.00542362808  0.00042996167
[1] 27
Time difference of 1.0241957 hours
 [1]  1.2952885e-01  4.1015126e+00  2.7763749e-01  4.0583727e-01 -8.0549873e-01
 [6]  4.3544529e+00  0.0000000e+00 -9.4998407e-01 -2.4230528e-01  2.6474972e-02
[11]  2.4355501e-05  4.7273415e-04
[1] 28
Time difference of 35.772846 mins
 [1]  0.15802638931  3.34960062258  0.19268666431  0.38191489355 -0.85393741018
 [6]  3.38204002645  0.00000000000 -0.51572308376 -0.32538904160  0.02726261718
[11]  0.01071588420  0.00076518917
[1] 29
Time difference of 1.6801722 hours
 [1]  0.20502420857  3.91335456230  0.21024623796  0.39156366934 -0.75550948627
 [6]  3.12181470278  0.00000000000 -0.94999843043 -0.25015520971  0.04588147658
[11]  0.00908141343  0.00043326657
[1] 30
Time difference of 2.3609861 hours
 [1]  1.7761157e-01  4.8729784e+00  2.1014152e-01  4.0398777e-01 -8.1401117e-01
 [6]  2.9329359e+00  0.0000000e+00 -1.7312854e-07 -2.5911581e-01  2.6630194e-02
[11]  2.3385261e-09  1.2654380e-03
[1] 31
Time difference of 41.565425 mins
 [1]  0.14520474116  5.45849897363  0.23610307133  0.40658448757 -0.83600209130
 [6]  2.85466446984  0.00000000000 -0.47181957353 -0.30070503468  0.03073332287
[11]  0.01262676784  0.00094155617
[1] 32
Time difference of 28.342733 mins
 [1]  0.078924451  4.102400918  0.246216859  0.407118501 -0.701417542
 [6]  3.224883299  0.000000000 -0.610044679 -0.321014025  0.021869572
[11]  0.007804847  0.000000000
[1] 33
Time difference of 38.514849 mins
 [1]  0.20148043063  4.62355843037  0.22531083541  0.40751462174 -0.80779913280
 [6]  3.62306487721  0.00000000000 -0.48929363512 -0.28725899165  0.03083394557
[11]  0.00405924791  0.00079575102
[1] 34
Time difference of 47.460414 mins
 [1]  0.13229423107  4.82733364593  0.27843773497  0.41448566811 -0.82255218047
 [6]  3.93471719221  0.00000000000 -0.94996870250 -0.28069434737  0.04065273642
[11]  0.00765042111  0.00012865571
[1] 35
Time difference of 47.570082 mins
 [1]  0.17320315692  4.82600511853  0.20388172715  0.39705798092 -0.75028983645
 [6]  3.69093532906  0.00000000000 -0.33691216515 -0.32551673102  0.01995917183
[11]  0.00353487577  0.00088649234
[1] 36
Time difference of 1.7172178 hours
 [1]  0.16195978324  5.63709822843  0.23497902375  0.41468186756 -0.85440349544
 [6]  1.99133947489  0.00000000000 -0.37975245729 -0.30795170962  0.01538310471
[11]  0.00015529301  0.00041309133
[1] 37
Time difference of 43.94605 mins
 [1]  1.6014361e-01  3.4066664e+00  2.0920291e-01  3.9129302e-01 -8.1196941e-01
 [6]  4.3969832e+00  0.0000000e+00 -8.5184253e-01 -2.2041235e-01  3.5978217e-02
[11]  3.6409404e-08  9.5551011e-04
[1] 38
Time difference of 38.584322 mins
 [1]  0.1645198103  3.9074895587  0.2215879473  0.3771507191 -0.7521527162
 [6]  2.8839952409  0.0000000000 -0.4371131320 -0.2902656644  0.0260993567
[11]  0.0105969430  0.0007148744
[1] 39
Time difference of 33.800588 mins
 [1]  0.17941599828  4.23588543866  0.26394132898  0.40823453700 -0.77241129379
 [6]  3.70879913575  0.00000000000 -0.88212223155 -0.24896960616  0.03675167187
[11]  0.00498654969  0.00092557134
[1] 40
Time difference of 2.4217739 hours
 [1]  0.18958823138  4.93073181250  0.26829289861  0.40559023683 -0.79712907412
 [6]  3.63588085335  0.00000000000 -0.94930606876 -0.36338651417  0.02325065397
[11]  0.02776500708  0.00014200118
[1] 41
Time difference of 1.2647506 hours
 [1]  5.0724728e-02  6.3195380e+00  3.1744287e-01  4.4545124e-01 -7.5808660e-01
 [6]  4.4951464e+00  0.0000000e+00 -3.6508248e-01 -1.8296763e-01  3.9833165e-02
[11]  6.5604318e-08  4.7542840e-04
