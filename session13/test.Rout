
R version 3.3.3 (2017-03-06) -- "Another Canoe"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> set.seed(19955)
> 
> n = 50
> len = 2501
> par = c(0.1, 6,  0.25,  0.6,  -0.8,  3,  0,  -0.6,  -0.3, 0.025, 0.02, 0.002)
> 
> require(Rcpp)
Loading required package: Rcpp
> require(BH)
Loading required package: BH
> require(nloptr)
Loading required package: nloptr
> require(ggplot2)
Loading required package: ggplot2
> require(gridExtra)
Loading required package: gridExtra
> options(digits=8)
> source('../conv_plot.R')
> sourceCpp('../Simulation.cpp')
> sourceCpp('../nll.cpp', verbose = F)
> 
> opts <- list(algorithm="NLOPT_LN_NELDERMEAD", xtol_rel = 1.0e-5, maxeval = 10000)
> # set lower and upper bound
> lb = c(-0.5, 0.001, 1e-6, 0.001, -0.95, 0, 0, -0.95, -1, 0, 0, 0)
> ub = c(1, 100, 10, 1, 0.95, 10, 0, 0, 0, 1, 1, 1)
> 
> npar = 12
> # run n paths
> converge.list = matrix(, nrow = n, ncol = npar)
> est.par.list = matrix(, nrow = n, ncol = npar)
> success.list = vector(mode="numeric", length = n)
> 
> i = 1
> while(i <= n) {
+     seed = sample(10000, 5)
+     sim = SimOUSVJJ(par, len, log(100), par[3], 1/252, seed[1], seed[2], seed[3], seed[4], seed[5])
+     y = sim$y
+ 
+ 	f <- function(p) {
+ 	    return(nll(p, y))
+ 	}
+     
+     start = Sys.time()
+     result = nloptr(x0 = par, eval_f = f, 
+        opts = opts, 
+        lb = lb, ub = ub)
+     if(result$status < 0)
+         next;
+ 	est_list = as.numeric(result$solution)
+ 	c_list = check.converge(f, result$solution)
+ 	m_list = check.mono(f, result$solution)
+     flag = all(m_list | c_list)
+ 
+     write.table(est_list, file = "./est.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+ 	write.table(c_list, file = "./conv.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+     write.table(flag, file = "./success.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+     
+     print(i)
+     print(Sys.time() - start)
+     print(est_list)
+     
+     est.par.list[i, ] = as.numeric(est_list)
+     converge.list[i, ] = c_list
+     success.list[i] = flag
+ 	i = i + 1
+ }
[1] 1
Time difference of 1.1167636 hours
 [1]  1.0970894e-01  3.3219747e+00  2.5146605e-01  4.2277197e-01 -8.2565101e-01
 [6]  3.2234770e+00  0.0000000e+00 -2.6764956e-04 -2.9807385e-01  1.4323456e-02
[11]  2.6520801e-03  1.6217795e-09
[1] 2
Time difference of 36.293584 mins
 [1]  1.6016640e-01  4.3003899e+00  2.0488085e-01  4.0731327e-01 -8.2232945e-01
 [6]  3.4838347e+00  0.0000000e+00 -8.6361567e-01 -2.7375856e-01  2.0492466e-02
[11]  2.9321173e-02  1.8301342e-05
[1] 3
Time difference of 1.5544773 hours
 [1]  1.8923890e-01  3.9610426e+00  2.2000091e-01  4.0942823e-01 -8.0753472e-01
 [6]  3.3153928e+00  0.0000000e+00 -6.6426587e-05 -2.2717601e-01  2.1479930e-02
[11]  4.1078226e-02  6.9005924e-08
[1] 4
Time difference of 59.951871 mins
 [1]  1.8260010e-01  5.0311073e+00  2.3090963e-01  4.0339215e-01 -7.4517406e-01
 [6]  2.9131611e+00  0.0000000e+00 -1.3323514e-06 -2.7761349e-01  1.5588271e-02
[11]  1.4916874e-02  4.9590098e-04
[1] 5
Time difference of 52.255861 mins
 [1]  0.15520928481  4.98539836919  0.25851689112  0.41664411522 -0.73960603405
 [6]  3.45262784635  0.00000000000 -0.94908898091 -0.26928596436  0.03331774327
[11]  0.01189018930  0.00023441209
[1] 6
Time difference of 2.6025352 hours
 [1]  2.0719533e-01  5.4998868e+00  2.5467927e-01  4.1258719e-01 -8.1998654e-01
 [6]  2.8066716e+00  0.0000000e+00 -9.4998483e-01 -3.4594958e-01  4.1409918e-02
[11]  4.4663048e-09  8.6215114e-04
[1] 7
Time difference of 46.109243 mins
 [1]  0.16767638254  4.12303803367  0.25529429046  0.40983497215 -0.75038211882
 [6]  4.03433116280  0.00000000000 -0.35163077615 -0.34282719546  0.02159640874
[11]  0.01482096584  0.00037305269
[1] 8
Time difference of 2.472345 hours
 [1]  0.1409443075  4.6381681817  0.2755263914  0.4055517076 -0.7750251795
 [6]  2.4286746632  0.0000000000 -0.1285340663 -0.3610540585  0.0096459026
[11]  0.0452502877  0.0000000000
[1] 9
Time difference of 2.1908278 hours
 [1]  1.7120359e-01  3.3055547e+00  2.4450167e-01  4.0514106e-01 -7.9983289e-01
 [6]  2.7018548e+00  0.0000000e+00 -2.5451598e-06 -2.6173820e-01  2.6247852e-02
[11]  4.6437502e-08  8.1770827e-04
[1] 10
Time difference of 1.1888499 hours
 [1]  1.7491472e-01  2.4231594e+00  1.9365147e-01  4.0565505e-01 -7.8131864e-01
 [6]  2.4256391e+00  0.0000000e+00 -4.8447865e-01 -2.2825475e-01  2.1190036e-02
[11]  8.2961919e-03  1.5376248e-08
[1] 11
Time difference of 1.2165654 hours
 [1]  0.18159089516  4.16251619117  0.22644179519  0.40629865043 -0.73359721561
 [6]  3.53061903043  0.00000000000 -0.94999394164 -0.35319721323  0.04109632990
[11]  0.01815827020  0.00039010614
[1] 12
Time difference of 1.1255513 hours
 [1]  0.13295722457  5.87305643382  0.24224379097  0.42227769899 -0.83414014452
 [6]  4.27757019298  0.00000000000 -0.94999984909 -0.23962855898  0.02804416652
[11]  0.01160723445  0.00066575062
[1] 13
Time difference of 3.8301775 hours
 [1]  0.1642957494  4.9605898807  0.2347495355  0.4039470518 -0.7926707677
 [6]  2.4594852211  0.0000000000 -0.3793079143 -0.2818208956  0.0279884546
[11]  0.0185061795  0.0014181439
[1] 14
Time difference of 44.528224 mins
 [1]  0.10371787722  3.83467014083  0.24664104240  0.38905737298 -0.79430045387
 [6]  3.75793525273  0.00000000000 -0.58973681048 -0.33880414721  0.02546908145
[11]  0.00542945612  0.00064284933
[1] 15
Time difference of 42.049777 mins
 [1]  1.3042385e-01  4.5492443e+00  2.7104617e-01  4.1505090e-01 -8.1695115e-01
 [6]  3.7629050e+00  0.0000000e+00 -1.1161245e-06 -3.4489417e-01  2.1531990e-02
[11]  3.8715890e-03  1.2252337e-03
[1] 16
Time difference of 39.286217 mins
 [1]  0.1282282727  4.1402505560  0.2120985333  0.3930214348 -0.8218939288
 [6]  3.5683496309  0.0000000000 -0.1230315862 -0.2982513354  0.0292096834
[11]  0.0147243587  0.0006060213
[1] 17
Time difference of 1.031477 hours
 [1]  1.9763923e-01  4.0426788e+00  2.2481012e-01  4.0460207e-01 -8.7073744e-01
 [6]  3.1087713e+00  0.0000000e+00 -4.7822867e-01 -2.8188034e-01  2.6313529e-02
[11]  1.9451086e-02  5.0881944e-11
[1] 18
Time difference of 1.9702245 hours
 [1]  1.6206161e-01  3.3111057e+00  2.0159243e-01  3.9131176e-01 -8.1700515e-01
 [6]  3.7900117e+00  0.0000000e+00 -1.5462396e-06 -2.1766833e-01  3.2877590e-02
[11]  2.0216279e-05  8.4984314e-04
[1] 19
Time difference of 1.7144036 hours
 [1]  1.2601048e-01  5.3663181e+00  2.4826826e-01  4.1683346e-01 -7.7003834e-01
 [6]  3.6606754e+00  0.0000000e+00 -9.4999151e-01 -3.0400599e-01  3.0131429e-02
[11]  3.3147457e-02  8.7972453e-05
[1] 20
Time difference of 1.6945039 hours
 [1]  0.18981239324  4.40735481390  0.22708204281  0.41235056926 -0.82156133998
 [6]  2.68204611335  0.00000000000 -0.00000748962 -0.29710374716  0.02736401078
[11]  0.00981145738  0.00120601185
[1] 21
Time difference of 39.375518 mins
 [1]  0.15130728804  4.18262258540  0.21889896980  0.38055929299 -0.77584096345
 [6]  3.20835978087  0.00000000000 -0.08151122090 -0.29170463021  0.04006502363
[11]  0.02367586445  0.00056409466
[1] 22
Time difference of 39.519909 mins
 [1]  1.4065824e-01  4.0487652e+00  2.4208796e-01  3.9853075e-01 -8.4040761e-01
 [6]  2.7799321e+00  0.0000000e+00 -1.1024656e-02 -3.0171748e-01  3.3641340e-02
[11]  6.7041667e-08  9.1999009e-04
[1] 23
Time difference of 36.838616 mins
 [1]  1.8279349e-01  4.6920755e+00  2.3239458e-01  4.0251615e-01 -8.2762338e-01
 [6]  4.0917369e+00  0.0000000e+00 -2.6367651e-05 -2.8093604e-01  2.8660149e-02
[11]  7.1896636e-03  7.4735164e-04
[1] 24
Time difference of 1.9330896 hours
 [1]  0.15926774918  4.66357765950  0.24281139236  0.40507404578 -0.80923344878
 [6]  3.25914721693  0.00000000000 -0.94999713024 -0.30516605753  0.02268358737
[11]  0.02845648640  0.00012097151
[1] 25
Time difference of 1.851968 hours
 [1]  1.6970429e-01  4.4780406e+00  2.6543821e-01  3.9475586e-01 -7.8997445e-01
 [6]  3.7464466e+00  0.0000000e+00 -1.4714163e-05 -2.4062725e-01  1.8235540e-02
[11]  3.2333787e-06  7.1678768e-04
[1] 26
Time difference of 37.021436 mins
 [1]  0.08819938216  4.74969322125  0.26984602433  0.40652478733 -0.77839864093
 [6]  3.42220868754  0.00000000000 -0.73007291971 -0.27027954326  0.04770006921
[11]  0.00107773373  0.00063877134
[1] 27
Time difference of 1.3567552 hours
 [1]  1.3553722e-01  4.0931126e+00  2.4120080e-01  4.0629629e-01 -7.7703125e-01
 [6]  4.4954959e+00  0.0000000e+00 -1.1810358e-07 -2.1156339e-01  3.5382149e-02
[11]  5.1244356e-03  5.3653106e-04
[1] 28
Time difference of 3.1182246 hours
 [1]  1.7296048e-01  4.1912501e+00  2.4484541e-01  4.2314053e-01 -8.1915635e-01
 [6]  3.1668140e+00  0.0000000e+00 -4.6782935e-04 -3.2053726e-01  2.2535330e-02
[11]  7.7499397e-07  3.4201807e-04
[1] 29
Time difference of 57.717154 mins
 [1]  0.18352446349  5.97883225836  0.22283378986  0.41748331745 -0.82716184146
 [6]  2.52946119033  0.00000000000 -0.94997523826 -0.24142815347  0.03930287633
[11]  0.00661257859  0.00024787306
[1] 30
Time difference of 50.696973 mins
 [1]  1.0575829e-01  4.4510792e+00  2.5155435e-01  4.1239741e-01 -7.6621026e-01
 [6]  3.1443668e+00  0.0000000e+00 -7.4013351e-01 -2.6976062e-01  2.6340330e-02
[11]  1.9525273e-07  3.2942646e-04
[1] 31
Time difference of 49.353864 mins
 [1]  1.8099804e-01  4.8483680e+00  1.9431351e-01  3.9623607e-01 -8.5939949e-01
 [6]  3.2784098e+00  0.0000000e+00 -4.0601014e-01 -2.9065374e-01  3.9251379e-02
[11]  3.5944038e-02  7.2627941e-13
[1] 32
Time difference of 43.646102 mins
 [1]  0.16179432422  2.62821563693  0.23670012487  0.37882809455 -0.82064088936
 [6]  3.41750111340  0.00000000000 -0.46970361439 -0.27616222678  0.02009883469
[11]  0.01264912487  0.00037015609
[1] 33
Time difference of 42.049391 mins
 [1]  1.5707197e-01  4.4893819e+00  2.1430842e-01  3.8311425e-01 -7.6046808e-01
 [6]  3.1319849e+00  0.0000000e+00 -6.8906143e-01 -2.3006330e-01  2.3664683e-02
[11]  3.4730981e-09  0.0000000e+00
[1] 34
Time difference of 1.4107983 hours
 [1]  1.8430030e-01  3.8630637e+00  2.2414277e-01  3.9234692e-01 -7.8786718e-01
 [6]  3.5589181e+00  0.0000000e+00 -9.0215538e-04 -3.3700009e-01  2.0751945e-02
[11]  3.2064431e-02  1.7230083e-06
[1] 35
Time difference of 47.760236 mins
 [1]  0.17260901534  5.12940981147  0.22680147186  0.42350687767 -0.78939412051
 [6]  2.92302745273  0.00000000000 -0.94953747271 -0.32878435986  0.03528533182
[11]  0.01544034378  0.00016504124
