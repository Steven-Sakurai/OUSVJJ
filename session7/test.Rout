
R version 3.3.3 (2017-03-06) -- "Another Canoe"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> set.seed(2844)
> 
> n = 50
> len = 2501
> par = c(0.1, 6,  0.25,  0.6,  -0.8,  3,  0,  -0.6,  -0.3, 0.025, 0.02, 0.002)
> 
> require(Rcpp)
Loading required package: Rcpp
> require(BH)
Loading required package: BH
> require(nloptr)
Loading required package: nloptr
> require(ggplot2)
Loading required package: ggplot2
> require(gridExtra)
Loading required package: gridExtra
> options(digits=8)
> source('../conv_plot.R')
> sourceCpp('../Simulation.cpp')
> sourceCpp('../nll.cpp', verbose = F)
> 
> opts <- list(algorithm="NLOPT_LN_NELDERMEAD", xtol_rel = 1.0e-5, maxeval = 10000)
> # set lower and upper bound
> lb = c(-0.5, 0.001, 1e-6, 0.001, -0.95, 0, 0, -0.95, -1, 0, 0, 0)
> ub = c(1, 100, 10, 1, 0.95, 10, 0, 0, 0, 1, 1, 1)
> 
> npar = 12
> # run n paths
> converge.list = matrix(, nrow = n, ncol = npar)
> est.par.list = matrix(, nrow = n, ncol = npar)
> success.list = vector(mode="numeric", length = n)
> 
> i = 1
> while(i <= n) {
+     seed = sample(10000, 5)
+     sim = SimOUSVJJ(par, len, log(100), par[3], 1/252, seed[1], seed[2], seed[3], seed[4], seed[5])
+     y = sim$y
+ 
+ 	f <- function(p) {
+ 	    return(nll(p, y))
+ 	}
+     
+     start = Sys.time()
+     result = nloptr(x0 = par, eval_f = f, 
+        opts = opts, 
+        lb = lb, ub = ub)
+     if(result$status < 0)
+         next;
+ 	est_list = as.numeric(result$solution)
+ 	c_list = check.converge(f, result$solution)
+ 	m_list = check.mono(f, result$solution)
+     flag = all(m_list | c_list)
+ 
+     write.table(est_list, file = "./est.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+ 	write.table(c_list, file = "./conv.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+     write.table(flag, file = "./success.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+     
+     print(i)
+     print(Sys.time() - start)
+     print(est_list)
+     
+     est.par.list[i, ] = as.numeric(est_list)
+     converge.list[i, ] = c_list
+     success.list[i] = flag
+ 	i = i + 1
+ }
[1] 1
Time difference of 1.023894 hours
 [1]  0.11511945231  4.74837651909  0.28516774776  0.41712070823 -0.80315250863
 [6]  2.69944198523  0.00000000000 -0.94989007580 -0.32879873959  0.01979611409
[11]  0.01623616431  0.00055626368
[1] 2
Time difference of 27.168229 mins
 [1] -0.02777898421  5.82869880320  0.30805499443  0.43439427044 -0.77905785012
 [6]  3.40289320638  0.00000000000 -0.94234844423 -0.24406017633  0.02585691054
[11]  0.00285249845  0.00030262425
[1] 3
Time difference of 1.0263055 hours
 [1]  0.17828038844  3.89046379531  0.24193014380  0.40678244308 -0.78161650168
 [6]  3.20661054524  0.00000000000 -0.09594375125 -0.25620926071  0.03456538373
[11]  0.03364169318  0.00011217579
[1] 4
Time difference of 52.310701 mins
 [1]  7.1618369e-02  5.0376482e+00  2.3282942e-01  4.1891843e-01 -7.6648895e-01
 [6]  1.8725636e+00  0.0000000e+00 -4.0514857e-01 -3.2816394e-01  1.9004902e-02
[11]  4.4651612e-02  1.2552771e-07
[1] 5
Time difference of 56.832396 mins
 [1]  1.6388588e-01  3.6750044e+00  2.2547896e-01  4.1941912e-01 -8.4260295e-01
 [6]  2.2452345e+00  0.0000000e+00 -9.4924904e-01 -2.7357174e-01  1.9397894e-02
[11]  1.2234183e-08  2.0433424e-05
[1] 6
Time difference of 1.2608486 hours
 [1]  0.11155044491  6.03022467798  0.28181245375  0.42101387308 -0.78352130652
 [6]  2.89768437111  0.00000000000 -0.00012611888 -0.30636956029  0.02158024586
[11]  0.02077963304  0.00021108441
[1] 7
Time difference of 52.756231 mins
 [1]  0.13370559745  3.91817957238  0.24024260087  0.39214756585 -0.80027577042
 [6]  2.90168524829  0.00000000000 -0.94976652915 -0.28553232678  0.03979101298
[11]  0.00438240890  0.00096126826
[1] 8
Time difference of 54.314163 mins
 [1]  0.17255181503  4.69918838375  0.22584563513  0.42618729866 -0.76778184132
 [6]  3.45026470529  0.00000000000 -0.47408457111 -0.23819281557  0.02649902965
[11]  0.00592062587  0.00043663009
[1] 9
Time difference of 1.2671246 hours
 [1]  0.14583655898  3.56756533755  0.21958499499  0.39193715050 -0.81742423537
 [6]  3.69596651484  0.00000000000 -0.94995192985 -0.23296933063  0.03341151426
[11]  0.00027067673  0.00082051079
[1] 10
Time difference of 34.224347 mins
 [1]  0.152037291  4.610405358  0.219505668  0.415054770 -0.837796085
 [6]  3.027481255  0.000000000 -0.331596787 -0.304253125  0.018982116
[11]  0.028695815  0.000000000
[1] 11
Time difference of 49.002148 mins
 [1]  0.162342296  4.263271570  0.244613909  0.403895322 -0.765802202
 [6]  3.191060617  0.000000000 -0.247682389 -0.326206278  0.025024562
[11]  0.027032790  0.000000000
[1] 12
Time difference of 2.5525087 hours
 [1]  0.1094215988  4.4812318881  0.2539023532  0.3964554745 -0.7679890288
 [6]  2.4871030613  0.0000000000 -0.9499993634 -0.3543622513  0.0237187969
[11]  0.0194980612  0.0004400043
[1] 13
Time difference of 1.6532071 hours
 [1]  1.2082065e-01  4.7713786e+00  2.6826979e-01  4.3234500e-01 -7.9681042e-01
 [6]  3.0890575e+00  0.0000000e+00 -7.8409998e-03 -2.6718729e-01  3.8604000e-02
[11]  1.3663596e-07  6.2111150e-04
[1] 14
Time difference of 1.2848535 hours
 [1]  1.4434440e-01  4.5527882e+00  2.4407520e-01  3.9629458e-01 -7.7230506e-01
 [6]  1.3649300e+00  0.0000000e+00 -9.5000000e-01 -2.7087489e-01  3.5524996e-02
[11]  1.2995017e-09  1.8909195e-04
[1] 15
Time difference of 58.07901 mins
 [1]  1.4039868e-01  3.0337996e+00  2.3909450e-01  3.9015906e-01 -7.9064913e-01
 [6]  4.1603936e+00  0.0000000e+00 -9.4977913e-01 -2.9524623e-01  3.1759336e-02
[11]  1.0604771e-08  2.6133944e-04
[1] 16
Time difference of 2.381064 hours
 [1]  1.8627023e-01  3.2366981e+00  2.2426962e-01  4.1312776e-01 -8.3303600e-01
 [6]  2.9221529e+00  0.0000000e+00 -9.4997586e-01 -2.6825744e-01  1.9243403e-02
[11]  3.6078436e-02  4.9796304e-05
[1] 17
Time difference of 1.925554 hours
 [1]  1.4228232e-01  3.8659624e+00  2.0698625e-01  3.8212085e-01 -7.7471196e-01
 [6]  4.0298343e+00  0.0000000e+00 -4.8641678e-05 -2.3619889e-01  2.7497267e-02
[11]  1.4856227e-08  1.2001060e-09
[1] 18
Time difference of 2.0070619 hours
 [1]  1.8408503e-01  3.9580328e+00  2.2526990e-01  3.8625669e-01 -7.9362734e-01
 [6]  3.6883079e+00  0.0000000e+00 -1.5025196e-01 -2.3255334e-01  2.5378002e-02
[11]  3.5285409e-05  6.0468896e-04
[1] 19
Time difference of 38.724428 mins
 [1]  0.16626566228  3.27431972034  0.22103337456  0.38844717041 -0.83757145847
 [6]  3.63348193941  0.00000000000 -0.10182751058 -0.30561618590  0.03677739176
[11]  0.01590652718  0.00052936179
[1] 20
Time difference of 1.4436937 hours
 [1]  0.12195262571  5.13610484433  0.28062608559  0.42616384574 -0.74775103696
 [6]  2.41699512297  0.00000000000 -0.94999960908 -0.30152679671  0.01870261560
[11]  0.00336425296  0.00046278794
[1] 21
Time difference of 1.1615369 hours
 [1]  0.20179423729  4.02142711234  0.19323133908  0.40340805363 -0.79728331800
 [6]  2.58806861911  0.00000000000 -0.29290937385 -0.27178116201  0.02076829184
[11]  0.00656756843  0.00069016043
[1] 22
Time difference of 3.2301937 hours
 [1]  1.5189174e-01  4.9342575e+00  2.2759218e-01  4.0728113e-01 -7.7241229e-01
 [6]  3.2756008e+00  0.0000000e+00 -9.5160664e-08 -3.2001654e-01  2.2539277e-02
[11]  3.2057936e-02  3.5237732e-04
[1] 23
Time difference of 1.2424757 hours
 [1]  1.8791633e-01  3.6738311e+00  2.0316591e-01  3.7260408e-01 -8.4570143e-01
 [6]  2.5797440e+00  0.0000000e+00 -2.0322139e-01 -3.0681279e-01  1.3195823e-02
[11]  2.4728089e-02  2.5861654e-12
[1] 24
Time difference of 1.7663939 hours
 [1]  0.2253797384  4.2871542980  0.1980082088  0.4051815361 -0.7880832411
 [6]  3.0057989230  0.0000000000 -0.9499998899 -0.3079108592  0.0203395635
[11]  0.0212740784  0.0004157932
[1] 25
Time difference of 2.7076719 hours
 [1]  0.19470125294  4.04021380380  0.22182381894  0.41368020955 -0.82186736383
 [6]  3.41029609177  0.00000000000 -0.94999966102 -0.29413499546  0.03320343545
[11]  0.01173693008  0.00072725712
[1] 26
Time difference of 1.1756958 hours
 [1]  1.5789623e-01  3.8846804e+00  2.1796497e-01  4.0141676e-01 -8.0307707e-01
 [6]  3.8655048e+00  0.0000000e+00 -5.8490877e-03 -2.4187721e-01  2.6084796e-02
[11]  5.8284956e-03  6.9247391e-07
[1] 27
Time difference of 1.3102198 hours
 [1]  1.4773943e-01  5.8923935e+00  2.5546522e-01  4.1496127e-01 -7.3275242e-01
 [6]  3.7129152e+00  0.0000000e+00 -5.7768365e-01 -2.4109700e-01  3.1877261e-02
[11]  3.0452719e-02  1.0926788e-13
[1] 28
Time difference of 39.091692 mins
 [1]  0.2032065898  3.8164667314  0.2268155256  0.4126857525 -0.8261531648
 [6]  4.2137682766  0.0000000000 -0.4422331296 -0.2678120018  0.0388689508
[11]  0.0046143048  0.0010357088
[1] 29
Time difference of 1.1452117 hours
 [1]  0.20180900234  4.70983723389  0.25834700475  0.41127316780 -0.81772806416
 [6]  3.53513997924  0.00000000000 -0.61610390237 -0.28457721000  0.02001465875
[11]  0.01291580396  0.00033875342
[1] 30
Time difference of 1.6485738 hours
 [1]  0.1914259313  4.1814661854  0.2482876958  0.4063801420 -0.7973998167
 [6]  1.9797289839  0.0000000000 -0.9499958752 -0.3441310776  0.0260525264
[11]  0.0311042502  0.0001152037
[1] 31
Time difference of 35.615591 mins
 [1]  1.9758488e-01  3.5820412e+00  2.1237645e-01  3.9715491e-01 -8.0108117e-01
 [6]  2.2819886e+00  0.0000000e+00 -1.5574414e-01 -2.1743932e-01  1.5311299e-02
[11]  1.9101693e-02  4.5883491e-05
[1] 32
Time difference of 4.067331 hours
 [1]  1.6939517e-01  4.1555267e+00  2.1418120e-01  3.9659272e-01 -8.2192518e-01
 [6]  4.1572530e+00  0.0000000e+00 -6.4012566e-05 -2.7729798e-01  4.1088569e-02
[11]  2.9004683e-06  8.2713456e-04
