
R version 3.3.3 (2017-03-06) -- "Another Canoe"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> set.seed(19263)
> 
> n = 50
> len = 2501
> par = c(0.1, 6,  0.25,  0.6,  -0.8,  3,  0,  -0.6,  -0.3, 0.025, 0.02, 0.002)
> 
> require(Rcpp)
Loading required package: Rcpp
> require(BH)
Loading required package: BH
> require(nloptr)
Loading required package: nloptr
> require(ggplot2)
Loading required package: ggplot2
> require(gridExtra)
Loading required package: gridExtra
> options(digits=8)
> source('../conv_plot.R')
> sourceCpp('../Simulation.cpp')
> sourceCpp('../nll.cpp', verbose = F)
> 
> opts <- list(algorithm="NLOPT_LN_NELDERMEAD", xtol_rel = 1.0e-5, maxeval = 10000)
> # set lower and upper bound
> lb = c(-0.5, 0.001, 1e-6, 0.001, -0.95, 0, 0, -0.95, -1, 0, 0, 0)
> ub = c(1, 100, 10, 1, 0.95, 10, 0, 0, 0, 1, 1, 1)
> 
> npar = 12
> # run n paths
> converge.list = matrix(, nrow = n, ncol = npar)
> est.par.list = matrix(, nrow = n, ncol = npar)
> success.list = vector(mode="numeric", length = n)
> 
> i = 1
> while(i <= n) {
+     seed = sample(10000, 5)
+     sim = SimOUSVJJ(par, len, log(100), par[3], 1/252, seed[1], seed[2], seed[3], seed[4], seed[5])
+     y = sim$y
+ 
+ 	f <- function(p) {
+ 	    return(nll(p, y))
+ 	}
+     
+     start = Sys.time()
+     result = nloptr(x0 = par, eval_f = f, 
+        opts = opts, 
+        lb = lb, ub = ub)
+     if(result$status < 0)
+         next;
+ 	est_list = as.numeric(result$solution)
+ 	c_list = check.converge(f, result$solution)
+ 	m_list = check.mono(f, result$solution)
+     flag = all(m_list | c_list)
+ 
+     write.table(est_list, file = "./est.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+ 	write.table(c_list, file = "./conv.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+     write.table(flag, file = "./success.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+     
+     print(i)
+     print(Sys.time() - start)
+     print(est_list)
+     
+     est.par.list[i, ] = as.numeric(est_list)
+     converge.list[i, ] = c_list
+     success.list[i] = flag
+ 	i = i + 1
+ }
[1] 1
Time difference of 1.1015579 hours
 [1]  0.1645338694  4.0705087950  0.2727270680  0.4188640822 -0.8334827902
 [6]  2.3820673059  0.0000000000 -0.9499994346 -0.3126680159  0.0242545960
[11]  0.0122188968  0.0003846643
[1] 2
Time difference of 1.8594307 hours
 [1]  1.0483887e-01  5.2022692e+00  2.6810510e-01  4.1748343e-01 -8.0964441e-01
 [6]  2.1858011e+00  0.0000000e+00 -1.2591387e-06 -3.2476737e-01  1.9337267e-02
[11]  9.2739468e-03  7.1697518e-04
[1] 3
Time difference of 59.65465 mins
 [1]  1.8790230e-01  2.9075509e+00  1.7393828e-01  3.8332966e-01 -8.0105685e-01
 [6]  2.7779802e+00  0.0000000e+00 -8.4010482e-02 -2.9593152e-01  1.4370367e-02
[11]  6.2429733e-03  2.7398566e-08
[1] 4
Time difference of 1.7046511 hours
 [1]  1.2055457e-01  4.8775678e+00  2.4889029e-01  4.2222642e-01 -8.1194051e-01
 [6]  3.1189219e+00  0.0000000e+00 -4.2313360e-04 -3.0752172e-01  2.2221603e-02
[11]  2.0716194e-07  9.2495913e-09
[1] 5
Time difference of 1.5411156 hours
 [1]  0.12433687449  4.87119972637  0.28781712738  0.43196094540 -0.74712093891
 [6]  4.85116061368  0.00000000000 -0.94999544478 -0.29624518286  0.03350165781
[11]  0.01203025918  0.00029710093
[1] 6
Time difference of 1.9950394 hours
 [1]  0.11043477117  5.09155203586  0.22692731728  0.41909570390 -0.81989930270
 [6]  2.62805509148  0.00000000000 -0.94999564892 -0.24856659353  0.03649185320
[11]  0.02147453818  0.00023255221
[1] 7
Time difference of 49.740501 mins
 [1]  0.15042884896  4.56631047800  0.24463068811  0.38805121686 -0.80571794631
 [6]  3.17404552965  0.00000000000 -0.56432258665 -0.29255839825  0.02430794175
[11]  0.00594662139  0.00083219711
[1] 8
Time difference of 1.9719862 hours
 [1]  0.16521214055  4.51755154984  0.20791617740  0.40281881928 -0.81034729157
 [6]  2.66029720666  0.00000000000 -0.00243600410 -0.30485226965  0.03658803974
[11]  0.00014478383  0.00078807437
[1] 9
Time difference of 1.771738 hours
 [1]  1.7391695e-01  4.4329348e+00  2.4580129e-01  3.9895248e-01 -7.9768657e-01
 [6]  2.8108626e+00  0.0000000e+00 -9.0271803e-01 -2.7669352e-01  3.6002067e-02
[11]  4.9816125e-07  5.0721192e-06
[1] 10
Time difference of 2.0299503 hours
 [1]  0.14918353876  5.70530916196  0.23772781678  0.42085677398 -0.86504330961
 [6]  2.69006677994  0.00000000000 -0.94998871800 -0.25463637430  0.01987643612
[11]  0.02066066226  0.00041678772
[1] 11
Time difference of 1.6087498 hours
 [1]  1.8135423e-01  4.0990431e+00  2.4448787e-01  4.0000045e-01 -7.8019359e-01
 [6]  3.6582258e+00  0.0000000e+00 -1.1365026e-03 -2.7591960e-01  3.2708296e-02
[11]  1.2754780e-06  3.3621582e-04
[1] 12
Time difference of 31.547037 mins
 [1]  1.3149846e-01  3.7063416e+00  2.6169732e-01  4.2859291e-01 -7.7319047e-01
 [6]  2.8389297e+00  0.0000000e+00 -3.5517163e-01 -2.7412411e-01  3.1593212e-02
[11]  3.3396144e-02  2.0449537e-05
[1] 13
Time difference of 1.1367791 hours
 [1]  0.18465134126  3.92959193480  0.23353828178  0.39876632043 -0.78390912953
 [6]  2.35599102194  0.00000000000 -0.42700667833 -0.30189280062  0.02501478496
[11]  0.00221938747  0.00056737578
[1] 14
Time difference of 1.6026293 hours
 [1]  2.1104324e-01  4.7526510e+00  2.0365602e-01  3.8332455e-01 -7.5852194e-01
 [6]  2.7689198e+00  0.0000000e+00 -9.4999107e-01 -2.8459471e-01  3.2245683e-02
[11]  1.1300047e-02  9.9722144e-05
[1] 15
Time difference of 1.3346587 hours
 [1]  0.10102752945  4.90254305979  0.22983191639  0.39295212763 -0.78958247228
 [6]  3.41625732488  0.00000000000 -0.94999089376 -0.34432945792  0.02400511797
[11]  0.01296399544  0.00028353633
[1] 16
Time difference of 1.192347 hours
 [1]  1.3998669e-01  3.8603372e+00  2.4898982e-01  4.1657222e-01 -8.2685578e-01
 [6]  2.7977170e+00  0.0000000e+00 -2.7031622e-06 -2.8527068e-01  2.4503007e-02
[11]  8.1168562e-03  9.6348432e-04
[1] 17
Time difference of 1.7739379 hours
 [1]  1.1177531e-01  3.4540216e+00  2.7011077e-01  4.0298887e-01 -8.4108637e-01
 [6]  3.0210526e+00  0.0000000e+00 -1.0667445e-05 -2.3789769e-01  2.7063163e-02
[11]  1.1594049e-04  7.4719444e-04
[1] 18
Time difference of 41.145531 mins
 [1]  0.1772650119  3.8594873504  0.2522937685  0.3943893618 -0.8041973621
 [6]  2.9520381095  0.0000000000 -0.7751246680 -0.3025449528  0.0362645731
[11]  0.0087432995  0.0010177308
[1] 19
Time difference of 44.60974 mins
 [1]  0.17016398908  4.91554073250  0.21316802930  0.40394726571 -0.76968530043
 [6]  3.72777892148  0.00000000000 -0.23816798997 -0.30250249468  0.02841886736
[11]  0.01311887202  0.00059376534
[1] 20
Time difference of 51.698782 mins
 [1]  0.14031213951  3.34525233208  0.25671152394  0.39334676490 -0.81196258382
 [6]  2.51366721851  0.00000000000 -0.94975161559 -0.32140559831  0.03256767949
[11]  0.03373531753  0.00013805203
[1] 21
Time difference of 1.1296475 hours
 [1]  1.2791871e-01  4.2139833e+00  2.4301412e-01  4.1056832e-01 -8.3142983e-01
 [6]  3.1791497e+00  0.0000000e+00 -2.3746303e-07 -2.7470288e-01  2.3669213e-02
[11]  9.0453265e-04  6.4590019e-04
[1] 22
Time difference of 2.2619909 hours
 [1]  1.2808996e-01  4.6390051e+00  2.7496741e-01  4.3269228e-01 -8.0399314e-01
 [6]  3.3218587e+00  0.0000000e+00 -9.8204127e-06 -3.1459051e-01  2.2636291e-02
[11]  2.2210073e-02  3.1385570e-04
[1] 23
Time difference of 1.1828497 hours
 [1]  1.5779421e-01  4.0343320e+00  2.4117867e-01  4.1384670e-01 -8.1001812e-01
 [6]  3.0962978e+00  0.0000000e+00 -1.4180129e-05 -3.1714960e-01  2.5652504e-02
[11]  2.8321546e-03  9.0688654e-04
[1] 24
Time difference of 1.2331437 hours
 [1]  1.6518815e-01  3.5428528e+00  2.5958124e-01  4.1850014e-01 -7.7188118e-01
 [6]  3.2266921e+00  0.0000000e+00 -8.4743279e-01 -3.1756188e-01  3.0120690e-02
[11]  1.7286137e-06  5.1078815e-04
[1] 25
Time difference of 1.0405693 hours
 [1]  1.0563923e-01  4.6055188e+00  2.7768282e-01  4.1952417e-01 -8.1566303e-01
 [6]  3.9143557e+00  0.0000000e+00 -9.3855548e-01 -2.8680348e-01  2.5884440e-02
[11]  4.7957582e-08  9.8563359e-05
[1] 26
Time difference of 1.0823453 hours
 [1]  1.8908099e-01  3.9809846e+00  1.4741912e-01  3.7014716e-01 -8.0888349e-01
 [6]  2.9287612e+00  0.0000000e+00 -7.8543660e-07 -2.2370768e-01  3.2055492e-02
[11]  1.4763947e-02  8.7400882e-04
[1] 27
Time difference of 1.6507822 hours
 [1]  1.3394437e-01  4.8137004e+00  2.4007294e-01  3.9782487e-01 -8.1395849e-01
 [6]  3.7381263e+00  0.0000000e+00 -6.5677957e-07 -2.8891072e-01  2.5185273e-02
[11]  2.2234109e-02  3.1310386e-04
[1] 28
Time difference of 59.406029 mins
 [1]  0.1534589186  3.9998222606  0.2379868969  0.4040009194 -0.8179514904
 [6]  3.7329589771  0.0000000000 -0.9499337153 -0.2941931601  0.0336312869
[11]  0.0011506673  0.0002336338
[1] 29
Time difference of 1.3436673 hours
 [1]  0.04905570546  4.85512249926  0.27935853370  0.40919945120 -0.75854061933
 [6]  3.22457825859  0.00000000000 -0.94993575855 -0.23882929974  0.02985283177
[11]  0.00178023458  0.00050572176
[1] 30
Time difference of 2.4332481 hours
 [1]  1.1575668e-01  3.8653523e+00  2.4536309e-01  3.9614942e-01 -7.6940430e-01
 [6]  3.7354549e+00  0.0000000e+00 -1.3922516e-03 -2.3270370e-01  1.3703103e-02
[11]  2.3422781e-05  2.3389052e-04
[1] 31
Time difference of 55.581496 mins
 [1]  0.17270937750  4.68737474998  0.23301562653  0.41732411546 -0.81781790512
 [6]  2.31227305478  0.00000000000 -0.07785457496 -0.37958588822  0.01443398192
[11]  0.02836917531  0.00021603632
[1] 32
Time difference of 42.40387 mins
 [1]  0.15660030082  4.06111787895  0.24057267786  0.39950417692 -0.77708734308
 [6]  2.03541949843  0.00000000000 -0.38526003818 -0.29374929444  0.03916326523
[11]  0.00650425019  0.00034347612
[1] 33
Time difference of 2.0055442 hours
 [1]  0.07108499091  4.82064194719  0.25228069429  0.40376598795 -0.77716685994
 [6]  2.70581430387  0.00000000000 -0.94999782278 -0.39354201879  0.00868693934
[11]  0.03449903792  0.00006985488
[1] 34
Time difference of 42.171113 mins
 [1]  0.179491107  4.778504986  0.193334419  0.382673761 -0.773003193
 [6]  2.700120692  0.000000000 -0.416929924 -0.295065598  0.022876241
[11]  0.019231927  0.001038425
