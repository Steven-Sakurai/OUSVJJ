
R version 3.3.3 (2017-03-06) -- "Another Canoe"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> set.seed(2242)
> 
> n = 50
> len = 2501
> par = c(0.1, 6,  0.25,  0.6,  -0.8,  3,  0,  -0.6,  -0.3, 0.025, 0.02, 0.002)
> 
> require(Rcpp)
Loading required package: Rcpp
> require(BH)
Loading required package: BH
> require(nloptr)
Loading required package: nloptr
> require(ggplot2)
Loading required package: ggplot2
> require(gridExtra)
Loading required package: gridExtra
> options(digits=8)
> source('../conv_plot.R')
> sourceCpp('../Simulation.cpp')
> sourceCpp('../nll.cpp', verbose = F)
> 
> opts <- list(algorithm="NLOPT_LN_NELDERMEAD", xtol_rel = 1.0e-5, maxeval = 10000)
> # set lower and upper bound
> lb = c(-0.5, 0.001, 1e-6, 0.001, -0.95, 0, 0, -0.95, -1, 0, 0, 0)
> ub = c(1, 100, 10, 1, 0.95, 10, 0, 0, 0, 1, 1, 1)
> 
> npar = 12
> # run n paths
> converge.list = matrix(, nrow = n, ncol = npar)
> est.par.list = matrix(, nrow = n, ncol = npar)
> success.list = vector(mode="numeric", length = n)
> 
> i = 1
> while(i <= n) {
+     seed = sample(10000, 5)
+     sim = SimOUSVJJ(par, len, log(100), par[3], 1/252, seed[1], seed[2], seed[3], seed[4], seed[5])
+     y = sim$y
+ 
+ 	f <- function(p) {
+ 	    return(nll(p, y))
+ 	}
+     
+     start = Sys.time()
+     result = nloptr(x0 = par, eval_f = f, 
+        opts = opts, 
+        lb = lb, ub = ub)
+     if(result$status < 0)
+         next;
+ 	est_list = as.numeric(result$solution)
+ 	c_list = check.converge(f, result$solution)
+ 	m_list = check.mono(f, result$solution)
+     flag = all(m_list | c_list)
+ 
+     write.table(est_list, file = "./est.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+ 	write.table(c_list, file = "./conv.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+     write.table(flag, file = "./success.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+     
+     print(i)
+     print(Sys.time() - start)
+     print(est_list)
+     
+     est.par.list[i, ] = as.numeric(est_list)
+     converge.list[i, ] = c_list
+     success.list[i] = flag
+ 	i = i + 1
+ }
[1] 1
Time difference of 58.295064 mins
 [1]  0.128179481  3.791586188  0.274957001  0.418643648 -0.824339112
 [6]  2.056277462  0.000000000 -0.614181785 -0.379160605  0.019350767
[11]  0.031531507  0.000000000
[1] 2
Time difference of 2.0743218 hours
 [1]  0.13585405742  6.26702666225  0.29683201984  0.42057643705 -0.76243268566
 [6]  3.13356832670  0.00000000000 -0.94997794098 -0.30378434320  0.03151115687
[11]  0.01039176720  0.00027267784
[1] 3
Time difference of 1.2678191 hours
 [1]  0.16465896286  3.34976169866  0.20294149584  0.39066316121 -0.79515056073
 [6]  3.59534845630  0.00000000000 -0.94998198781 -0.28321050530  0.02322280993
[11]  0.01350102434  0.00065031958
[1] 4
Time difference of 44.556504 mins
 [1]  2.2552330e-01  4.7600417e+00  2.3253476e-01  4.2010281e-01 -8.0125673e-01
 [6]  3.0759000e+00  0.0000000e+00 -4.1136746e-02 -2.9565991e-01  3.6014999e-02
[11]  2.4581268e-02  1.3880603e-07
[1] 5
Time difference of 25.849148 mins
 [1]  0.15479618047  5.06013477813  0.22940014442  0.43428625016 -0.77202851068
 [6]  3.79814498690  0.00000000000 -0.93010980659 -0.30363629157  0.01857336837
[11]  0.00839969267  0.00015928969
[1] 6
Time difference of 42.554311 mins
 [1]  0.1347278313  3.9576054892  0.2944305954  0.4353590883 -0.7888489800
 [6]  3.1686554972  0.0000000000 -0.5940929128 -0.2917775458  0.0275998473
[11]  0.0074068137  0.0000000000
[1] 7
Time difference of 1.1159647 hours
 [1]  1.3815866e-01  5.5799531e+00  2.1929856e-01  4.2460034e-01 -8.0098999e-01
 [6]  3.0443528e+00  0.0000000e+00 -1.7342235e-01 -2.6654174e-01  3.2731073e-02
[11]  1.3156335e-06  4.0317887e-04
[1] 8
Time difference of 1.4018182 hours
 [1]  1.5760141e-01  2.4719287e+00  2.7176314e-01  3.8012530e-01 -7.7393518e-01
 [6]  1.9990367e+00  0.0000000e+00 -2.2477798e-01 -2.8906437e-01  3.0667953e-02
[11]  6.7581885e-07  7.5177698e-04
[1] 9
Time difference of 45.161229 mins
 [1]  0.19509303913  4.57136817205  0.20573304675  0.39486298645 -0.79800652198
 [6]  3.22436718657  0.00000000000 -0.11426042479 -0.28549155733  0.01316905221
[11]  0.00594769673  0.00086407354
[1] 10
Time difference of 2.1675183 hours
 [1]  0.14147103498  4.34519485795  0.24914549902  0.40324973867 -0.78478708004
 [6]  2.34776536330  0.00000000000 -0.19679148017 -0.29848754072  0.02383894988
[11]  0.00878522250  0.00066578814
[1] 11
Time difference of 1.23677 hours
 [1]  0.1574635900  3.8393376286  0.2625184852  0.4040299794 -0.7962600256
 [6]  2.6106241625  0.0000000000 -0.9499979870 -0.3012702579  0.0335786148
[11]  0.0097391152  0.0005900472
[1] 12
Time difference of 1.9137226 hours
 [1]  1.5510328e-01  4.0962178e+00  2.6719307e-01  4.0348730e-01 -8.1639521e-01
 [6]  3.6950338e+00  0.0000000e+00 -1.8528475e-01 -2.4495610e-01  2.1169328e-02
[11]  2.2078471e-06  7.4240312e-04
[1] 13
Time difference of 1.5405971 hours
 [1]  1.5554445e-01  4.0817347e+00  2.3744909e-01  3.9655302e-01 -7.9427398e-01
 [6]  3.5560442e+00  0.0000000e+00 -8.6493617e-01 -2.5663730e-01  2.7437791e-02
[11]  4.1651502e-08  3.2114174e-04
[1] 14
Time difference of 2.6288479 hours
 [1]  1.8769290e-01  4.9833463e+00  2.3786609e-01  4.1450270e-01 -8.2927137e-01
 [6]  3.2266553e+00  0.0000000e+00 -8.3017076e-07 -2.8214853e-01  2.8595039e-02
[11]  6.6305642e-03  4.6899689e-04
[1] 15
Time difference of 1.4586133 hours
 [1]  0.13781184816  3.83878914291  0.24344969998  0.41699148934 -0.78741195593
 [6]  2.55597370600  0.00000000000 -0.94999729636 -0.33864687855  0.02245507554
[11]  0.02786698538  0.00032112148
[1] 16
Time difference of 1.4892365 hours
 [1]  5.0081644e-02  5.8523956e+00  2.8318191e-01  4.2236141e-01 -8.1872011e-01
 [6]  3.1250585e+00  0.0000000e+00 -9.4997541e-01 -2.9229212e-01  3.7441958e-02
[11]  1.9141249e-02  9.3459778e-05
[1] 17
Time difference of 1.0780826 hours
 [1]  1.6256582e-01  3.3016028e+00  2.5457121e-01  4.0064703e-01 -7.8133728e-01
 [6]  2.5125680e+00  0.0000000e+00 -9.4295535e-01 -2.7694227e-01  2.6429437e-02
[11]  7.7667163e-10  0.0000000e+00
[1] 18
Time difference of 1.1405304 hours
 [1]  1.5453094e-01  5.0217563e+00  2.0878633e-01  4.0571014e-01 -8.2485717e-01
 [6]  2.3729665e+00  0.0000000e+00 -2.1234066e-01 -2.7293311e-01  2.7707743e-02
[11]  2.3115764e-07  8.4507653e-04
[1] 19
Time difference of 2.4182229 hours
 [1]  1.5527392e-01  4.1686640e+00  1.8728031e-01  4.0459583e-01 -8.0053953e-01
 [6]  2.1672992e+00  0.0000000e+00 -9.4918936e-01 -3.4378076e-01  1.6196469e-02
[11]  4.2042278e-02  1.1376963e-05
[1] 20
Time difference of 1.1002451 hours
 [1]  6.0420130e-02  5.1367734e+00  2.8068692e-01  3.9439766e-01 -7.7634446e-01
 [6]  3.7154185e+00  0.0000000e+00 -8.9750275e-08 -2.5982088e-01  3.4166450e-02
[11]  2.5286819e-02  3.3374065e-04
[1] 21
Time difference of 3.7350605 hours
 [1]  0.06418153967  5.06975350032  0.23269675305  0.41153167448 -0.79367745411
 [6]  3.90429411442  0.00000000000 -0.44399365034 -0.26967224556  0.02385794221
[11]  0.02265629972  0.00052803317
[1] 22
Time difference of 43.762097 mins
 [1]  0.14621810327  4.72465063835  0.21636857021  0.42446176140 -0.82515327815
 [6]  4.01491321503  0.00000000000 -0.51510344819 -0.27963228415  0.03145059607
[11]  0.02484318107  0.00040790531
[1] 23
Time difference of 1.8017412 hours
 [1]  0.18211241232  4.36611118032  0.20151101610  0.40593018612 -0.80849034841
 [6]  3.46995096082  0.00000000000 -0.94999953673 -0.28973624247  0.02984806816
[11]  0.01733438817  0.00015588653
[1] 24
Time difference of 35.422653 mins
 [1]  0.13005258983  3.16890705451  0.22980079920  0.39306297023 -0.81081448926
 [6]  3.89817775561  0.00000000000 -0.44383562210 -0.24177550023  0.03071073809
[11]  0.01040626463  0.00078420549
[1] 25
Time difference of 1.0828813 hours
 [1]  0.13598723200  5.34155855327  0.20933050267  0.41069999971 -0.78810391499
 [6]  3.44191852580  0.00000000000 -0.94999870844 -0.26037093953  0.02782099506
[11]  0.02478654145  0.00019008126
[1] 26
Time difference of 1.1756249 hours
 [1]  1.7525723e-01  4.0306083e+00  2.1864631e-01  3.9557004e-01 -8.0045634e-01
 [6]  2.9258901e+00  0.0000000e+00 -5.9829933e-01 -2.4325855e-01  2.7171521e-02
[11]  5.2044901e-03  1.8600287e-07
[1] 27
Time difference of 1.0825874 hours
 [1]  1.5908319e-01  3.2017969e+00  2.4369134e-01  4.2435481e-01 -8.3854958e-01
 [6]  2.7835406e+00  0.0000000e+00 -7.3781371e-01 -2.9347923e-01  2.8112549e-02
[11]  9.8220589e-07  3.2401851e-12
[1] 28
Time difference of 1.255133 hours
 [1]  0.18515971720  4.62881832478  0.21967758442  0.42479657210 -0.80646451707
 [6]  2.98626618579  0.00000000000 -0.24328305964 -0.26804667041  0.02337545874
[11]  0.00498063895  0.00079086076
[1] 29
Time difference of 54.300109 mins
 [1]  1.7194845e-01  3.3383204e+00  2.2885630e-01  4.0006913e-01 -7.8020103e-01
 [6]  3.6754740e+00  0.0000000e+00 -1.0990415e-06 -3.5549049e-01  2.6086650e-02
[11]  8.9831940e-03  5.9611857e-04
[1] 30
Time difference of 1.5709841 hours
 [1]  0.07048789463  5.87291178788  0.27802162200  0.42036599555 -0.76595319085
 [6]  2.00193922718  0.00000000000 -0.94997826611 -0.31648919872  0.01974378415
[11]  0.00824703670  0.00034707976
[1] 31
Time difference of 2.4162933 hours
 [1]  1.1857162e-01  4.5093899e+00  2.2315848e-01  3.8453798e-01 -7.9255554e-01
 [6]  2.5668013e+00  0.0000000e+00 -6.1869409e-07 -2.3244117e-01  1.9164599e-02
[11]  1.1530799e-03  5.7575994e-04
[1] 32
Time difference of 1.2056498 hours
 [1]  1.5911473e-01  3.8627776e+00  2.1968034e-01  3.6021723e-01 -7.9434248e-01
 [6]  2.1667274e+00  0.0000000e+00 -4.9117932e-06 -2.8996532e-01  2.7951150e-02
[11]  2.1817990e-02  4.8698799e-04
