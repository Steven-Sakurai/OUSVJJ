
R version 3.3.3 (2017-03-06) -- "Another Canoe"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> set.seed(7211)
> 
> n = 50
> len = 2501
> par = c(0.1, 6,  0.25,  0.6,  -0.8,  3,  0,  -0.6,  -0.3, 0.025, 0.02, 0.002)
> 
> require(Rcpp)
Loading required package: Rcpp
> require(BH)
Loading required package: BH
> require(nloptr)
Loading required package: nloptr
> require(ggplot2)
Loading required package: ggplot2
> require(gridExtra)
Loading required package: gridExtra
> options(digits=8)
> source('../conv_plot.R')
> sourceCpp('../Simulation.cpp')
> sourceCpp('../nll.cpp', verbose = F)
> 
> opts <- list(algorithm="NLOPT_LN_NELDERMEAD", xtol_rel = 1.0e-5, maxeval = 10000)
> # set lower and upper bound
> lb = c(-0.5, 0.001, 1e-6, 0.001, -0.95, 0, 0, -0.95, -1, 0, 0, 0)
> ub = c(1, 100, 10, 1, 0.95, 10, 0, 0, 0, 1, 1, 1)
> 
> npar = 12
> # run n paths
> converge.list = matrix(, nrow = n, ncol = npar)
> est.par.list = matrix(, nrow = n, ncol = npar)
> success.list = vector(mode="numeric", length = n)
> 
> i = 1
> while(i <= n) {
+     seed = sample(10000, 5)
+     sim = SimOUSVJJ(par, len, log(100), par[3], 1/252, seed[1], seed[2], seed[3], seed[4], seed[5])
+     y = sim$y
+ 
+ 	f <- function(p) {
+ 	    return(nll(p, y))
+ 	}
+     
+     start = Sys.time()
+     result = nloptr(x0 = par, eval_f = f, 
+        opts = opts, 
+        lb = lb, ub = ub)
+     if(result$status < 0)
+         next;
+ 	est_list = as.numeric(result$solution)
+ 	c_list = check.converge(f, result$solution)
+ 	m_list = check.mono(f, result$solution)
+     flag = all(m_list | c_list)
+ 
+     write.table(est_list, file = "./est.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+ 	write.table(c_list, file = "./conv.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+     write.table(flag, file = "./success.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+     
+     print(i)
+     print(Sys.time() - start)
+     print(est_list)
+     
+     est.par.list[i, ] = as.numeric(est_list)
+     converge.list[i, ] = c_list
+     success.list[i] = flag
+ 	i = i + 1
+ }
[1] 1
Time difference of 57.089455 mins
 [1]  1.7427019e-01  2.9379820e+00  2.4566069e-01  4.1589029e-01 -8.0199152e-01
 [6]  3.7871459e+00  0.0000000e+00 -9.4998855e-01 -2.9712933e-01  3.1230973e-02
[11]  7.6865419e-05  5.3565451e-04
[1] 2
Time difference of 1.2637567 hours
 [1]  1.6036149e-01  4.9869095e+00  2.3138343e-01  4.1753560e-01 -7.7607825e-01
 [6]  3.1896035e+00  0.0000000e+00 -3.7348717e-06 -3.1484131e-01  1.6360745e-02
[11]  2.4534271e-03  6.7416529e-04
[1] 3
Time difference of 1.0864828 hours
 [1]  0.19099834869  4.78545170557  0.23508926711  0.41306641541 -0.76245407923
 [6]  2.62523982027  0.00000000000 -0.08387687336 -0.26865708953  0.02159140593
[11]  0.01740753905  0.00051521388
[1] 4
Time difference of 42.064296 mins
 [1]  9.6167549e-02  4.2310191e+00  2.8862815e-01  4.1309884e-01 -8.2952521e-01
 [6]  4.2084161e+00  0.0000000e+00 -4.4753190e-01 -2.2922553e-01  3.1564163e-02
[11]  1.0751158e-06  3.2183323e-04
[1] 5
Time difference of 1.3112758 hours
 [1]  1.6516427e-01  4.5609284e+00  2.4001913e-01  4.0636420e-01 -7.5608431e-01
 [6]  2.1744976e+00  0.0000000e+00 -7.7000886e-01 -2.7172515e-01  2.3521949e-02
[11]  2.8985118e-08  0.0000000e+00
[1] 6
Time difference of 1.8220862 hours
 [1]  0.09728464897  5.07020694883  0.24437887548  0.42500132868 -0.78614395596
 [6]  3.25512938985  0.00000000000 -0.94999962192 -0.28555309664  0.02109183220
[11]  0.00217143306  0.00049739945
[1] 7
Time difference of 1.4658445 hours
 [1]  1.5636487e-01  4.8323662e+00  2.3698314e-01  4.0124996e-01 -8.2107200e-01
 [6]  2.3519997e+00  0.0000000e+00 -3.5268309e-05 -2.4629436e-01  3.5185381e-02
[11]  1.3379652e-02  4.2632682e-04
[1] 8
Time difference of 57.768398 mins
 [1]  1.4951130e-01  4.4995519e+00  2.3326839e-01  4.2741773e-01 -8.5854390e-01
 [6]  1.4019358e+00  0.0000000e+00 -5.0339298e-02 -3.0099369e-01  2.6188874e-02
[11]  1.0318755e-02  1.2640417e-06
[1] 9
Time difference of 1.271237 hours
 [1]  1.4774639e-01  4.4116304e+00  2.5088207e-01  4.1407856e-01 -7.5561356e-01
 [6]  2.1651726e+00  0.0000000e+00 -9.2679138e-03 -2.7711365e-01  1.0922412e-02
[11]  3.4597990e-03  3.2396583e-11
[1] 10
Time difference of 45.227851 mins
 [1]  1.7432285e-01  4.0852924e+00  2.2948446e-01  4.0598517e-01 -8.1197051e-01
 [6]  2.6921177e+00  0.0000000e+00 -9.2543463e-01 -3.0624085e-01  2.4213581e-02
[11]  6.5368614e-03  2.6801588e-09
[1] 11
Time difference of 40.853991 mins
 [1]  0.15304014297  4.98112772727  0.24799399761  0.41258898374 -0.74805902823
 [6]  2.40146287656  0.00000000000 -0.00052146052 -0.26426155365  0.03317591092
[11]  0.00557966643  0.00074780430
[1] 12
Time difference of 39.341776 mins
 [1]  1.5159645e-01  4.5287783e+00  2.6546454e-01  3.9663527e-01 -8.5033125e-01
 [6]  2.9104376e+00  0.0000000e+00 -7.7021205e-07 -2.5231495e-01  1.2322453e-02
[11]  6.2261703e-03  1.0521125e-03
[1] 13
Time difference of 1.0947015 hours
 [1]  0.12815235636  5.26855015656  0.24640420404  0.42964323475 -0.87384120893
 [6]  3.12102929894  0.00000000000 -0.03132851642 -0.34717890494  0.01876082113
[11]  0.01067084246  0.00066824186
[1] 14
Time difference of 1.8461013 hours
 [1]  1.6167519e-01  4.0042813e+00  2.2038638e-01  3.9686606e-01 -8.0902871e-01
 [6]  1.7386268e+00  0.0000000e+00 -9.4999046e-01 -2.8081876e-01  1.2640801e-02
[11]  2.6684691e-05  4.2710246e-04
[1] 15
Time difference of 54.28007 mins
 [1]  0.0964879055  5.0903678539  0.2521488884  0.4144807018 -0.8154580217
 [6]  2.0710703946  0.0000000000 -0.0358823844 -0.3398039973  0.0075868097
[11]  0.0461980443  0.0000000000
[1] 16
Time difference of 1.681117 hours
 [1]  1.3822623e-01  4.6157234e+00  2.4936932e-01  4.3308201e-01 -7.9007236e-01
 [6]  3.1723085e+00  0.0000000e+00 -5.5224028e-07 -3.6831852e-01  1.3522298e-02
[11]  2.1271766e-02  6.8268377e-04
[1] 17
Time difference of 1.2180751 hours
 [1]  0.14465334905  5.41380286436  0.23639473797  0.41442159638 -0.78219577169
 [6]  2.95300654570  0.00000000000 -0.94999515098 -0.30568718075  0.02061825816
[11]  0.00357854675  0.00053615228
[1] 18
Time difference of 1.6098904 hours
 [1]  1.7077261e-01  5.2205967e+00  2.7275653e-01  4.1308183e-01 -7.4307619e-01
 [6]  2.6333007e+00  0.0000000e+00 -9.3763766e-01 -2.8763838e-01  3.4678577e-02
[11]  5.3635836e-06  0.0000000e+00
[1] 19
Time difference of 1.3001637 hours
 [1]  1.3346867e-01  4.4036151e+00  2.5977199e-01  3.9618707e-01 -8.1917750e-01
 [6]  2.7503443e+00  0.0000000e+00 -2.6020436e-01 -2.2858972e-01  2.4548230e-02
[11]  1.5251317e-08  6.2350424e-04
[1] 20
Time difference of 1.3479895 hours
 [1]  1.7148246e-01  3.8555504e+00  2.2339047e-01  3.9691289e-01 -7.7226087e-01
 [6]  2.8981352e+00  0.0000000e+00 -6.6889527e-01 -3.4659469e-01  2.0413071e-02
[11]  1.1981154e-08  3.8598347e-04
[1] 21
Time difference of 1.6050471 hours
 [1]  0.1159057801  3.1805955215  0.2311892160  0.4110637237 -0.7597929957
 [6]  3.4942845035  0.0000000000 -0.6893697988 -0.3066690080  0.0145752737
[11]  0.0081761769  0.0000000000
[1] 22
Time difference of 52.164292 mins
 [1]  0.10459226163  3.39299737245  0.28368898982  0.38941010131 -0.79782994876
 [6]  2.59234176491  0.00000000000 -0.94999515956 -0.38691247454  0.02138694562
[11]  0.01222990336  0.00021068498
[1] 23
Time difference of 1.3215803 hours
 [1]  2.2346988e-01  5.0199278e+00  2.4841511e-01  4.2671913e-01 -7.7358542e-01
 [6]  3.3540195e+00  0.0000000e+00 -6.4493081e-01 -3.1918716e-01  1.5732842e-02
[11]  3.1419402e-02  5.9190066e-10
[1] 24
Time difference of 1.5503604 hours
 [1]  1.0641369e-01  4.9912307e+00  2.4521207e-01  4.1966561e-01 -7.8642495e-01
 [6]  2.7667608e+00  0.0000000e+00 -9.4999949e-01 -2.9426945e-01  4.2861745e-02
[11]  2.9313982e-02  6.4189428e-05
[1] 25
Time difference of 55.008813 mins
 [1]  1.3498333e-01  4.1161970e+00  2.0228696e-01  3.8464523e-01 -8.6481486e-01
 [6]  2.4044677e+00  0.0000000e+00 -9.0325999e-01 -2.6229375e-01  3.5226377e-02
[11]  4.2408929e-02  5.7386349e-05
[1] 26
Time difference of 42.807258 mins
 [1]  0.1603133107  3.9279048337  0.1818231716  0.3887717848 -0.8217619687
 [6]  2.7551490850  0.0000000000 -0.1665182345 -0.2566974908  0.0417735253
[11]  0.0153149738  0.0009163522
[1] 27
Time difference of 44.472878 mins
 [1]  1.9954338e-01  5.1018794e+00  2.5214879e-01  4.1574671e-01 -8.3688716e-01
 [6]  2.8833591e+00  0.0000000e+00 -8.8266978e-01 -2.8811575e-01  2.7818302e-02
[11]  9.2887994e-08  6.3080936e-04
[1] 28
Time difference of 39.045082 mins
 [1]  0.119623083  4.479960273  0.236937303  0.409194246 -0.824447184
 [6]  3.000869450  0.000000000 -0.443100103 -0.261526674  0.023576787
[11]  0.015158414  0.000000000
[1] 29
Time difference of 1.1911504 hours
 [1]  0.1057867057  5.2347017353  0.2601228332  0.4224546611 -0.8092241191
 [6]  3.1718484130  0.0000000000 -0.9499990848 -0.3128739401  0.0314183148
[11]  0.0122238215  0.0005437956
[1] 30
Time difference of 1.3882336 hours
 [1]  1.2404453e-01  4.0949983e+00  2.5388293e-01  4.1392037e-01 -7.7078325e-01
 [6]  2.6940452e+00  0.0000000e+00 -1.3180360e-06 -3.6535001e-01  2.5301790e-02
[11]  6.8958245e-03  3.6095353e-04
[1] 31
Time difference of 31.849724 mins
 [1]  0.18221776641  5.48974082427  0.26198666811  0.42309308423 -0.79591408174
 [6]  2.82719307215  0.00000000000 -0.93112807257 -0.29460261018  0.01965237602
[11]  0.00018740527  0.00049664870
[1] 32
Time difference of 1.1657273 hours
 [1]  1.5105144e-01  3.8415207e+00  2.0835980e-01  4.0231640e-01 -8.0486115e-01
 [6]  4.0281385e+00  0.0000000e+00 -2.9844251e-01 -2.9974237e-01  3.3397784e-02
[11]  1.9082720e-02  2.1421636e-12
[1] 33
Time difference of 2.8490977 hours
 [1]  1.8079203e-01  5.1414444e+00  2.6554935e-01  4.2432564e-01 -7.7441843e-01
 [6]  2.3074850e+00  0.0000000e+00 -9.4995633e-01 -2.7589496e-01  2.8075090e-02
[11]  2.5610837e-06  1.2682947e-03
[1] 34
Time difference of 36.087521 mins
 [1]  0.11579405021  4.09704909205  0.25693432917  0.41843869725 -0.80913615594
 [6]  3.98285386566  0.00000000000 -0.56697994236 -0.27287229234  0.03187868320
[11]  0.00936647549  0.00042212287
[1] 35
Time difference of 41.536471 mins
 [1]  1.9190725e-01  4.0102027e+00  2.4787550e-01  4.0421203e-01 -7.8420206e-01
 [6]  2.9239942e+00  0.0000000e+00 -9.4980399e-01 -3.6218078e-01  1.4932122e-02
[11]  2.8083890e-02  4.5939286e-05
[1] 36
Time difference of 2.4418039 hours
 [1]  1.3557713e-01  3.6364565e+00  1.7028606e-01  3.9924703e-01 -8.2506143e-01
 [6]  3.2987759e+00  0.0000000e+00 -2.3998947e-06 -2.9505074e-01  2.2706810e-02
[11]  6.7021754e-06  5.2478978e-04
[1] 37
Time difference of 55.44589 mins
 [1]  0.15483753602  4.20508629698  0.24936351806  0.40825098896 -0.81657907919
 [6]  1.86315375266  0.00000000000 -0.00010234743 -0.34771800129  0.02629175630
[11]  0.01299663214  0.00060002221
[1] 38
Time difference of 1.6425115 hours
 [1]  1.2633625e-01  4.6386254e+00  2.6602086e-01  4.2233460e-01 -8.3712423e-01
 [6]  2.8078281e+00  0.0000000e+00 -6.0061805e-01 -3.0318362e-01  2.3321139e-02
[11]  5.0927152e-07  8.5709544e-04
