
R version 3.3.3 (2017-03-06) -- "Another Canoe"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> set.seed(23207)
> 
> n = 50
> len = 2501
> par = c(0.1, 6,  0.25,  0.6,  -0.8,  3,  0,  -0.6,  -0.3, 0.025, 0.02, 0.002)
> 
> require(Rcpp)
Loading required package: Rcpp
> require(BH)
Loading required package: BH
> require(nloptr)
Loading required package: nloptr
> require(ggplot2)
Loading required package: ggplot2
> require(gridExtra)
Loading required package: gridExtra
> options(digits=8)
> source('../conv_plot.R')
> sourceCpp('../Simulation.cpp')
> sourceCpp('../nll.cpp', verbose = F)
> 
> opts <- list(algorithm="NLOPT_LN_NELDERMEAD", xtol_rel = 1.0e-5, maxeval = 10000)
> # set lower and upper bound
> lb = c(-0.5, 0.001, 1e-6, 0.001, -0.95, 0, 0, -0.95, -1, 0, 0, 0)
> ub = c(1, 100, 10, 1, 0.95, 10, 0, 0, 0, 1, 1, 1)
> 
> npar = 12
> # run n paths
> converge.list = matrix(, nrow = n, ncol = npar)
> est.par.list = matrix(, nrow = n, ncol = npar)
> success.list = vector(mode="numeric", length = n)
> 
> i = 1
> while(i <= n) {
+     seed = sample(10000, 5)
+     sim = SimOUSVJJ(par, len, log(100), par[3], 1/252, seed[1], seed[2], seed[3], seed[4], seed[5])
+     y = sim$y
+ 
+ 	f <- function(p) {
+ 	    return(nll(p, y))
+ 	}
+     
+     start = Sys.time()
+     result = nloptr(x0 = par, eval_f = f, 
+        opts = opts, 
+        lb = lb, ub = ub)
+     if(result$status < 0)
+         next;
+ 	est_list = as.numeric(result$solution)
+ 	c_list = check.converge(f, result$solution)
+ 	m_list = check.mono(f, result$solution)
+     flag = all(m_list | c_list)
+ 
+     write.table(est_list, file = "./est.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+ 	write.table(c_list, file = "./conv.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+     write.table(flag, file = "./success.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+     
+     print(i)
+     print(Sys.time() - start)
+     print(est_list)
+     
+     est.par.list[i, ] = as.numeric(est_list)
+     converge.list[i, ] = c_list
+     success.list[i] = flag
+ 	i = i + 1
+ }
[1] 1
Time difference of 1.243906 hours
 [1]  1.7887758e-01  4.8401928e+00  2.1623467e-01  4.0548321e-01 -8.1838340e-01
 [6]  2.9413402e+00  0.0000000e+00 -7.8701383e-01 -2.5520803e-01  3.2706625e-02
[11]  1.8449166e-08  4.2699631e-04
[1] 2
Time difference of 43.100912 mins
 [1]  0.169979781  3.622444829  0.214492895  0.399286494 -0.791038012
 [6]  3.158597159  0.000000000 -0.443598586 -0.255228331  0.024195886
[11]  0.016259797  0.000000000
[1] 3
Time difference of 1.2969142 hours
 [1]  1.4785703e-01  5.2710407e+00  2.3336837e-01  4.3750326e-01 -7.8657703e-01
 [6]  3.0068002e+00  0.0000000e+00 -9.4999740e-01 -2.7000749e-01  1.7139418e-02
[11]  2.7326363e-02  3.9224073e-05
[1] 4
Time difference of 1.2203068 hours
 [1]  9.8827668e-02  4.8355245e+00  2.5690306e-01  4.0316604e-01 -7.9773865e-01
 [6]  3.5022661e+00  0.0000000e+00 -6.0230078e-05 -2.8223139e-01  2.8219006e-02
[11]  7.7960720e-04  8.6437328e-04
[1] 5
Time difference of 41.55959 mins
 [1]  0.165161461  3.949022619  0.221876771  0.384589760 -0.756320571
 [6]  3.262922931  0.000000000 -0.887645756 -0.322048366  0.017223348
[11]  0.025718290  0.000000000
[1] 6
Time difference of 2.2921301 hours
 [1]  0.13222468875  3.49282115415  0.23978438606  0.40976092902 -0.75516514662
 [6]  3.02977459414  0.00000000000 -0.34231767023 -0.30208087749  0.01476353375
[11]  0.00218815787  0.00030312969
[1] 7
Time difference of 32.839014 mins
 [1]  1.6551940e-01  3.8666735e+00  1.9310863e-01  3.9876123e-01 -7.7084277e-01
 [6]  3.4326733e+00  0.0000000e+00 -5.1723619e-01 -2.6392151e-01  2.3150918e-02
[11]  2.4082063e-02  2.0636273e-05
[1] 8
Time difference of 52.430661 mins
 [1]  1.0920257e-01  4.3331075e+00  2.1878089e-01  3.8661528e-01 -7.5470642e-01
 [6]  2.8668343e+00  0.0000000e+00 -1.3913602e-06 -2.4360864e-01  3.4467476e-02
[11]  2.1642026e-02  5.5426778e-04
[1] 9
Time difference of 1.5020884 hours
 [1]  1.7648375e-01  4.7678305e+00  2.3053494e-01  4.1911248e-01 -8.0987445e-01
 [6]  3.2027362e+00  0.0000000e+00 -3.9743117e-08 -3.0374411e-01  9.3476145e-03
[11]  5.3371775e-03  1.2937797e-03
[1] 10
Time difference of 1.1834523 hours
 [1]  0.1519003015  4.5973545063  0.2865610644  0.4435238621 -0.7540641462
 [6]  1.9631033573  0.0000000000 -0.9282259241 -0.3259281001  0.0159455518
[11]  0.0082599702  0.0000000000
[1] 11
Time difference of 48.980506 mins
 [1]  1.8987468e-01  3.5034242e+00  2.2941557e-01  3.9986148e-01 -8.1777693e-01
 [6]  3.0403038e+00  0.0000000e+00 -7.7077372e-01 -2.3545190e-01  3.9479593e-02
[11]  4.3328951e-05  6.0348075e-04
[1] 12
Time difference of 1.0053205 hours
 [1]  2.0251835e-01  4.0364642e+00  2.4071836e-01  4.0578441e-01 -7.8014551e-01
 [6]  2.3643168e+00  0.0000000e+00 -4.1331594e-01 -2.8984476e-01  2.8187409e-02
[11]  3.9574654e-02  1.9381726e-09
[1] 13
Time difference of 1.5666466 hours
 [1]  0.163324188  3.920817666  0.240213767  0.404811826 -0.822016145
 [6]  3.375051932  0.000000000 -0.899237490 -0.285912641  0.026611198
[11]  0.011550906  0.000000000
[1] 14
Time difference of 2.3470103 hours
 [1]  0.15246595390  2.71174242767  0.23990221029  0.39601514225 -0.79423061761
 [6]  2.65395377788  0.00000000000 -0.94999582611 -0.31656143079  0.02124188228
[11]  0.00017917093  0.00035138319
[1] 15
Time difference of 2.1103001 hours
 [1]  1.5530922e-01  3.6376407e+00  2.1852069e-01  4.0352874e-01 -8.0278120e-01
 [6]  2.0293972e+00  0.0000000e+00 -1.4293314e-05 -3.2080413e-01  8.1921272e-03
[11]  5.2760646e-03  9.5519656e-04
[1] 16
Time difference of 1.1876067 hours
 [1]  1.6242945e-01  4.4895431e+00  2.1359475e-01  3.8285136e-01 -8.6357614e-01
 [6]  3.5247422e+00  0.0000000e+00 -6.8577164e-04 -2.7627736e-01  3.8542023e-02
[11]  2.1743981e-07  8.6487818e-04
[1] 17
Time difference of 41.318832 mins
 [1]  0.1776740044  5.1143239553  0.2534960659  0.4107906549 -0.6981940722
 [6]  3.5806978776  0.0000000000 -0.3600022731 -0.2616256148  0.0342516298
[11]  0.0069644271  0.0000000000
[1] 18
Time difference of 57.113831 mins
 [1]  0.10387871571  3.67523709896  0.29158684363  0.40570958233 -0.71945842053
 [6]  2.73427153442  0.00000000000 -0.94998979207 -0.29986248800  0.02383877399
[11]  0.00757584377  0.00078498737
[1] 19
Time difference of 42.220175 mins
 [1]  0.17372760988  3.55286214174  0.24670260818  0.39819564053 -0.81089400796
 [6]  2.85356699940  0.00000000000 -0.40000537997 -0.34649658927  0.01322648328
[11]  0.01289698550  0.00056452032
[1] 20
Time difference of 46.833763 mins
 [1]  0.17487734876  5.53250150450  0.22678561495  0.42496442365 -0.81020654629
 [6]  4.20290069144  0.00000000000 -0.86073899482 -0.28869485213  0.02284678442
[11]  0.01444912725  0.00046580622
[1] 21
Time difference of 1.1267667 hours
 [1]  1.1553399e-01  3.8247800e+00  2.7222116e-01  4.0906356e-01 -7.9247155e-01
 [6]  3.1535476e+00  0.0000000e+00 -8.6240104e-01 -2.6951429e-01  2.8253449e-02
[11]  1.9844662e-07  8.0407878e-04
[1] 22
Time difference of 1.6069319 hours
 [1]  1.1497104e-01  4.0310055e+00  2.6999490e-01  4.1451897e-01 -7.8730543e-01
 [6]  3.0530423e+00  0.0000000e+00 -2.0531257e-03 -2.5709837e-01  2.8484924e-02
[11]  3.8926480e-06  7.3135294e-04
[1] 23
Time difference of 45.744023 mins
 [1]  0.19953435421  4.37737178741  0.21348486201  0.39633185942 -0.78489741831
 [6]  3.19816063628  0.00000000000 -0.05599518070 -0.29184233428  0.01883783383
[11]  0.01936802982  0.00038420151
[1] 24
Time difference of 44.837811 mins
 [1]  0.11287880699  4.57094357421  0.23922146076  0.39881167891 -0.82043846977
 [6]  4.61469138794  0.00000000000 -0.15825367268 -0.25558479804  0.03372287326
[11]  0.00258622003  0.00098069265
[1] 25
Time difference of 1.3303696 hours
 [1]  1.6769667e-01  5.5261050e+00  2.3023765e-01  4.1724082e-01 -8.3211677e-01
 [6]  2.9728582e+00  0.0000000e+00 -4.0836379e-02 -3.6354505e-01  1.8173081e-02
[11]  5.0798735e-02  4.9207330e-09
[1] 26
Time difference of 58.35738 mins
 [1]  0.1644534685  3.1894106238  0.2383784477  0.3761383339 -0.8283891137
 [6]  2.8826401709  0.0000000000 -0.7070383466 -0.2134540304  0.0196301297
[11]  0.0016699253  0.0010188300
[1] 27
Time difference of 1.025743 hours
 [1]  9.6416981e-02  4.0808665e+00  2.6355626e-01  4.0634558e-01 -8.4256315e-01
 [6]  2.5378374e+00  0.0000000e+00 -9.0206921e-01 -3.0033580e-01  2.5021597e-02
[11]  4.9764734e-08  3.3031345e-06
[1] 28
Time difference of 2.7344329 hours
 [1]  1.3594511e-01  4.6555535e+00  2.7486732e-01  4.3229171e-01 -7.3431200e-01
 [6]  2.1042645e+00  0.0000000e+00 -9.4987973e-01 -3.0930187e-01  2.5102594e-02
[11]  2.1093610e-08  2.0616099e-04
[1] 29
Time difference of 44.132764 mins
 [1]  0.1747119804  4.4703804632  0.1781798036  0.4027098553 -0.7827282191
 [6]  3.0600684818  0.0000000000 -0.4796806880 -0.2599113381  0.0283671064
[11]  0.0078731577  0.0004009575
[1] 30
Time difference of 1.6484653 hours
 [1]  0.15992605652  3.18168576862  0.25496742050  0.40355383057 -0.78417180376
 [6]  3.76944611726  0.00000000000 -0.94977312377 -0.35639567708  0.02061604764
[11]  0.01291437172  0.00042974956
[1] 31
Time difference of 47.080688 mins
 [1]  0.15644336140  4.07319013579  0.21981871764  0.40275166262 -0.79557597011
 [6]  2.54504281620  0.00000000000 -0.88368637091 -0.28199492672  0.02882161587
[11]  0.01746175300  0.00036058256
[1] 32
Time difference of 1.0790431 hours
 [1]  1.3663102e-01  4.3346005e+00  2.3967899e-01  3.8699846e-01 -8.4000231e-01
 [6]  2.5623889e+00  0.0000000e+00 -3.2097402e-01 -3.2065502e-01  2.8834914e-02
[11]  7.6819997e-05  1.1873364e-03
[1] 33
Time difference of 1.7395259 hours
 [1]  2.3129969e-01  3.6400182e+00  2.2819182e-01  4.0371729e-01 -8.2807123e-01
 [6]  3.2223068e+00  0.0000000e+00 -9.8387228e-06 -3.2126980e-01  2.0959747e-02
[11]  2.6833104e-02  5.3947442e-04
[1] 34
Time difference of 49.628964 mins
 [1]  0.2010207868  4.7943405414  0.1879617098  0.4056876339 -0.7841585091
 [6]  3.5062203209  0.0000000000 -0.4993639207 -0.2539087360  0.0261993309
[11]  0.0081230244  0.0010464060
[1] 35
Time difference of 50.434085 mins
 [1]  0.15211619110  5.26508541036  0.24788739611  0.42048414727 -0.77765417580
 [6]  4.54230752959  0.00000000000 -0.94938042536 -0.22713247527  0.03317038266
[11]  0.01976056168  0.00019119395
[1] 36
Time difference of 32.858726 mins
 [1]  1.1957932e-01  4.3199450e+00  2.6030569e-01  3.9999451e-01 -8.3251530e-01
 [6]  2.7163993e+00  0.0000000e+00 -3.4045652e-01 -2.4058283e-01  2.1617424e-02
[11]  4.4237831e-02  9.3778313e-06
[1] 37
Time difference of 48.206229 mins
 [1]  0.18115582537  4.75338087483  0.24370967139  0.39586510844 -0.75810356096
 [6]  3.24949238946  0.00000000000 -0.49532283000 -0.27240741589  0.01854832171
[11]  0.01251463782  0.00029533102
[1] 38
Time difference of 51.866864 mins
 [1]  0.1681225959  3.5658585313  0.1852498998  0.3738278202 -0.8210760576
 [6]  2.8607573913  0.0000000000 -0.1897767719 -0.3189276469  0.0239127249
[11]  0.0073143448  0.0000000000
[1] 39
Time difference of 40.309418 mins
 [1]  1.9606503e-01  3.7357004e+00  2.5599586e-01  4.0663323e-01 -7.7480482e-01
 [6]  3.8464235e+00  0.0000000e+00 -2.0124711e-01 -2.8766039e-01  2.4594248e-02
[11]  1.5958326e-02  6.9499814e-09
