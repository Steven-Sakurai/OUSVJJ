
R version 3.3.3 (2017-03-06) -- "Another Canoe"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> set.seed(2559)
> 
> n = 50
> len = 2501
> par = c(0.1, 6,  0.25,  0.6,  -0.8,  3,  0,  -0.6,  -0.3, 0.025, 0.02, 0.002)
> 
> require(Rcpp)
Loading required package: Rcpp
> require(BH)
Loading required package: BH
> require(nloptr)
Loading required package: nloptr
> require(ggplot2)
Loading required package: ggplot2
> require(gridExtra)
Loading required package: gridExtra
> options(digits=8)
> source('../conv_plot.R')
> sourceCpp('../Simulation.cpp')
> sourceCpp('../nll.cpp', verbose = F)
> 
> opts <- list(algorithm="NLOPT_LN_NELDERMEAD", xtol_rel = 1.0e-5, maxeval = 10000)
> # set lower and upper bound
> lb = c(-0.5, 0.001, 1e-6, 0.001, -0.95, 0, 0, -0.95, -1, 0, 0, 0)
> ub = c(1, 100, 10, 1, 0.95, 10, 0, 0, 0, 1, 1, 1)
> 
> npar = 12
> # run n paths
> converge.list = matrix(, nrow = n, ncol = npar)
> est.par.list = matrix(, nrow = n, ncol = npar)
> success.list = vector(mode="numeric", length = n)
> 
> i = 1
> while(i <= n) {
+     seed = sample(10000, 5)
+     sim = SimOUSVJJ(par, len, log(100), par[3], 1/252, seed[1], seed[2], seed[3], seed[4], seed[5])
+     y = sim$y
+ 
+ 	f <- function(p) {
+ 	    return(nll(p, y))
+ 	}
+     
+     start = Sys.time()
+     result = nloptr(x0 = par, eval_f = f, 
+        opts = opts, 
+        lb = lb, ub = ub)
+     if(result$status < 0)
+         next;
+ 	est_list = as.numeric(result$solution)
+ 	c_list = check.converge(f, result$solution)
+ 	m_list = check.mono(f, result$solution)
+     flag = all(m_list | c_list)
+ 
+     write.table(est_list, file = "./est.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+ 	write.table(c_list, file = "./conv.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+     write.table(flag, file = "./success.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+     
+     print(i)
+     print(Sys.time() - start)
+     print(est_list)
+     
+     est.par.list[i, ] = as.numeric(est_list)
+     converge.list[i, ] = c_list
+     success.list[i] = flag
+ 	i = i + 1
+ }
[1] 1
Time difference of 1.6003172 hours
 [1]  0.15212528880  4.37350171824  0.21365082131  0.38732740049 -0.80770755848
 [6]  3.15236716405  0.00000000000 -0.94999032427 -0.27852681634  0.02868337838
[11]  0.01318659944  0.00050310051
[1] 2
Time difference of 45.326794 mins
 [1]  0.19195843283  3.82126180147  0.23255041471  0.40612489443 -0.78492042417
 [6]  2.16135382495  0.00000000000 -0.33401054478 -0.26292085604  0.02446840872
[11]  0.02642326393  0.00026542329
[1] 3
Time difference of 1.2424219 hours
 [1]  1.3698924e-01  3.9593259e+00  2.3821556e-01  3.9470467e-01 -7.8505575e-01
 [6]  3.1743267e+00  0.0000000e+00 -6.1781604e-01 -3.6351365e-01  3.7051626e-02
[11]  1.0022156e-06  6.9433547e-04
[1] 4
Time difference of 1.2697381 hours
 [1]  0.16594586288  3.00823902432  0.22772062937  0.39316126813 -0.80835153113
 [6]  3.92093819771  0.00000000000 -0.03042153199 -0.25009986239  0.02690650319
[11]  0.00334001492  0.00048732966
[1] 5
Time difference of 59.508861 mins
 [1]  1.9586703e-01  4.2535227e+00  2.5104598e-01  3.7327914e-01 -8.0579917e-01
 [6]  3.5309786e+00  0.0000000e+00 -9.4413480e-01 -2.5390645e-01  2.4423655e-02
[11]  3.6021908e-07  6.9910568e-04
[1] 6
Time difference of 1.7224331 hours
 [1]  1.1443716e-01  5.1557861e+00  2.5481390e-01  4.0958604e-01 -7.6234793e-01
 [6]  2.7539256e+00  0.0000000e+00 -1.3258566e-04 -2.6879937e-01  2.6574030e-02
[11]  7.7850621e-08  4.9678696e-04
[1] 7
Time difference of 2.3300778 hours
 [1]  8.7023768e-02  4.3853360e+00  2.3286742e-01  4.0298320e-01 -7.5200855e-01
 [6]  3.1819756e+00  0.0000000e+00 -2.4349602e-06 -3.3614374e-01  1.5224655e-02
[11]  2.9715606e-02  2.2017197e-04
[1] 8
Time difference of 52.56921 mins
 [1]  1.5150372e-01  3.5244105e+00  2.2579680e-01  3.8196846e-01 -7.5969346e-01
 [6]  2.2406869e+00  0.0000000e+00 -7.4506417e-01 -2.9604626e-01  2.6789667e-02
[11]  1.7438377e-06  1.1023881e-03
[1] 9
Time difference of 55.428141 mins
 [1]  0.22653232039  4.51654297556  0.23373486815  0.40560043959 -0.82403409508
 [6]  3.29382770870  0.00000000000 -0.80435889048 -0.24042196250  0.01709895639
[11]  0.01728468175  0.00078020584
[1] 10
Time difference of 2.1928399 hours
 [1]  0.13202728746  5.08230056260  0.22534348701  0.38723814978 -0.84333516642
 [6]  4.36572338409  0.00000000000 -0.94999960979 -0.27525351784  0.02775531361
[11]  0.01742956422  0.00064250252
[1] 11
Time difference of 1.5047788 hours
 [1]  0.1823209237  5.1651752796  0.2316008886  0.4164521538 -0.8037462384
 [6]  2.7157200571  0.0000000000 -0.9499962159 -0.2598933458  0.0117392166
[11]  0.0154497091  0.0004608274
[1] 12
Time difference of 1.6835048 hours
 [1]  1.6720713e-01  4.3678719e+00  2.4364294e-01  3.9558509e-01 -7.7294888e-01
 [6]  3.1135322e+00  0.0000000e+00 -9.4924531e-01 -2.8346271e-01  2.2842887e-02
[11]  8.1453998e-03  9.7128447e-18
[1] 13
Time difference of 58.927932 mins
 [1]  0.16578840208  3.36712810706  0.20755582645  0.37746606761 -0.77863255420
 [6]  2.89378720191  0.00000000000 -0.79071030530 -0.31704079130  0.02075493884
[11]  0.01721719560  0.00088830985
[1] 14
Time difference of 49.195153 mins
 [1]  0.15531329291  4.04567437787  0.21937935605  0.40887518613 -0.81674013642
 [6]  3.02260070553  0.00000000000 -0.35295341159 -0.23231209751  0.04153069794
[11]  0.00967751051  0.00051997523
[1] 15
Time difference of 2.216791 hours
 [1]  1.4862738e-01  6.9016357e+00  2.3887903e-01  4.2813147e-01 -7.7602724e-01
 [6]  2.4810603e+00  0.0000000e+00 -6.1646742e-07 -3.0847309e-01  1.5926926e-02
[11]  9.3289339e-03  9.8245697e-04
[1] 16
Time difference of 57.176584 mins
 [1]  1.5420090e-01  4.0299122e+00  2.4695241e-01  4.2041539e-01 -7.8001048e-01
 [6]  2.7576495e+00  0.0000000e+00 -1.0012817e-02 -2.1401428e-01  1.7407439e-02
[11]  1.0621338e-08  0.0000000e+00
[1] 17
Time difference of 2.0283172 hours
 [1]  1.7059299e-01  4.8270668e+00  2.4492973e-01  4.3465564e-01 -8.3921251e-01
 [6]  2.7710117e+00  0.0000000e+00 -9.4776846e-01 -2.8132178e-01  3.4489658e-02
[11]  7.8932866e-07  8.1473324e-04
[1] 18
Time difference of 28.85786 mins
 [1]  0.17123927863  3.53463082185  0.27331117899  0.40584414721 -0.79268197645
 [6]  4.04388573509  0.00000000000 -0.47704276050 -0.30459260826  0.03803826254
[11]  0.01025690050  0.00043627136
[1] 19
Time difference of 45.491648 mins
 [1]  0.1584030593  3.3561016599  0.2612207934  0.4069001936 -0.8390032185
 [6]  3.3612069384  0.0000000000 -0.5416280783 -0.2764933320  0.0348803844
[11]  0.0217601204  0.0007150504
[1] 20
Time difference of 1.2998501 hours
 [1]  7.7465044e-02  4.3331187e+00  3.1889378e-01  4.1732163e-01 -7.9843007e-01
 [6]  3.0357603e+00  0.0000000e+00 -1.4042909e-03 -2.6390362e-01  2.0472982e-02
[11]  5.2068523e-04  7.7138287e-08
[1] 21
Time difference of 13.639193 mins
 [1]  0.1633911178  5.5796170283  0.2259717178  0.4284256765 -0.8212412657
 [6]  3.3231875740  0.0000000000 -0.4011673420 -0.3266647440  0.0296976400
[11]  0.0209467330  0.0010311782
[1] 22
Time difference of 46.618031 mins
 [1]  0.14974704350  3.74480696520  0.25915148784  0.41452149434 -0.81648216975
 [6]  2.81306239646  0.00000000000 -0.72983622107 -0.23689266597  0.03795374482
[11]  0.00139831736  0.00095865541
[1] 23
Time difference of 1.2810809 hours
 [1]  0.10403161502  3.27944095434  0.25767633502  0.39434239652 -0.77434238968
 [6]  2.56690566841  0.00000000000 -0.94999836918 -0.29475436241  0.03783265902
[11]  0.00636022398  0.00046001647
[1] 24
Time difference of 1.1899565 hours
 [1]  0.19518698540  3.49290684595  0.18985092264  0.40403091914 -0.80918983196
 [6]  3.78487035138  0.00000000000 -0.72540559434 -0.29948336826  0.03114310740
[11]  0.02606760977  0.00020732142
[1] 25
Time difference of 49.882904 mins
 [1]  1.7631246e-01  3.2859812e+00  2.2588302e-01  3.6707829e-01 -7.4069898e-01
 [6]  2.7376166e+00  0.0000000e+00 -7.4254952e-01 -3.5127278e-01  2.2855864e-02
[11]  1.0242222e-02  1.3897916e-07
[1] 26
Time difference of 47.632563 mins
 [1]  0.17001654866  4.57524087472  0.23661711883  0.40078213691 -0.82931807676
 [6]  2.81567090055  0.00000000000 -0.13492255354 -0.34610636072  0.02428360853
[11]  0.02577670891  0.00064336919
[1] 27
Time difference of 1.5514451 hours
 [1]  1.3946154e-01  5.1251095e+00  2.4770111e-01  4.1389829e-01 -8.1921069e-01
 [6]  2.4025776e+00  0.0000000e+00 -9.4950195e-01 -3.1263394e-01  2.3080601e-02
[11]  4.5347345e-10  0.0000000e+00
[1] 28
Time difference of 51.567789 mins
 [1]  1.4177385e-01  4.1633284e+00  2.6369528e-01  4.2197000e-01 -8.0901071e-01
 [6]  3.0338778e+00  0.0000000e+00 -2.2236849e-01 -2.3524070e-01  4.0992677e-02
[11]  2.7724113e-08  7.0550036e-04
[1] 29
Time difference of 1.146431 hours
 [1]  5.7086279e-02  5.1050446e+00  2.9460982e-01  4.1426161e-01 -8.0321683e-01
 [6]  3.0261366e+00  0.0000000e+00 -5.5593851e-06 -3.3319043e-01  2.6042945e-02
[11]  1.4032455e-02  8.5155792e-04
[1] 30
Time difference of 40.605957 mins
 [1]  0.21188903416  3.57397183077  0.22934675863  0.41753034230 -0.83686753570
 [6]  3.56429217515  0.00000000000 -0.32988909122 -0.22062898005  0.02792183089
[11]  0.00301384863  0.00091081711
[1] 31
Time difference of 1.2791964 hours
 [1]  1.6098675e-01  5.5675552e+00  2.5086715e-01  4.3236673e-01 -7.8840858e-01
 [6]  2.1508116e+00  0.0000000e+00 -1.3488117e-05 -3.0786720e-01  1.2134571e-02
[11]  6.2530581e-03  4.3867554e-04
[1] 32
Time difference of 41.666044 mins
 [1]  0.10551369962  4.61435241048  0.25490601170  0.41102276075 -0.75559936777
 [6]  4.78263677377  0.00000000000 -0.89441162153 -0.24544015658  0.03439073399
[11]  0.00761767302  0.00048577092
[1] 33
Time difference of 2.0679452 hours
 [1]  1.6811390e-01  3.7383377e+00  1.8399044e-01  3.7345496e-01 -7.7816335e-01
 [6]  2.7586562e+00  0.0000000e+00 -3.4792453e-06 -2.2288387e-01  5.2172598e-02
[11]  1.7945195e-02  5.7682114e-05
[1] 34
Time difference of 1.2308178 hours
 [1]  1.7334579e-01  5.0981470e+00  2.0131611e-01  4.1535757e-01 -8.1641367e-01
 [6]  2.9883038e+00  0.0000000e+00 -1.5500344e-07 -2.7316585e-01  2.5302448e-02
[11]  2.5645955e-02  3.8386116e-04
[1] 35
Time difference of 1.0228355 hours
 [1]  0.13252917761  3.79001488920  0.24761984491  0.40910006902 -0.77977009029
 [6]  3.51890835177  0.00000000000 -0.06077360359 -0.31811452286  0.02216073349
[11]  0.02101043808  0.00027998878
[1] 36
Time difference of 40.931544 mins
 [1]  0.16601959315  3.56022722730  0.16216070201  0.36401351272 -0.79436040514
 [6]  3.75688062707  0.00000000000 -0.35069403458 -0.29925172592  0.02651646546
[11]  0.03145065016  0.00041848339
[1] 37
Time difference of 1.1806934 hours
 [1]  1.1348255e-01  4.3776777e+00  2.6087797e-01  4.0867198e-01 -7.9278075e-01
 [6]  2.6412600e+00  0.0000000e+00 -5.4801143e-01 -2.8387165e-01  3.4268283e-02
[11]  5.1299610e-08  6.3595409e-04
[1] 38
Time difference of 59.136936 mins
 [1]  2.4424263e-01  5.3710834e+00  2.4732188e-01  4.1779095e-01 -7.4966415e-01
 [6]  3.2254619e+00  0.0000000e+00 -9.4870277e-01 -2.5836128e-01  2.4779296e-02
[11]  1.4624499e-07  2.2066975e-04
