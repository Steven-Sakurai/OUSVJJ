
R version 3.3.3 (2017-03-06) -- "Another Canoe"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> set.seed(14112)
> 
> n = 50
> len = 2501
> par = c(0.1, 6,  0.25,  0.6,  -0.8,  3,  0,  -0.6,  -0.3, 0.025, 0.02, 0.002)
> 
> require(Rcpp)
Loading required package: Rcpp
> require(BH)
Loading required package: BH
> require(nloptr)
Loading required package: nloptr
> require(ggplot2)
Loading required package: ggplot2
> require(gridExtra)
Loading required package: gridExtra
> options(digits=8)
> source('../conv_plot.R')
> sourceCpp('../Simulation.cpp')
> sourceCpp('../nll.cpp', verbose = F)
> 
> opts <- list(algorithm="NLOPT_LN_NELDERMEAD", xtol_rel = 1.0e-5, maxeval = 10000)
> # set lower and upper bound
> lb = c(-0.5, 0.001, 1e-6, 0.001, -0.95, 0, 0, -0.95, -1, 0, 0, 0)
> ub = c(1, 100, 10, 1, 0.95, 10, 0, 0, 0, 1, 1, 1)
> 
> npar = 12
> # run n paths
> converge.list = matrix(, nrow = n, ncol = npar)
> est.par.list = matrix(, nrow = n, ncol = npar)
> success.list = vector(mode="numeric", length = n)
> 
> i = 1
> while(i <= n) {
+     seed = sample(10000, 5)
+     sim = SimOUSVJJ(par, len, log(100), par[3], 1/252, seed[1], seed[2], seed[3], seed[4], seed[5])
+     y = sim$y
+ 
+ 	f <- function(p) {
+ 	    return(nll(p, y))
+ 	}
+     
+     start = Sys.time()
+     result = nloptr(x0 = par, eval_f = f, 
+        opts = opts, 
+        lb = lb, ub = ub)
+     if(result$status < 0)
+         next;
+ 	est_list = as.numeric(result$solution)
+ 	c_list = check.converge(f, result$solution)
+ 	m_list = check.mono(f, result$solution)
+     flag = all(m_list | c_list)
+ 
+     write.table(est_list, file = "./est.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+ 	write.table(c_list, file = "./conv.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+     write.table(flag, file = "./success.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+     
+     print(i)
+     print(Sys.time() - start)
+     print(est_list)
+     
+     est.par.list[i, ] = as.numeric(est_list)
+     converge.list[i, ] = c_list
+     success.list[i] = flag
+ 	i = i + 1
+ }
[1] 1
Time difference of 41.18398 mins
 [1]  0.18129467797  3.55046369500  0.21098706825  0.38556652753 -0.78710264692
 [6]  2.26222308091  0.00000000000 -0.65519026132 -0.29664864845  0.01424812122
[11]  0.01260080935  0.00081253914
[1] 2
Time difference of 1.3198154 hours
 [1]  2.3533075e-01  2.5272440e+00  2.3576464e-01  3.8043997e-01 -7.8275937e-01
 [6]  2.5586199e+00  0.0000000e+00 -2.9503684e-05 -2.6070377e-01  2.7905157e-02
[11]  4.9172169e-06  8.4783554e-04
[1] 3
Time difference of 1.0010627 hours
 [1]  0.19625684512  3.01499984965  0.20671540686  0.39049568179 -0.77406302855
 [6]  2.92871822874  0.00000000000 -0.28325400187 -0.30074592481  0.01625569918
[11]  0.01552448309  0.00054336528
[1] 4
Time difference of 2.7263471 hours
 [1]  0.16273292982  3.81113770747  0.23422223703  0.41913579817 -0.82210350794
 [6]  2.55399075628  0.00000000000 -0.94999581478 -0.26961247209  0.01623104349
[11]  0.01067662467  0.00022656753
[1] 5
Time difference of 44.786342 mins
 [1]  0.163876867  3.936517164  0.243299318  0.422706176 -0.747123953
 [6]  2.381697572  0.000000000 -0.594562398 -0.305989925  0.026330844
[11]  0.033094217  0.000000000
[1] 6
Time difference of 46.986733 mins
 [1]  0.15462623074  3.12499435581  0.24656471251  0.40091069185 -0.78407581129
 [6]  2.30836233240  0.00000000000 -0.68137358775 -0.32642800332  0.04214629910
[11]  0.00730773559  0.00032347277
[1] 7
Time difference of 38.363696 mins
 [1]  0.1905206226  2.3215473292  0.1765309783  0.3454796608 -0.7747448317
 [6]  3.1574800616  0.0000000000 -0.1871862058 -0.2973514259  0.0209895440
[11]  0.0115605023  0.0010533492
[1] 8
Time difference of 1.6149475 hours
 [1]  0.15501166412  3.20233249837  0.24534508479  0.41637374001 -0.73360100057
 [6]  3.10313326142  0.00000000000 -0.94923336063 -0.32022287107  0.01683062173
[11]  0.00213846579  0.00044086993
[1] 9
Time difference of 33.25136 mins
 [1]  0.14422621048  4.74190283283  0.22901796677  0.41645723758 -0.81211807295
 [6]  4.21554353687  0.00000000000 -0.76213277343 -0.25434064439  0.03856996154
[11]  0.02307266178  0.00023761234
[1] 10
Time difference of 28.203024 mins
 [1]  0.185438738  3.943321415  0.247890944  0.402487471 -0.801801481
 [6]  3.233522669  0.000000000 -0.144556004 -0.192438759  0.031381526
[11]  0.018611044  0.000000000
[1] 11
Time difference of 36.667592 mins
 [1]  1.4142625e-01  5.1653285e+00  2.4661422e-01  4.1429382e-01 -7.6729299e-01
 [6]  3.2824059e+00  0.0000000e+00 -9.3996565e-01 -2.8548117e-01  2.7168521e-02
[11]  7.9995246e-03  3.0233987e-05
[1] 12
Time difference of 37.393373 mins
 [1]  0.13953142381  3.93177905938  0.22510450544  0.41919054231 -0.79588398645
 [6]  3.19027649261  0.00000000000 -0.16357962460 -0.29648257229  0.03310789687
[11]  0.01321972554  0.00070782904
[1] 13
Time difference of 52.017202 mins
 [1]  0.150790684  4.261315187  0.231975282  0.410664117 -0.783966655
 [6]  2.841492057  0.000000000 -0.557822757 -0.284323430  0.017748248
[11]  0.015358884  0.000000000
[1] 14
Time difference of 1.3100644 hours
 [1]  1.1828006e-01  3.0800117e+00  2.5773271e-01  3.8558829e-01 -8.4639668e-01
 [6]  5.1033805e+00  0.0000000e+00 -4.1762237e-01 -2.0328429e-01  3.8648143e-02
[11]  4.9394592e-08  8.4783323e-11
[1] 15
Time difference of 3.6379966 hours
 [1]  1.4831220e-01  6.2899105e+00  2.4872888e-01  4.3941828e-01 -7.6691905e-01
 [6]  3.7528405e+00  0.0000000e+00 -2.1065539e-07 -2.6840418e-01  1.5178357e-02
[11]  4.1259326e-03  5.1876770e-04
[1] 16
Time difference of 1.1357352 hours
 [1]  1.4458151e-01  4.0661326e+00  2.4478860e-01  3.9741586e-01 -7.7370087e-01
 [6]  2.3160307e+00  0.0000000e+00 -4.3757887e-07 -3.4481308e-01  9.8036661e-03
[11]  1.8690422e-02  3.1012325e-04
[1] 17
Time difference of 51.637484 mins
 [1]  0.14654499470  4.79456331344  0.26067477613  0.40791141630 -0.78186405038
 [6]  3.58337832897  0.00000000000 -0.00013384238 -0.26473642418  0.02504161074
[11]  0.02150524911  0.00020210715
[1] 18
Time difference of 1.4052122 hours
 [1]  1.5009386e-01  4.4877635e+00  2.4077987e-01  4.1760754e-01 -7.9040818e-01
 [6]  3.3133631e+00  0.0000000e+00 -5.0550818e-05 -2.1325688e-01  2.9250763e-02
[11]  1.8162929e-09  7.5335376e-04
[1] 19
Time difference of 1.3690102 hours
 [1] -0.06518958901  6.16552083971  0.29074903471  0.43622771240 -0.80616521472
 [6]  3.48674231030  0.00000000000 -0.94998604835 -0.31676817786  0.02656308793
[11]  0.02589017848  0.00014166318
[1] 20
Time difference of 42.980622 mins
 [1]  0.12719327032  4.05237954074  0.25702542631  0.42516397595 -0.85733446183
 [6]  3.24160641827  0.00000000000 -0.60631963664 -0.26837544075  0.02454173203
[11]  0.01487369587  0.00078302374
[1] 21
Time difference of 1.3475101 hours
 [1]  1.2936158e-01  4.7167204e+00  2.5989768e-01  3.9305484e-01 -7.9760471e-01
 [6]  3.3446316e+00  0.0000000e+00 -2.8944356e-01 -2.5565666e-01  2.5663683e-02
[11]  7.2108810e-03  6.2504800e-12
[1] 22
Time difference of 1.1504365 hours
 [1]  0.15704384884  3.15232322190  0.25099821853  0.39965708575 -0.77883916587
 [6]  2.98850971565  0.00000000000 -0.94998623307 -0.29972673699  0.02563092540
[11]  0.02646436235  0.00017418871
[1] 23
Time difference of 40.363639 mins
 [1]  1.7247453e-01  3.4873590e+00  2.3719306e-01  4.1013146e-01 -8.5945561e-01
 [6]  2.6526628e+00  0.0000000e+00 -1.0289810e-01 -2.9851036e-01  2.7897068e-02
[11]  3.1619741e-02  4.4897724e-07
[1] 24
Time difference of 1.1076237 hours
 [1]  0.180781705  3.990641429  0.211801519  0.391980623 -0.805361284
 [6]  3.852967038  0.000000000 -0.569757667 -0.294635973  0.028459064
[11]  0.022217255  0.000000000
[1] 25
Time difference of 1.0017409 hours
 [1]  1.8427588e-01  3.4990504e+00  2.0994874e-01  3.8777367e-01 -8.8489161e-01
 [6]  4.0723429e+00  0.0000000e+00 -4.5994788e-06 -2.2765750e-01  3.5682596e-02
[11]  1.1580248e-03  1.1943376e-03
[1] 26
Time difference of 2.8996083 hours
 [1]  1.3114843e-01  3.8115238e+00  2.0636478e-01  4.2258908e-01 -8.0098916e-01
 [6]  4.0080856e+00  0.0000000e+00 -3.7639445e-06 -2.4991491e-01  2.0426213e-02
[11]  2.1623990e-02  4.7427453e-04
[1] 27
Time difference of 34.762121 mins
 [1]  0.1687286068  4.0422267776  0.2453611463  0.4105934180 -0.8091906784
 [6]  2.5869512888  0.0000000000 -0.7377105443 -0.3241699833  0.0157461205
[11]  0.0064686291  0.0010080394
[1] 28
Time difference of 56.035207 mins
 [1]  1.9273414e-01  3.4353587e+00  2.4082485e-01  4.0192483e-01 -7.7342353e-01
 [6]  3.1906274e+00  0.0000000e+00 -9.4056715e-01 -2.5473616e-01  2.5344830e-02
[11]  3.4940730e-07  9.1795999e-06
[1] 29
Time difference of 41.413238 mins
 [1]  0.13712600012  3.62450612773  0.22730357169  0.40649708530 -0.80306502489
 [6]  4.03799422036  0.00000000000 -0.67141969836 -0.26078179965  0.04755748180
[11]  0.00714587267  0.00070409791
[1] 30
Time difference of 44.347021 mins
 [1]  0.19354504949  4.27656784843  0.26268914225  0.41996611303 -0.77122516728
 [6]  2.96379433974  0.00000000000 -0.02101210861 -0.23193389806  0.02521373366
[11]  0.00590711046  0.00068241261
[1] 31
Time difference of 47.508193 mins
 [1]  1.3312868e-01  4.3786703e+00  2.6145860e-01  4.1997001e-01 -7.9854625e-01
 [6]  1.6555158e+00  0.0000000e+00 -2.4741918e-01 -2.9439761e-01  1.8933124e-02
[11]  9.8367010e-07  7.2772829e-04
[1] 32
Time difference of 1.4331288 hours
 [1]  1.5511399e-01  4.7150170e+00  2.0676492e-01  4.0701502e-01 -7.9227940e-01
 [6]  2.4802777e+00  0.0000000e+00 -1.4022873e-05 -2.9194099e-01  2.5484182e-02
[11]  8.4995090e-03  6.3547667e-06
[1] 33
Time difference of 1.1100116 hours
 [1]  0.10376012414  4.76863513251  0.26441388667  0.42137059073 -0.83978711674
 [6]  3.97365396728  0.00000000000 -0.94994603730 -0.33749607508  0.04080030674
[11]  0.00829313297  0.00031922301
[1] 34
Time difference of 44.258594 mins
 [1]  0.18964173707  3.17342427325  0.24757286797  0.37471474605 -0.85253475300
 [6]  3.78503444237  0.00000000000 -0.25724179294 -0.32378783444  0.02284583268
[11]  0.01197099856  0.00071809773
[1] 35
Time difference of 33.461885 mins
 [1]  0.177996666  5.082527508  0.241317895  0.418761815 -0.781609824
 [6]  3.656385950  0.000000000 -0.541964991 -0.251701184  0.029765287
[11]  0.003196275  0.000000000
[1] 36
Time difference of 1.6643903 hours
 [1]  1.4794230e-01  5.8077998e+00  2.1234249e-01  3.8842374e-01 -8.0158601e-01
 [6]  3.0532445e+00  0.0000000e+00 -3.9223815e-06 -3.1816298e-01  1.5844349e-02
[11]  1.5483698e-02  3.8538662e-04
[1] 37
Time difference of 49.500113 mins
 [1]  0.17844890991  4.05480140048  0.23510891447  0.41177242744 -0.74022891729
 [6]  3.37445113140  0.00000000000 -0.40555476890 -0.32080093653  0.01927192201
[11]  0.02318588587  0.00024590227
[1] 38
Time difference of 46.627464 mins
 [1]  1.5407738e-01  5.5308834e+00  2.2694584e-01  4.2011264e-01 -7.9559306e-01
 [6]  2.2457416e+00  0.0000000e+00 -2.4133407e-01 -2.7407168e-01  2.9345331e-02
[11]  4.9691448e-02  3.4823852e-07
[1] 39
Time difference of 56.665342 mins
 [1]  0.16910534285  4.78595184484  0.25765471045  0.41246190923 -0.81431234217
 [6]  2.80099476009  0.00000000000 -0.94998221497 -0.27697517878  0.03089950449
[11]  0.01133979638  0.00035505774
[1] 40
Time difference of 1.3505932 hours
 [1]  0.17420512365  4.07613411845  0.21921113590  0.39116710027 -0.76497770509
 [6]  2.55560056400  0.00000000000 -0.94282030701 -0.28824236837  0.03210364531
[11]  0.00832412147  0.00036787636
