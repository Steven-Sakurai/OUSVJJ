
R version 3.3.3 (2017-03-06) -- "Another Canoe"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> set.seed(10190)
> 
> n = 50
> len = 2501
> par = c(0.1, 6,  0.25,  0.6,  -0.8,  3,  0,  -0.6,  -0.3, 0.025, 0.02, 0.002)
> 
> require(Rcpp)
Loading required package: Rcpp
> require(BH)
Loading required package: BH
> require(nloptr)
Loading required package: nloptr
> require(ggplot2)
Loading required package: ggplot2
> require(gridExtra)
Loading required package: gridExtra
> options(digits=8)
> source('../conv_plot.R')
> sourceCpp('../Simulation.cpp')
> sourceCpp('../nll.cpp', verbose = F)
> 
> opts <- list(algorithm="NLOPT_LN_NELDERMEAD", xtol_rel = 1.0e-5, maxeval = 10000)
> # set lower and upper bound
> lb = c(-0.5, 0.001, 1e-6, 0.001, -0.95, 0, 0, -0.95, -1, 0, 0, 0)
> ub = c(1, 100, 10, 1, 0.95, 10, 0, 0, 0, 1, 1, 1)
> 
> npar = 12
> # run n paths
> converge.list = matrix(, nrow = n, ncol = npar)
> est.par.list = matrix(, nrow = n, ncol = npar)
> success.list = vector(mode="numeric", length = n)
> 
> i = 1
> while(i <= n) {
+     seed = sample(10000, 5)
+     sim = SimOUSVJJ(par, len, log(100), par[3], 1/252, seed[1], seed[2], seed[3], seed[4], seed[5])
+     y = sim$y
+ 
+ 	f <- function(p) {
+ 	    return(nll(p, y))
+ 	}
+     
+     start = Sys.time()
+     result = nloptr(x0 = par, eval_f = f, 
+        opts = opts, 
+        lb = lb, ub = ub)
+     if(result$status < 0)
+         next;
+ 	est_list = as.numeric(result$solution)
+ 	c_list = check.converge(f, result$solution)
+ 	m_list = check.mono(f, result$solution)
+     flag = all(m_list | c_list)
+ 
+     write.table(est_list, file = "./est.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+ 	write.table(c_list, file = "./conv.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+     write.table(flag, file = "./success.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+     
+     print(i)
+     print(Sys.time() - start)
+     print(est_list)
+     
+     est.par.list[i, ] = as.numeric(est_list)
+     converge.list[i, ] = c_list
+     success.list[i] = flag
+ 	i = i + 1
+ }
[1] 1
Time difference of 1.2175255 hours
 [1]  0.16581818856  3.39996817524  0.21446222292  0.39374430038 -0.82129923246
 [6]  2.69540027319  0.00000000000 -0.34724329987 -0.34294755230  0.01502455619
[11]  0.02036496447  0.00059758473
[1] 2
Time difference of 1.5572591 hours
 [1]  0.23069295706  4.90955697321  0.21898262190  0.40783106757 -0.78176107962
 [6]  2.49390577126  0.00000000000 -0.94992475545 -0.28037683318  0.02739986220
[11]  0.01767899786  0.00053766578
[1] 3
Time difference of 2.0772873 hours
 [1]  0.1938985708  3.3955850503  0.1724227979  0.3739456364 -0.7996190721
 [6]  4.9275065281  0.0000000000 -0.9082474313 -0.2578955680  0.0298717342
[11]  0.0041285137  0.0000000000
[1] 4
Time difference of 43.155653 mins
 [1]  0.15567582986  3.31008420627  0.21598428093  0.39972199399 -0.84169009162
 [6]  3.87779888726  0.00000000000 -0.61986780813 -0.22390544494  0.03478358944
[11]  0.00418890611  0.00067516033
[1] 5
Time difference of 3.1823131 hours
 [1]  1.6271969e-01  5.5650593e+00  2.8452726e-01  4.3645725e-01 -8.0908243e-01
 [6]  2.3697009e+00  0.0000000e+00 -3.6422024e-06 -2.2286025e-01  1.8322338e-02
[11]  1.4311250e-07  8.8290732e-04
[1] 6
Time difference of 1.2443243 hours
 [1]  1.4590248e-01  6.1620388e+00  2.3278038e-01  4.1028688e-01 -8.2325368e-01
 [6]  2.8000854e+00  0.0000000e+00 -2.4000900e-01 -2.0321858e-01  4.4481852e-02
[11]  8.2264588e-09  9.9085009e-04
[1] 7
Time difference of 37.92484 mins
 [1]  0.15683737591  3.61454024615  0.21531378271  0.38976001042 -0.77333070429
 [6]  3.36525718961  0.00000000000 -0.08676271417 -0.24671082839  0.02237461253
[11]  0.01084411422  0.00067483083
[1] 8
Time difference of 59.763565 mins
 [1]  0.10182851514  5.08042842943  0.26619505443  0.42631157659 -0.77535282246
 [6]  3.85761681510  0.00000000000 -0.94933336227 -0.28634833628  0.02419829306
[11]  0.00683534675  0.00010700773
[1] 9
Time difference of 2.4086143 hours
 [1]  1.8502802e-01  3.7947345e+00  2.1832010e-01  4.0317345e-01 -8.3463782e-01
 [6]  2.9575231e+00  0.0000000e+00 -3.3130761e-01 -2.7767645e-01  2.4127223e-02
[11]  1.1033355e-07  5.2115133e-04
[1] 10
Time difference of 1.7410676 hours
 [1]  1.7212175e-01  4.6778272e+00  2.3797551e-01  3.9984643e-01 -7.7188145e-01
 [6]  2.8256051e+00  0.0000000e+00 -3.2178149e-05 -3.1187068e-01  2.9116855e-02
[11]  9.2915836e-04  6.2274000e-04
[1] 11
Time difference of 2.4511295 hours
 [1]  0.18821090825  4.22970242583  0.19769287900  0.37182317013 -0.81927333544
 [6]  2.63711550082  0.00000000000 -0.94999910461 -0.34384597473  0.03111179640
[11]  0.03235772746  0.00016479132
[1] 12
Time difference of 58.163387 mins
 [1]  0.18359127225  3.53047910578  0.21909772281  0.38200919629 -0.78973957737
 [6]  2.69583505013  0.00000000000 -0.94997220276 -0.29423994841  0.02419469754
[11]  0.00384361629  0.00013264988
[1] 13
Time difference of 1.3066859 hours
 [1]  1.7363890e-01  3.6709307e+00  2.4447620e-01  4.0272319e-01 -8.5400429e-01
 [6]  4.4412985e+00  0.0000000e+00 -2.9047358e-01 -3.0800783e-01  3.2157830e-02
[11]  2.6501697e-07  7.0012927e-04
[1] 14
Time difference of 47.154466 mins
 [1]  0.14008454716  3.62925675546  0.23152764214  0.39823516384 -0.79703143272
 [6]  3.31027123139  0.00000000000 -0.08399708995 -0.29340486347  0.02081288878
[11]  0.00117019832  0.00079323634
[1] 15
Time difference of 1.1581842 hours
 [1]  0.15309065806  4.88018646942  0.23771712238  0.39237362219 -0.83458950520
 [6]  3.58257160627  0.00000000000 -0.13128641708 -0.23628413741  0.03589451018
[11]  0.00057374968  0.00034948649
[1] 16
Time difference of 1.2694046 hours
 [1]  1.1625420e-01  5.3197052e+00  2.3911563e-01  4.3697604e-01 -7.8212070e-01
 [6]  2.6753239e+00  0.0000000e+00 -5.4001194e-02 -3.4640740e-01  1.9684948e-02
[11]  3.9188601e-02  2.1461168e-09
[1] 17
Time difference of 38.979126 mins
 [1]  0.1812360273  2.8413358890  0.2131433334  0.3619254239 -0.8106909345
 [6]  3.3870236425  0.0000000000 -0.2397824209 -0.2908557840  0.0257074288
[11]  0.0115971461  0.0014619601
[1] 18
Time difference of 1.3935182 hours
 [1]  0.1302119170  4.8672832710  0.2612678666  0.4047386562 -0.8034143283
 [6]  3.0037359086  0.0000000000 -0.9500000000 -0.2860648556  0.0173367839
[11]  0.0070935335  0.0000000000
[1] 19
Time difference of 1.3841925 hours
 [1]  1.9037251e-01  3.3832105e+00  1.8368003e-01  3.6919220e-01 -8.0930834e-01
 [6]  3.4560905e+00  0.0000000e+00 -1.3308141e-05 -3.0407540e-01  3.5661792e-02
[11]  1.2370200e-02  9.3848311e-04
[1] 20
Time difference of 37.604609 mins
 [1]  0.1388004838  4.7142699954  0.2312850629  0.3914029797 -0.7930171487
 [6]  3.6800737705  0.0000000000 -0.5170007396 -0.3035637438  0.0237256631
[11]  0.0092594913  0.0010435153
[1] 21
Time difference of 1.0647237 hours
 [1]  1.4580449e-01  3.6034146e+00  2.1934084e-01  4.1479063e-01 -8.0480032e-01
 [6]  3.0445870e+00  0.0000000e+00 -4.1447254e-05 -2.9136056e-01  3.6932039e-02
[11]  3.2517680e-02  2.1065775e-04
[1] 22
Time difference of 52.105528 mins
 [1]  0.14169607738  4.40772787747  0.23432708084  0.40895670251 -0.82300432519
 [6]  3.10945227557  0.00000000000 -0.43233343593 -0.26689081657  0.06389289631
[11]  0.00455475583  0.00074390524
[1] 23
Time difference of 1.3520736 hours
 [1]  1.6732697e-01  3.5671197e+00  2.2740769e-01  3.9062859e-01 -8.0269432e-01
 [6]  3.1005672e+00  0.0000000e+00 -8.0371017e-06 -2.8909228e-01  2.9415569e-02
[11]  4.2099598e-03  1.1054417e-03
[1] 24
Time difference of 1.2133822 hours
 [1]  1.1436023e-01  4.8894251e+00  2.3182038e-01  4.1046469e-01 -8.4638437e-01
 [6]  3.2258990e+00  0.0000000e+00 -3.6149826e-06 -2.3257707e-01  2.9319477e-02
[11]  9.4319555e-03  9.8724944e-04
[1] 25
Time difference of 45.303731 mins
 [1]  1.6445340e-01  4.3151562e+00  2.0696142e-01  4.0505576e-01 -8.4417467e-01
 [6]  3.2377240e+00  0.0000000e+00 -3.6800286e-01 -2.4332543e-01  2.6472047e-02
[11]  2.6986891e-02  4.3498666e-06
[1] 26
Time difference of 1.0864736 hours
 [1]  1.7624280e-01  5.0084431e+00  2.2340687e-01  4.2577672e-01 -8.2995888e-01
 [6]  3.3813078e+00  0.0000000e+00 -9.4994680e-01 -2.6699813e-01  2.9371870e-02
[11]  6.6206820e-03  7.1220511e-05
[1] 27
Time difference of 43.92124 mins
 [1]  0.1725962962  3.2256179415  0.1718936145  0.4068397245 -0.8177667528
 [6]  2.2163927810  0.0000000000 -0.3478775359 -0.3910059077  0.0139906751
[11]  0.0143852922  0.0012740061
[1] 28
Time difference of 48.028831 mins
 [1]  0.13837670608  4.31349834508  0.23712540167  0.40405536098 -0.82493595742
 [6]  4.04848455732  0.00000000000 -0.33472056526 -0.29653367745  0.03635943125
[11]  0.01199815636  0.00067061786
[1] 29
Time difference of 42.688538 mins
 [1]  0.14838350594  5.83126318907  0.22675088553  0.40224498855 -0.75717047713
 [6]  3.58231530454  0.00000000000 -0.64543336765 -0.26410154027  0.03808980943
[11]  0.00876253499  0.00064426543
[1] 30
Time difference of 2.4177379 hours
 [1]  1.6316711e-01  5.4089840e+00  2.2203083e-01  4.1566882e-01 -7.8009616e-01
 [6]  3.5260516e+00  0.0000000e+00 -1.0750828e-01 -3.2454159e-01  2.2173572e-02
[11]  6.1648052e-08  7.1693634e-04
[1] 31
Time difference of 2.5996353 hours
 [1]  0.11733904502  5.03424658671  0.26313637577  0.40485031197 -0.82140100332
 [6]  2.96915441894  0.00000000000 -0.94997925517 -0.25865109279  0.01742173179
[11]  0.01071847347  0.00026094602
[1] 32
Time difference of 50.55985 mins
 [1]  0.19491386872  4.93910844233  0.22440078193  0.42756998607 -0.81259071307
 [6]  3.15527543474  0.00000000000 -0.53596039400 -0.32290418665  0.03113977849
[11]  0.00671032450  0.00056663314
[1] 33
Time difference of 53.730493 mins
 [1]  0.18050421746  4.11403405305  0.20856965875  0.38889853344 -0.81942884932
 [6]  3.11790725488  0.00000000000 -0.00028143451 -0.25852229914  0.02057001700
[11]  0.00441029395  0.00132816945
[1] 34
Time difference of 1.1396207 hours
 [1]  1.7404125e-01  3.9830736e+00  2.1295703e-01  3.6589373e-01 -7.6278538e-01
 [6]  1.9558547e+00  0.0000000e+00 -3.2925972e-05 -3.3624344e-01  3.6126700e-02
[11]  1.2455438e-02  1.0746925e-03
[1] 35
Time difference of 1.0817611 hours
 [1]  0.15088838243  2.95764961485  0.25171374565  0.39963013885 -0.79114564496
 [6]  2.90221471748  0.00000000000 -0.94996610762 -0.28452293737  0.02403354921
[11]  0.00323922811  0.00062733144
[1] 36
Time difference of 42.087027 mins
 [1]  0.2109337392  3.5285505013  0.2064609223  0.3858412475 -0.7841346323
 [6]  2.5646133238  0.0000000000 -0.4191424054 -0.2799563592  0.0377112482
[11]  0.0179265868  0.0011428811
