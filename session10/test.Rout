
R version 3.3.3 (2017-03-06) -- "Another Canoe"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> set.seed(22111)
> 
> n = 50
> len = 2501
> par = c(0.1, 6,  0.25,  0.6,  -0.8,  3,  0,  -0.6,  -0.3, 0.025, 0.02, 0.002)
> 
> require(Rcpp)
Loading required package: Rcpp
> require(BH)
Loading required package: BH
> require(nloptr)
Loading required package: nloptr
> require(ggplot2)
Loading required package: ggplot2
> require(gridExtra)
Loading required package: gridExtra
> options(digits=8)
> source('../conv_plot.R')
> sourceCpp('../Simulation.cpp')
> sourceCpp('../nll.cpp', verbose = F)
> 
> opts <- list(algorithm="NLOPT_LN_NELDERMEAD", xtol_rel = 1.0e-5, maxeval = 10000)
> # set lower and upper bound
> lb = c(-0.5, 0.001, 1e-6, 0.001, -0.95, 0, 0, -0.95, -1, 0, 0, 0)
> ub = c(1, 100, 10, 1, 0.95, 10, 0, 0, 0, 1, 1, 1)
> 
> npar = 12
> # run n paths
> converge.list = matrix(, nrow = n, ncol = npar)
> est.par.list = matrix(, nrow = n, ncol = npar)
> success.list = vector(mode="numeric", length = n)
> 
> i = 1
> while(i <= n) {
+     seed = sample(10000, 5)
+     sim = SimOUSVJJ(par, len, log(100), par[3], 1/252, seed[1], seed[2], seed[3], seed[4], seed[5])
+     y = sim$y
+ 
+ 	f <- function(p) {
+ 	    return(nll(p, y))
+ 	}
+     
+     start = Sys.time()
+     result = nloptr(x0 = par, eval_f = f, 
+        opts = opts, 
+        lb = lb, ub = ub)
+     if(result$status < 0)
+         next;
+ 	est_list = as.numeric(result$solution)
+ 	c_list = check.converge(f, result$solution)
+ 	m_list = check.mono(f, result$solution)
+     flag = all(m_list | c_list)
+ 
+     write.table(est_list, file = "./est.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+ 	write.table(c_list, file = "./conv.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+     write.table(flag, file = "./success.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+     
+     print(i)
+     print(Sys.time() - start)
+     print(est_list)
+     
+     est.par.list[i, ] = as.numeric(est_list)
+     converge.list[i, ] = c_list
+     success.list[i] = flag
+ 	i = i + 1
+ }
[1] 1
Time difference of 2.1332097 hours
 [1]  1.4723872e-01  3.9576282e+00  2.5044731e-01  4.0782464e-01 -7.8384853e-01
 [6]  2.3798264e+00  0.0000000e+00 -7.5327805e-01 -3.2129194e-01  2.5539202e-02
[11]  2.3918708e-06  7.7104611e-04
[1] 2
Time difference of 1.5671 hours
 [1]  1.2725556e-01  3.8125502e+00  2.5837872e-01  4.0460746e-01 -8.1006833e-01
 [6]  2.2609174e+00  0.0000000e+00 -1.0338223e-06 -3.5035772e-01  1.7700148e-02
[11]  4.2181424e-04  1.0615552e-03
[1] 3
Time difference of 52.729492 mins
 [1]  0.17935220358  4.60731421323  0.24067998497  0.41305903967 -0.77398013850
 [6]  2.48425635526  0.00000000000 -0.94999985869 -0.25499870467  0.03642715750
[11]  0.01209370829  0.00051502792
[1] 4
Time difference of 1.8913111 hours
 [1]  1.3359729e-01  4.5507283e+00  2.0488492e-01  3.9467065e-01 -7.4666939e-01
 [6]  2.8502153e+00  0.0000000e+00 -7.3395889e-06 -2.7450971e-01  2.4733493e-02
[11]  3.3755717e-05  8.0148850e-04
[1] 5
Time difference of 54.342412 mins
 [1]  0.1545839833  4.3140646575  0.2260069250  0.3962946292 -0.7769271558
 [6]  3.8222228787  0.0000000000 -0.5002452954 -0.2521627734  0.0215890630
[11]  0.0196248409  0.0006036718
[1] 6
Time difference of 1.1407402 hours
 [1]  1.5929126e-01  4.1170586e+00  2.3120707e-01  4.0992458e-01 -7.5912251e-01
 [6]  4.2716847e+00  0.0000000e+00 -8.1634068e-05 -2.9965512e-01  1.9963630e-02
[11]  2.1638685e-02  2.0393790e-07
[1] 7
Time difference of 1.8035993 hours
 [1]  1.8910832e-01  3.5729479e+00  2.4540538e-01  4.0745990e-01 -7.1241613e-01
 [6]  3.2848552e+00  0.0000000e+00 -1.1956755e-05 -3.1164831e-01  1.3011984e-02
[11]  1.8934461e-02  6.3363284e-04
[1] 8
Time difference of 48.819773 mins
 [1]  0.16428305666  4.20420374132  0.21967051887  0.39422172169 -0.80077466261
 [6]  4.06353756099  0.00000000000 -0.03977704524 -0.27852247737  0.03344232105
[11]  0.01160034455  0.00073605124
[1] 9
Time difference of 1.3504807 hours
 [1]  1.1341785e-01  4.3098744e+00  2.4611088e-01  4.0268529e-01 -8.1711753e-01
 [6]  3.1435776e+00  0.0000000e+00 -1.6059718e-06 -2.7436721e-01  3.5986854e-02
[11]  2.4720630e-02  3.7532213e-04
[1] 10
Time difference of 1.3078578 hours
 [1]  1.9296488e-01  4.5751668e+00  2.5224336e-01  4.1619468e-01 -8.4479722e-01
 [6]  3.4988339e+00  0.0000000e+00 -5.1278462e-07 -2.4099434e-01  3.0590607e-02
[11]  1.0164371e-02  8.0040561e-04
[1] 11
Time difference of 2.4190955 hours
 [1]  1.0458616e-01  4.3086413e+00  2.5405603e-01  4.2175865e-01 -8.4424476e-01
 [6]  2.3422314e+00  0.0000000e+00 -9.4999953e-01 -2.5466539e-01  4.7898044e-02
[11]  2.0780735e-05  8.7532984e-04
[1] 12
Time difference of 41.675915 mins
 [1]  0.11103083972  4.01199442043  0.23520533249  0.38949571263 -0.79441609408
 [6]  3.73509651713  0.00000000000 -0.10283178286 -0.32083776468  0.02811083051
[11]  0.01588179847  0.00040926803
[1] 13
Time difference of 53.277988 mins
 [1]  0.16423012011  4.05050542700  0.22140972457  0.40608899838 -0.77370636863
 [6]  2.00856194837  0.00000000000 -0.94999588489 -0.24744280546  0.03003526316
[11]  0.00172239872  0.00025574068
[1] 14
Time difference of 1.4687731 hours
 [1]  0.15016637801  4.80726942737  0.24408257293  0.41525412551 -0.87276349007
 [6]  2.70235913893  0.00000000000 -0.06241724822 -0.31320051994  0.02164836540
[11]  0.03136252669  0.00022213056
[1] 15
Time difference of 1.5668363 hours
 [1]  0.1546919415  4.4802169116  0.2396967035  0.4047388126 -0.7766135678
 [6]  3.7851306854  0.0000000000 -0.9499997674 -0.2643212323  0.0290642879
[11]  0.0135434039  0.0005577441
[1] 16
Time difference of 1.7302569 hours
 [1]  1.9058017e-01  4.6543029e+00  2.1522433e-01  4.2311059e-01 -7.8192704e-01
 [6]  2.4504193e+00  0.0000000e+00 -1.4549778e-04 -3.5129765e-01  1.8607502e-02
[11]  1.0579707e-02  9.4357206e-09
[1] 17
Time difference of 56.766461 mins
 [1]  1.7392774e-01  5.5320452e+00  2.3072816e-01  4.0299782e-01 -8.3130752e-01
 [6]  2.5774895e+00  0.0000000e+00 -6.2067919e-06 -3.0331549e-01  2.7091224e-02
[11]  1.7623845e-02  5.5377448e-04
[1] 18
Time difference of 1.611734 hours
 [1]  1.1617702e-01  3.9745089e+00  1.9898093e-01  3.8982154e-01 -8.0612108e-01
 [6]  3.6129225e+00  0.0000000e+00 -9.4999359e-01 -2.3431577e-01  3.1781549e-02
[11]  3.1004052e-02  6.7058853e-05
[1] 19
Time difference of 1.0354498 hours
 [1]  0.202178270  3.240918251  0.170569694  0.382320396 -0.781792997
 [6]  3.064211732  0.000000000 -0.448691777 -0.295216723  0.027792063
[11]  0.034861817  0.000000000
[1] 20
Time difference of 1.2083044 hours
 [1]  1.3377754e-01  5.4497688e+00  2.1914531e-01  4.2037437e-01 -7.6225816e-01
 [6]  2.6335807e+00  0.0000000e+00 -4.2181410e-01 -3.5863590e-01  2.3694479e-02
[11]  3.9421801e-02  1.5840879e-10
[1] 21
Time difference of 1.0546139 hours
 [1]  0.13139675429  5.65672136305  0.24277935423  0.42326181837 -0.80112057232
 [6]  2.13331171684  0.00000000000 -0.25035459981 -0.36261680506  0.01208725996
[11]  0.02074716837  0.00073884458
[1] 22
Time difference of 37.101408 mins
 [1]  1.8647491e-01  3.7977340e+00  2.3839392e-01  3.8279511e-01 -7.8086148e-01
 [6]  3.8867964e+00  0.0000000e+00 -2.3535580e-02 -2.4327048e-01  2.5119894e-02
[11]  3.7254435e-06  7.6837242e-04
[1] 23
Time difference of 52.147312 mins
 [1]  0.1819986785  5.1130450733  0.2017591748  0.3873921818 -0.8130969442
 [6]  2.7886750311  0.0000000000 -0.8294815914 -0.2933315138  0.0203297921
[11]  0.0039029996  0.0011637642
[1] 24
Time difference of 1.7125823 hours
 [1]  1.8233846e-01  4.3945511e+00  2.4047102e-01  4.1132566e-01 -7.8189104e-01
 [6]  3.0812500e+00  0.0000000e+00 -1.1626584e-05 -2.4823926e-01  2.8816246e-02
[11]  5.7645178e-03  9.1855531e-04
[1] 25
Time difference of 1.7104698 hours
 [1]  0.17859031796  4.10409925749  0.25665966058  0.39967963370 -0.78061539945
 [6]  3.16592361388  0.00000000000 -0.94994824326 -0.27589768356  0.02012854048
[11]  0.00002540644  0.00014932721
[1] 26
Time difference of 43.007098 mins
 [1]  0.15570734086  3.94412417963  0.21974104485  0.37363601941 -0.82581879956
 [6]  3.39982019613  0.00000000000 -0.03993188480 -0.25918771849  0.01774511965
[11]  0.00353166236  0.00067444633
[1] 27
Time difference of 1.6286127 hours
 [1]  1.1662172e-01  5.2399009e+00  2.4558897e-01  3.9763934e-01 -7.4186242e-01
 [6]  2.1499386e+00  0.0000000e+00 -6.7989996e-01 -3.1511672e-01  2.1362226e-02
[11]  2.4335853e-09  7.2674206e-04
[1] 28
Time difference of 1.8243517 hours
 [1]  1.8997386e-01  3.6640798e+00  2.2757302e-01  4.1380483e-01 -7.6709662e-01
 [6]  3.8470358e+00  0.0000000e+00 -9.4961187e-01 -3.3392661e-01  2.8639188e-02
[11]  1.5629726e-07  5.3535076e-04
[1] 29
Time difference of 47.546583 mins
 [1]  0.18543002795  5.29797582398  0.23787180633  0.41203693119 -0.78990567031
 [6]  2.38130002671  0.00000000000 -0.64422160017 -0.35548050170  0.02704662331
[11]  0.01472785032  0.00080252622
[1] 30
Time difference of 57.917664 mins
 [1]  0.16541191593  4.03158093066  0.21928554631  0.39726058488 -0.80880991306
 [6]  2.38100478170  0.00000000000 -0.54534174970 -0.31858319120  0.01707790025
[11]  0.03082606589  0.00039280248
[1] 31
Time difference of 2.1833641 hours
 [1]  0.18147353292  5.10684634137  0.20777919647  0.42399720228 -0.81126340790
 [6]  3.00907960297  0.00000000000 -0.94999997794 -0.36079181276  0.01144658787
[11]  0.02717229226  0.00034455889
[1] 32
Time difference of 1.0183047 hours
 [1]  1.9387510e-01  4.3202676e+00  2.1932676e-01  4.1364143e-01 -8.0955735e-01
 [6]  3.3535833e+00  0.0000000e+00 -6.1446955e-06 -2.7526203e-01  3.0963670e-02
[11]  1.3719437e-02  6.9120123e-04
[1] 33
Time difference of 47.181349 mins
 [1]  0.13699799752  5.36138758191  0.24485413108  0.43020851895 -0.77416760402
 [6]  3.22006151492  0.00000000000 -0.20663955966 -0.27008202771  0.05229294551
[11]  0.01353334252  0.00074179438
[1] 34
Time difference of 1.4833622 hours
 [1]  0.16707039262  4.41539573773  0.27167709845  0.41361335465 -0.76590641828
 [6]  2.10588388222  0.00000000000 -0.94999904057 -0.35497972044  0.01415003703
[11]  0.00017638696  0.00052118441
[1] 35
Time difference of 44.870229 mins
 [1]  8.6052066e-02  3.4234292e+00  2.8288788e-01  3.9806063e-01 -8.2569065e-01
 [6]  3.6510369e+00  0.0000000e+00 -8.7655645e-06 -2.5775028e-01  2.4612247e-02
[11]  2.4905536e-06  8.3773636e-04
