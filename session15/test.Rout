
R version 3.3.3 (2017-03-06) -- "Another Canoe"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> set.seed(21298)
> 
> n = 50
> len = 2501
> par = c(0.1, 6,  0.25,  0.6,  -0.8,  3,  0,  -0.6,  -0.3, 0.025, 0.02, 0.002)
> 
> require(Rcpp)
Loading required package: Rcpp
> require(BH)
Loading required package: BH
> require(nloptr)
Loading required package: nloptr
> require(ggplot2)
Loading required package: ggplot2
> require(gridExtra)
Loading required package: gridExtra
> options(digits=8)
> source('../conv_plot.R')
> sourceCpp('../Simulation.cpp')
> sourceCpp('../nll.cpp', verbose = F)
> 
> opts <- list(algorithm="NLOPT_LN_NELDERMEAD", xtol_rel = 1.0e-5, maxeval = 10000)
> # set lower and upper bound
> lb = c(-0.5, 0.001, 1e-6, 0.001, -0.95, 0, 0, -0.95, -1, 0, 0, 0)
> ub = c(1, 100, 10, 1, 0.95, 10, 0, 0, 0, 1, 1, 1)
> 
> npar = 12
> # run n paths
> converge.list = matrix(, nrow = n, ncol = npar)
> est.par.list = matrix(, nrow = n, ncol = npar)
> success.list = vector(mode="numeric", length = n)
> 
> i = 1
> while(i <= n) {
+     seed = sample(10000, 5)
+     sim = SimOUSVJJ(par, len, log(100), par[3], 1/252, seed[1], seed[2], seed[3], seed[4], seed[5])
+     y = sim$y
+ 
+ 	f <- function(p) {
+ 	    return(nll(p, y))
+ 	}
+     
+     start = Sys.time()
+     result = nloptr(x0 = par, eval_f = f, 
+        opts = opts, 
+        lb = lb, ub = ub)
+     if(result$status < 0)
+         next;
+ 	est_list = as.numeric(result$solution)
+ 	c_list = check.converge(f, result$solution)
+ 	m_list = check.mono(f, result$solution)
+     flag = all(m_list | c_list)
+ 
+     write.table(est_list, file = "./est.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+ 	write.table(c_list, file = "./conv.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+     write.table(flag, file = "./success.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+     
+     print(i)
+     print(Sys.time() - start)
+     print(est_list)
+     
+     est.par.list[i, ] = as.numeric(est_list)
+     converge.list[i, ] = c_list
+     success.list[i] = flag
+ 	i = i + 1
+ }
[1] 1
Time difference of 56.611694 mins
 [1]  1.7619712e-01  5.3559515e+00  1.8956928e-01  4.0450537e-01 -7.8734428e-01
 [6]  2.4993607e+00  0.0000000e+00 -3.1762772e-02 -3.3316428e-01  2.9079042e-02
[11]  3.9761737e-02  8.4436938e-05
[1] 2
Time difference of 2.1351349 hours
 [1]  1.7973183e-01  4.8368867e+00  2.0890472e-01  3.9237298e-01 -8.3323999e-01
 [6]  1.6881863e+00  0.0000000e+00 -9.4999814e-01 -2.3949698e-01  1.9931744e-02
[11]  3.1360289e-05  6.5893190e-04
[1] 3
Time difference of 1.2783749 hours
 [1]  1.4522480e-01  3.5241474e+00  2.4630069e-01  3.9456509e-01 -7.8197674e-01
 [6]  3.1940283e+00  0.0000000e+00 -3.7103055e-06 -3.4550223e-01  2.0889806e-02
[11]  1.2956863e-03  6.8339255e-05
[1] 4
Time difference of 59.538238 mins
 [1]  0.1040106736  4.2536759643  0.2202821892  0.4227110266 -0.7919652414
 [6]  3.4077513104  0.0000000000 -0.9425979451 -0.2627710864  0.0261571414
[11]  0.0252697361  0.0002033508
[1] 5
Time difference of 1.669146 hours
 [1]  0.16501958260  4.20052441532  0.19600831913  0.39515991860 -0.75410534144
 [6]  2.29560658367  0.00000000000 -0.94999816503 -0.30177047778  0.05383269354
[11]  0.03193737568  0.00011655332
[1] 6
Time difference of 1.0742764 hours
 [1]  1.2130327e-01  3.7748187e+00  2.5219766e-01  3.7925791e-01 -8.3262118e-01
 [6]  3.5596054e+00  0.0000000e+00 -7.1477624e-07 -2.6001025e-01  2.6612490e-02
[11]  2.1858131e-02  8.9037145e-04
[1] 7
Time difference of 1.0553349 hours
 [1]  0.12274786145  3.67411631807  0.25856273628  0.39246300856 -0.78202993573
 [6]  3.16661361805  0.00000000000 -0.59248274721 -0.30301845095  0.02885779711
[11]  0.01478737413  0.00024973412
[1] 8
Time difference of 45.908654 mins
 [1]  0.1125475187  4.0821566066  0.2679549334  0.4033208221 -0.8062799063
 [6]  3.9853455126  0.0000000000 -0.8078400497 -0.2670563237  0.0283583220
[11]  0.0150598141  0.0002643202
[1] 9
Time difference of 1.1352641 hours
 [1]  0.17271101197  4.47295108572  0.22588458280  0.40026231089 -0.75514529448
 [6]  3.84409662607  0.00000000000 -0.94999965005 -0.27009297201  0.02801051893
[11]  0.01584100514  0.00055888757
[1] 10
Time difference of 1.2638647 hours
 [1]  1.5091936e-01  4.2833883e+00  2.5238117e-01  4.3038001e-01 -8.2552352e-01
 [6]  2.6375325e+00  0.0000000e+00 -2.0338242e-01 -2.6147656e-01  1.7008391e-02
[11]  1.0349738e-07  3.9409845e-04
[1] 11
Time difference of 1.0101574 hours
 [1]  0.12683729912  3.80668357040  0.25281882178  0.36489510139 -0.75727727370
 [6]  3.00654566323  0.00000000000 -0.94993580803 -0.28137943487  0.01946834159
[11]  0.00776655048  0.00037385101
[1] 12
Time difference of 2.1342197 hours
 [1]  1.5648912e-01  4.4317240e+00  2.3961213e-01  4.2643876e-01 -8.6222305e-01
 [6]  3.1947548e+00  0.0000000e+00 -3.9190050e-06 -2.8765101e-01  2.6510376e-02
[11]  2.9308358e-02  2.6885578e-04
[1] 13
Time difference of 53.357938 mins
 [1]  0.15453143258  3.54499433319  0.25674397129  0.42217953095 -0.77275262187
 [6]  3.63329405205  0.00000000000 -0.63050422363 -0.21920867213  0.02861786450
[11]  0.00723601711  0.00060791375
[1] 14
Time difference of 5.2188554 hours
 [1]  1.2497827e-01  4.7855434e+00  2.3288928e-01  4.1455035e-01 -8.1282428e-01
 [6]  3.1486254e+00  0.0000000e+00 -9.4998949e-01 -2.1349871e-01  2.7187332e-02
[11]  6.7356014e-06  7.1137847e-04
[1] 15
Time difference of 51.890804 mins
 [1]  0.18929392990  3.32769926125  0.19603221879  0.37199127935 -0.78471967493
 [6]  2.11969932185  0.00000000000 -0.00561832634 -0.34851881465  0.01252152851
[11]  0.00348138074  0.00094944935
[1] 16
Time difference of 1.4057689 hours
 [1]  1.2097152e-01  5.2712426e+00  2.5413220e-01  4.2205851e-01 -7.7159830e-01
 [6]  2.3858894e+00  0.0000000e+00 -9.4985522e-01 -3.0478005e-01  4.7727805e-02
[11]  2.0090215e-05  5.0871790e-04
[1] 17
Time difference of 1.9343762 hours
 [1]  0.14776662620  5.12507632790  0.27397353495  0.42235292240 -0.77850837917
 [6]  2.16743104162  0.00000000000 -0.94999999708 -0.28115929147  0.02038379745
[11]  0.01030788367  0.00069571263
[1] 18
Time difference of 38.102545 mins
 [1]  0.0999809608  5.3042932760  0.2715683538  0.4340306066 -0.7733602933
 [6]  2.9371914567  0.0000000000 -0.9278297048 -0.3553538497  0.0239414681
[11]  0.0229419509  0.0007887896
[1] 19
Time difference of 1.1412138 hours
 [1]  1.4765509e-01  2.6214997e+00  2.5158933e-01  3.9272527e-01 -8.1017874e-01
 [6]  2.7023674e+00  0.0000000e+00 -2.3825656e-01 -3.0042671e-01  3.4107440e-02
[11]  1.3409052e-06  7.4997396e-04
[1] 20
Time difference of 1.7499901 hours
 [1]  1.4838818e-01  5.6428065e+00  2.3685843e-01  4.2537663e-01 -8.1187306e-01
 [6]  3.0501259e+00  0.0000000e+00 -6.5517373e-02 -2.7889060e-01  2.8120308e-02
[11]  1.9040650e-08  9.9351197e-04
[1] 21
Time difference of 1.3466533 hours
 [1]  1.6998319e-01  3.6430680e+00  2.3627889e-01  3.8162789e-01 -7.4111257e-01
 [6]  3.9107596e+00  0.0000000e+00 -3.5939447e-05 -2.7965083e-01  3.4770292e-02
[11]  8.6304258e-08  8.5726750e-04
[1] 22
Time difference of 45.161617 mins
 [1]  0.11794693373  3.44713690375  0.25490990476  0.40642920494 -0.77781788660
 [6]  2.36056407565  0.00000000000 -0.26163534539 -0.26589993813  0.01548746552
[11]  0.01376087016  0.00070875311
[1] 23
Time difference of 1.2248571 hours
 [1]  0.11768577080  4.60141143772  0.27157612487  0.41047002480 -0.80913134591
 [6]  3.62310873418  0.00000000000 -0.94999988766 -0.27346330015  0.02836716912
[11]  0.00740641570  0.00022671536
[1] 24
Time difference of 1.3653573 hours
 [1]  0.14246121321  5.20237414837  0.24687972514  0.42991672788 -0.78984328534
 [6]  3.09352828343  0.00000000000 -0.94999847426 -0.28576073741  0.03645385205
[11]  0.00495528162  0.00047858772
[1] 25
Time difference of 1.5593628 hours
 [1]  1.6056416e-01  3.7309459e+00  2.5124166e-01  3.8911218e-01 -7.6829726e-01
 [6]  3.5684581e+00  0.0000000e+00 -1.9624420e-01 -2.9357652e-01  2.3372475e-02
[11]  2.5364215e-08  9.7201946e-04
[1] 26
Time difference of 38.140903 mins
 [1]  0.04863475959  4.84244476171  0.28712548017  0.41240919423 -0.76062406716
 [6]  2.27134185835  0.00000000000 -0.02572081343 -0.29449107462  0.01173373370
[11]  0.00072335972  0.00044749786
[1] 27
Time difference of 44.923551 mins
 [1]  1.7970097e-01  3.7874844e+00  2.2218598e-01  3.8899531e-01 -7.4087002e-01
 [6]  2.6359808e+00  0.0000000e+00 -7.3780506e-01 -2.9170585e-01  1.7580992e-02
[11]  1.1119677e-02  6.3620316e-07
[1] 28
Time difference of 51.419944 mins
 [1]  0.10328194835  4.10753720118  0.28647864544  0.41727466364 -0.76855268909
 [6]  2.58160955216  0.00000000000 -0.69341645105 -0.33589755906  0.01995384955
[11]  0.00211418229  0.00073910303
[1] 29
Time difference of 51.013666 mins
 [1]  0.15604461438  4.91161707521  0.23787172447  0.41051356627 -0.72778614618
 [6]  3.65452850847  0.00000000000 -0.20021777110 -0.35384128587  0.01638116202
[11]  0.01223762460  0.00075404117
[1] 30
Time difference of 1.1273533 hours
 [1]  0.14315370339  4.70646360081  0.22793661343  0.41152048387 -0.76777072795
 [6]  3.11275287663  0.00000000000 -0.94994069364 -0.26770364777  0.02464413186
[11]  0.02224244720  0.00016920251
[1] 31
Time difference of 36.279491 mins
 [1]  1.7997928e-01  3.4568644e+00  2.7116609e-01  3.9048168e-01 -8.0438740e-01
 [6]  2.8641217e+00  0.0000000e+00 -9.2959927e-01 -2.9713133e-01  2.6606384e-02
[11]  1.0486867e-03  6.8056260e-06
[1] 32
Time difference of 1.2259068 hours
 [1]  0.15522912077  3.59158433508  0.25402168499  0.38849859750 -0.76398965830
 [6]  2.13559435154  0.00000000000 -0.94976496929 -0.32048112280  0.01182689088
[11]  0.00021595329  0.00072146384
[1] 33
Time difference of 1.0423518 hours
 [1]  0.12769282685  4.86019317311  0.22617485911  0.40970699911 -0.85849177411
 [6]  4.50352139860  0.00000000000 -0.94978257195 -0.28121018872  0.04539780379
[11]  0.02426875740  0.00038795281
[1] 34
Time difference of 1.5987916 hours
 [1]  1.2974390e-01  5.2032616e+00  2.4727560e-01  4.1623376e-01 -7.4435031e-01
 [6]  2.6827422e+00  0.0000000e+00 -7.1658657e-05 -3.5349940e-01  1.9961680e-02
[11]  2.0941963e-02  7.6133289e-09
[1] 35
Time difference of 1.2182855 hours
 [1]  1.2851640e-01  4.5957265e+00  2.5552878e-01  4.0069181e-01 -7.8094965e-01
 [6]  3.4486274e+00  0.0000000e+00 -7.3876996e-01 -2.8322661e-01  2.4159166e-02
[11]  1.0622510e-02  4.5220889e-11
