
R version 3.3.3 (2017-03-06) -- "Another Canoe"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> set.seed(12929)
> 
> n = 50
> len = 2501
> par = c(0.1, 6,  0.25,  0.6,  -0.8,  3,  0,  -0.6,  -0.3, 0.025, 0.02, 0.002)
> 
> require(Rcpp)
Loading required package: Rcpp
> require(BH)
Loading required package: BH
> require(nloptr)
Loading required package: nloptr
> require(ggplot2)
Loading required package: ggplot2
> require(gridExtra)
Loading required package: gridExtra
> options(digits=8)
> source('../conv_plot.R')
> sourceCpp('../Simulation.cpp')
> sourceCpp('../nll.cpp', verbose = F)
> 
> opts <- list(algorithm="NLOPT_LN_NELDERMEAD", xtol_rel = 1.0e-5, maxeval = 10000)
> # set lower and upper bound
> lb = c(-0.5, 0.001, 1e-6, 0.001, -0.95, 0, 0, -0.95, -1, 0, 0, 0)
> ub = c(1, 100, 10, 1, 0.95, 10, 0, 0, 0, 1, 1, 1)
> 
> npar = 12
> # run n paths
> converge.list = matrix(, nrow = n, ncol = npar)
> est.par.list = matrix(, nrow = n, ncol = npar)
> success.list = vector(mode="numeric", length = n)
> 
> i = 1
> while(i <= n) {
+     seed = sample(10000, 5)
+     sim = SimOUSVJJ(par, len, log(100), par[3], 1/252, seed[1], seed[2], seed[3], seed[4], seed[5])
+     y = sim$y
+ 
+ 	f <- function(p) {
+ 	    return(nll(p, y))
+ 	}
+     
+     start = Sys.time()
+     result = nloptr(x0 = par, eval_f = f, 
+        opts = opts, 
+        lb = lb, ub = ub)
+     if(result$status < 0)
+         next;
+ 	est_list = as.numeric(result$solution)
+ 	c_list = check.converge(f, result$solution)
+ 	m_list = check.mono(f, result$solution)
+     flag = all(m_list | c_list)
+ 
+     write.table(est_list, file = "./est.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+ 	write.table(c_list, file = "./conv.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+     write.table(flag, file = "./success.csv", sep = ",", append = T, row.names = F, col.names = F, quote = F)
+     
+     print(i)
+     print(Sys.time() - start)
+     print(est_list)
+     
+     est.par.list[i, ] = as.numeric(est_list)
+     converge.list[i, ] = c_list
+     success.list[i] = flag
+ 	i = i + 1
+ }
[1] 1
Time difference of 59.455754 mins
 [1]  0.13817173028  4.82394504974  0.22258298311  0.41818808699 -0.80640261639
 [6]  2.89245505864  0.00000000000 -0.07230071109 -0.32310765741  0.01872323101
[11]  0.02613558278  0.00024204931
[1] 2
Time difference of 42.335827 mins
 [1]  0.13472761500  4.20263059600  0.24692842081  0.41262758708 -0.82700320655
 [6]  2.87443350777  0.00000000000 -0.45542853220 -0.30798577716  0.02493258890
[11]  0.01349940389  0.00094400626
[1] 3
Time difference of 49.530599 mins
 [1]  0.18679955564  2.99234339320  0.24522373805  0.36834056251 -0.80181326792
 [6]  3.21081842321  0.00000000000 -0.00053560859 -0.31598498953  0.00949210920
[11]  0.00290901419  0.00127681404
[1] 4
Time difference of 1.3237234 hours
 [1]  9.3697898e-02  4.5271728e+00  2.7214114e-01  4.1772661e-01 -7.9439079e-01
 [6]  3.9448769e+00  0.0000000e+00 -9.4999936e-01 -2.5750669e-01  3.1563089e-02
[11]  6.0669853e-08  4.5174097e-04
[1] 5
Time difference of 2.2441233 hours
 [1]  1.6277752e-01  5.8884985e+00  2.1499244e-01  4.1077069e-01 -7.3872174e-01
 [6]  4.0105980e+00  0.0000000e+00 -9.4971539e-01 -3.3937796e-01  2.6465014e-02
[11]  3.0227306e-02  2.7421012e-06
[1] 6
Time difference of 1.1830169 hours
 [1]  0.15824078151  3.70369076658  0.22592675932  0.40176330685 -0.80767471056
 [6]  3.91683996535  0.00000000000 -0.00028886600 -0.26192713851  0.02734045830
[11]  0.00174029355  0.00083408433
[1] 7
Time difference of 1.0269635 hours
 [1]  0.14481863121  4.13463019047  0.26555308726  0.39314489972 -0.81065111662
 [6]  3.33862319561  0.00000000000 -0.94999953808 -0.32002643022  0.02943991272
[11]  0.00901198446  0.00057528194
[1] 8
Time difference of 50.222123 mins
 [1]  0.2072497615  3.2320906775  0.2264221638  0.3974802023 -0.7947532071
 [6]  3.9063365690  0.0000000000 -0.9496195600 -0.2463317710  0.0248686582
[11]  0.0095498122  0.0003572468
[1] 9
Time difference of 1.656238 hours
 [1]  1.8477718e-01  4.5116518e+00  2.0963567e-01  4.1695690e-01 -7.9313002e-01
 [6]  2.4234566e+00  0.0000000e+00 -9.4999273e-01 -3.1553977e-01  2.7250497e-02
[11]  2.7549610e-02  7.2344136e-05
[1] 10
Time difference of 2.5156301 hours
 [1]  1.4722758e-01  4.5121258e+00  2.2705282e-01  4.0448200e-01 -7.9708192e-01
 [6]  3.6957355e+00  0.0000000e+00 -8.0600733e-04 -2.6789455e-01  2.5398649e-02
[11]  1.6848662e-06  1.1152429e-03
[1] 11
Time difference of 54.563104 mins
 [1]  1.5798529e-01  4.2183112e+00  2.5001360e-01  4.1317934e-01 -8.2593355e-01
 [6]  3.4328905e+00  0.0000000e+00 -8.3218864e-01 -2.8511581e-01  1.7002434e-02
[11]  6.2918288e-03  9.5639162e-08
[1] 12
Time difference of 1.627585 hours
 [1]  0.18235054046  3.87227007710  0.21749833216  0.38554461901 -0.78086831721
 [6]  3.43665784793  0.00000000000 -0.94998150713 -0.30556766829  0.02659274240
[11]  0.01369145922  0.00023262613
[1] 13
Time difference of 35.666063 mins
 [1]  0.15734386871  4.32623231724  0.23870350706  0.40005508143 -0.80796328738
 [6]  4.07589742670  0.00000000000 -0.92809297554 -0.24095861859  0.04211876906
[11]  0.01526676554  0.00033042701
[1] 14
Time difference of 1.4517687 hours
 [1]  1.6758436e-01  3.5545039e+00  2.4487219e-01  3.8307007e-01 -8.1603277e-01
 [6]  3.1049553e+00  0.0000000e+00 -9.4995668e-01 -3.6834475e-01  2.3935097e-02
[11]  3.7067476e-02  7.1496890e-06
[1] 15
Time difference of 52.330392 mins
 [1]  1.2824795e-01  5.0858944e+00  2.2759728e-01  4.0279127e-01 -7.9062165e-01
 [6]  4.0676856e+00  0.0000000e+00 -6.5679299e-07 -2.4042201e-01  2.6033596e-02
[11]  2.0235402e-02  7.1230375e-04
[1] 16
Time difference of 1.3000388 hours
 [1]  0.144004277  3.714146407  0.284623236  0.407168681 -0.781743466
 [6]  2.653429385  0.000000000 -0.119810691 -0.270842405  0.023705127
[11]  0.030623426  0.000000000
[1] 17
Time difference of 52.313706 mins
 [1]  1.2320946e-01  3.7465553e+00  2.7669514e-01  4.0417254e-01 -7.6823914e-01
 [6]  2.8206779e+00  0.0000000e+00 -5.0485488e-01 -3.1013181e-01  2.4673576e-02
[11]  1.6782964e-08  0.0000000e+00
[1] 18
Time difference of 41.047363 mins
 [1]  0.1650858206  3.8318047572  0.2660108348  0.4104622376 -0.8541545236
 [6]  2.8394716907  0.0000000000 -0.4946904227 -0.3007122994  0.0213270611
[11]  0.0140602779  0.0010272107
[1] 19
Time difference of 1.0519997 hours
 [1]  1.5983562e-01  4.1533875e+00  2.4073124e-01  4.1237967e-01 -7.8923819e-01
 [6]  2.8432016e+00  0.0000000e+00 -1.3959719e-05 -2.6107186e-01  2.3469046e-02
[11]  1.0068576e-02  9.2193545e-04
[1] 20
Time difference of 54.126825 mins
 [1]  1.6773715e-01  6.1142970e+00  2.5672596e-01  4.2143698e-01 -7.5939546e-01
 [6]  3.7281346e+00  0.0000000e+00 -2.3644596e-01 -2.6001026e-01  4.4422881e-02
[11]  1.2924972e-08  6.7978188e-04
[1] 21
Time difference of 1.4330608 hours
 [1]  2.0698977e-01  4.0264475e+00  2.4255433e-01  4.1631190e-01 -7.4941440e-01
 [6]  1.9818096e+00  0.0000000e+00 -4.6085753e-07 -2.4475000e-01  1.8079833e-02
[11]  3.0536745e-03  8.2679264e-04
[1] 22
Time difference of 1.7104873 hours
 [1]  2.1839259e-01  3.6709276e+00  2.5577260e-01  4.0856998e-01 -7.7495722e-01
 [6]  3.1857049e+00  0.0000000e+00 -5.7082429e-01 -2.7825836e-01  2.6397886e-02
[11]  8.3924083e-08  5.0070198e-04
[1] 23
Time difference of 1.1974713 hours
 [1]  1.4754090e-01  4.0105235e+00  2.3575472e-01  4.0655880e-01 -7.8290938e-01
 [6]  2.4690331e+00  0.0000000e+00 -3.7456143e-01 -3.7116312e-01  1.8964752e-02
[11]  2.6192334e-02  1.2333195e-12
[1] 24
Time difference of 45.729743 mins
 [1]  1.5999660e-01  4.8762058e+00  2.2141029e-01  4.1641796e-01 -8.1261898e-01
 [6]  3.3275013e+00  0.0000000e+00 -8.7692193e-02 -2.7787547e-01  4.7929340e-02
[11]  1.6700188e-07  4.3828685e-04
[1] 25
Time difference of 39.355483 mins
 [1]  1.2337143e-01  4.9765979e+00  2.6982075e-01  4.1195251e-01 -7.8736048e-01
 [6]  2.6594953e+00  0.0000000e+00 -5.5238979e-01 -3.2030808e-01  1.0693999e-02
[11]  4.2016017e-02  2.6836441e-07
[1] 26
Time difference of 42.659771 mins
 [1]  0.16311334834  2.97506006434  0.27662334461  0.38071314528 -0.83912163649
 [6]  2.93886600364  0.00000000000 -0.49988827308 -0.31159747464  0.02186129822
[11]  0.00569430706  0.00050869866
[1] 27
Time difference of 2.7873546 hours
 [1]  1.2642454e-01  5.8113086e+00  2.6094334e-01  4.3453459e-01 -7.9456289e-01
 [6]  3.9617792e+00  0.0000000e+00 -4.5529471e-07 -2.8612884e-01  2.5437345e-02
[11]  1.0542299e-05  6.6800290e-04
[1] 28
Time difference of 39.157628 mins
 [1]  0.1711777748  5.2840050985  0.1935994941  0.3997921321 -0.8121986500
 [6]  2.5214767153  0.0000000000 -0.3565848543 -0.2857250360  0.0243180372
[11]  0.0051134729  0.0012668735
[1] 29
Time difference of 1.1507166 hours
 [1]  1.8205179e-01  4.0920817e+00  2.0127549e-01  4.1066272e-01 -7.9302585e-01
 [6]  3.2290613e+00  0.0000000e+00 -4.1104250e-03 -3.3648334e-01  2.5996258e-02
[11]  4.4541265e-02  1.2513532e-09
[1] 30
Time difference of 2.0315287 hours
 [1]  0.12733830366  5.61872914606  0.24560409719  0.41247819853 -0.75341042503
 [6]  3.44506853124  0.00000000000 -0.94999951756 -0.24301197517  0.02838876262
[11]  0.01206050952  0.00062508063
[1] 31
Time difference of 1.3566667 hours
 [1]  0.15618153101  5.03165784202  0.22974964456  0.40357895387 -0.87382796015
 [6]  4.23229338283  0.00000000000 -0.00050036128 -0.23774544638  0.02812682344
[11]  0.01520905966  0.00091625668
[1] 32
Time difference of 47.910558 mins
 [1]  0.19413993491  2.96987574927  0.21186617488  0.34816133138 -0.80971724902
 [6]  3.91170538344  0.00000000000 -0.37693325393 -0.32159553632  0.02739521377
[11]  0.00393043974  0.00076005415
[1] 33
Time difference of 55.334512 mins
 [1]  1.3612786e-01  4.5203771e+00  2.5210617e-01  4.0463019e-01 -8.4578442e-01
 [6]  3.3139485e+00  0.0000000e+00 -2.0145270e-01 -3.0633602e-01  3.7450258e-02
[11]  1.3558882e-08  7.2733213e-04
[1] 34
Time difference of 1.4872808 hours
 [1]  0.17763525373  5.12188268876  0.24204057192  0.39909403751 -0.77309950904
 [6]  2.84080278596  0.00000000000 -0.94999918228 -0.32246167877  0.02637004598
[11]  0.01107857314  0.00060834296
[1] 35
Time difference of 2.2805281 hours
 [1]  1.7661427e-01  4.6656187e+00  2.0508066e-01  3.7973785e-01 -8.0648272e-01
 [6]  2.4794758e+00  0.0000000e+00 -9.4999663e-01 -2.9232982e-01  2.2790053e-02
[11]  1.6461803e-08  1.3745828e-04
[1] 36
Time difference of 37.219584 mins
 [1]  1.5305934e-01  3.8738771e+00  1.9277281e-01  4.0868945e-01 -7.8212493e-01
 [6]  3.3875416e+00  0.0000000e+00 -1.9705984e-02 -2.9878408e-01  1.3362020e-02
[11]  2.7129618e-02  9.8623655e-05
[1] 37
Time difference of 1.4293176 hours
 [1]  9.0611110e-02  4.3770838e+00  2.6244149e-01  4.1606608e-01 -7.6695619e-01
 [6]  2.2288125e+00  0.0000000e+00 -9.4996908e-01 -2.3483253e-01  3.7318901e-02
[11]  3.6421289e-02  1.0396396e-05
[1] 38
Time difference of 42.134979 mins
 [1]  7.2990488e-02  3.8562702e+00  2.4034685e-01  4.1029541e-01 -8.6205988e-01
 [6]  2.7818315e+00  0.0000000e+00 -2.7603632e-01 -3.6311284e-01  1.3078101e-02
[11]  3.3823629e-02  8.0026867e-07
